<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Analysis of covariance (ANCOVA) | Workshop 4: Linear models</title>
  <meta name="description" content="Linear models" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Analysis of covariance (ANCOVA) | Workshop 4: Linear models" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/qcbsRworkshops/" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops//assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Linear models" />
  <meta name="github-repo" content="qcbsRworkshops/workshop04" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Analysis of covariance (ANCOVA) | Workshop 4: Linear models" />
  
  <meta name="twitter:description" content="Linear models" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops//assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Developed and maintained by the contributors of the QCBS R Workshop Series" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="t-test-and-anova.html"/>
<link rel="next" href="multiple-regression.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>QCBS R Workshop Series</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-of-conduct"><i class="fa fa-check"></i><b>0.1</b> Code of conduct</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#expected-behaviour"><i class="fa fa-check"></i><b>0.1.1</b> Expected behaviour</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#unacceptable-behaviour"><i class="fa fa-check"></i><b>0.1.2</b> Unacceptable behaviour</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i><b>0.2</b> Contributors</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contributing"><i class="fa fa-check"></i><b>0.3</b> Contributing</a></li>
</ul></li>
<li class="part"><span><b>Introduction to <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Learning objectives</a></li>
<li class="chapter" data-level="2" data-path="preparing-for-the-workshop.html"><a href="preparing-for-the-workshop.html"><i class="fa fa-check"></i><b>2</b> Preparing for the workshop</a></li>
<li class="chapter" data-level="3" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>3</b> Linear models</a><ul>
<li class="chapter" data-level="3.1" data-path="linear-models.html"><a href="linear-models.html#what-is-a-linear-model"><i class="fa fa-check"></i><b>3.1</b> What is a linear model?</a><ul>
<li class="chapter" data-level="3.1.1" data-path="linear-models.html"><a href="linear-models.html#defining-mean-and-variation"><i class="fa fa-check"></i><b>3.1.1</b> Defining mean and variation</a></li>
<li class="chapter" data-level="3.1.2" data-path="linear-models.html"><a href="linear-models.html#linear-models-1"><i class="fa fa-check"></i><b>3.1.2</b> Linear models</a></li>
<li class="chapter" data-level="3.1.3" data-path="linear-models.html"><a href="linear-models.html#linear-model-assumptions"><i class="fa fa-check"></i><b>3.1.3</b> Linear model assumptions</a></li>
<li class="chapter" data-level="3.1.4" data-path="linear-models.html"><a href="linear-models.html#test-statistics-and-p-values"><i class="fa fa-check"></i><b>3.1.4</b> Test statistics and p-values</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html"><i class="fa fa-check"></i><b>4</b> Linear regression in R</a><ul>
<li class="chapter" data-level="4.1" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#simple-linear-regression"><i class="fa fa-check"></i><b>4.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="4.2" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#work-flow"><i class="fa fa-check"></i><b>4.2</b> Work flow</a><ul>
<li class="chapter" data-level="4.2.1" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#running-a-linear-model"><i class="fa fa-check"></i><b>4.2.1</b> 2.1 Running a linear model</a></li>
<li class="chapter" data-level="4.2.2" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#verifying-assumptions"><i class="fa fa-check"></i><b>4.2.2</b> Verifying assumptions</a></li>
<li class="chapter" data-level="4.2.3" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#normalizing-data"><i class="fa fa-check"></i><b>4.2.3</b> Normalizing data</a></li>
<li class="chapter" data-level="4.2.4" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#data-transformation"><i class="fa fa-check"></i><b>4.2.4</b> Data transformation</a></li>
<li class="chapter" data-level="4.2.5" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#model-output"><i class="fa fa-check"></i><b>4.2.5</b> Model output</a></li>
<li class="chapter" data-level="4.2.6" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#subsetting"><i class="fa fa-check"></i><b>4.2.6</b> Subsetting</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#challenge-1"><i class="fa fa-check"></i><b>4.3</b> CHALLENGE 1</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html"><i class="fa fa-check"></i><b>5</b> t-test and ANOVA</a><ul>
<li class="chapter" data-level="5.1" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#analysis-of-variance-anova"><i class="fa fa-check"></i><b>5.1</b> Analysis of Variance (ANOVA)</a><ul>
<li class="chapter" data-level="5.1.1" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#types-of-anova"><i class="fa fa-check"></i><b>5.1.1</b> 3.1 Types of ANOVA</a></li>
<li class="chapter" data-level="5.1.2" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#t-test"><i class="fa fa-check"></i><b>5.1.2</b> 3.2 T-test</a></li>
<li class="chapter" data-level="5.1.3" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#running-an-anova"><i class="fa fa-check"></i><b>5.1.3</b> 3.3 Running an ANOVA</a></li>
<li class="chapter" data-level="5.1.4" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#verifying-assumptions-1"><i class="fa fa-check"></i><b>5.1.4</b> 3.4 Verifying assumptions</a></li>
<li class="chapter" data-level="5.1.5" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#model-output-1"><i class="fa fa-check"></i><b>5.1.5</b> 3.5 Model output</a></li>
<li class="chapter" data-level="5.1.6" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#complementary-test"><i class="fa fa-check"></i><b>5.1.6</b> 3.6 Complementary test</a></li>
<li class="chapter" data-level="5.1.7" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#plotting"><i class="fa fa-check"></i><b>5.1.7</b> 3.7 Plotting</a></li>
<li class="chapter" data-level="5.1.8" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#going-further-contrasts"><i class="fa fa-check"></i><b>5.1.8</b> Going further: Contrasts</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#two-way-anova"><i class="fa fa-check"></i><b>5.2</b> 4. Two-way ANOVA</a><ul>
<li class="chapter" data-level="5.2.1" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#running-a-two-way-anova"><i class="fa fa-check"></i><b>5.2.1</b> 4.1 Running a two-way ANOVA</a></li>
<li class="chapter" data-level="5.2.2" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#interaction-plot"><i class="fa fa-check"></i><b>5.2.2</b> 4.2 Interaction plot</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#unbalanced-anova-advanced-section-optional"><i class="fa fa-check"></i><b>5.3</b> 5. Unbalanced ANOVA (advanced section/ optional)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="analysis-of-covariance-ancova.html"><a href="analysis-of-covariance-ancova.html"><i class="fa fa-check"></i><b>6</b> Analysis of covariance (ANCOVA)</a><ul>
<li class="chapter" data-level="6.0.1" data-path="analysis-of-covariance-ancova.html"><a href="analysis-of-covariance-ancova.html#assumptions-1"><i class="fa fa-check"></i><b>6.0.1</b> 6.1 Assumptions</a></li>
<li class="chapter" data-level="6.0.2" data-path="analysis-of-covariance-ancova.html"><a href="analysis-of-covariance-ancova.html#types-of-ancova"><i class="fa fa-check"></i><b>6.0.2</b> 6.2 Types of ANCOVA</a></li>
<li class="chapter" data-level="6.0.3" data-path="analysis-of-covariance-ancova.html"><a href="analysis-of-covariance-ancova.html#running-an-ancova"><i class="fa fa-check"></i><b>6.0.3</b> 6.3 Running an ANCOVA</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="multiple-regression.html"><a href="multiple-regression.html"><i class="fa fa-check"></i><b>7</b> Multiple regression</a><ul>
<li class="chapter" data-level="7.0.1" data-path="multiple-regression.html"><a href="multiple-regression.html#assumptions-2"><i class="fa fa-check"></i><b>7.0.1</b> 7.1 Assumptions</a></li>
<li class="chapter" data-level="7.0.2" data-path="multiple-regression.html"><a href="multiple-regression.html#dickcissel-dataset"><i class="fa fa-check"></i><b>7.0.2</b> 7.2 Dickcissel dataset</a></li>
<li class="chapter" data-level="7.0.3" data-path="multiple-regression.html"><a href="multiple-regression.html#going-further-polynomial-regression"><i class="fa fa-check"></i><b>7.0.3</b> Going further: Polynomial regression</a></li>
<li class="chapter" data-level="7.0.4" data-path="multiple-regression.html"><a href="multiple-regression.html#stepwise-regression"><i class="fa fa-check"></i><b>7.0.4</b> 7.4 Stepwise regression</a></li>
<li class="chapter" data-level="7.1" data-path="multiple-regression.html"><a href="multiple-regression.html#going-further-variance-partitioning"><i class="fa fa-check"></i><b>7.1</b> Going further: Variance partitioning</a></li>
</ul></li>
<li class="part"><span><b>Final considerations</b></span></li>
<li class="chapter" data-level="8" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>8</b> Summary</a></li>
<li class="chapter" data-level="9" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>9</b> Additional resources</a></li>
<li class="chapter" data-level="10" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>10</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop 4: Linear models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>



<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
<div id="analysis-of-covariance-ancova" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Analysis of covariance (ANCOVA)</h1>
<p>Analysis of covariance (ANCOVA) is a linear model that tests the
influence of one categorical explanatory variable (or more) and one
continuous explanatory variable (or more) on a continuous response
variable. Each level of the categorical variable is described by its own
slope and intercept. In addition to testing if the response variable
differs for at least one level of the categorical variable, ANCOVA also
tests whether the response variable might be influenced by its
relationship with the continuous variable (called the covariate in
ANCOVA), and by any differences between group levels in the way that the
continuous variable influences the response (i.e. the interaction). The
ANCOVA hypotheses are thus: that there is no difference in the mean
among levels of the categorical variable; there is no correlation
between the response variable and the continuous explanatory variable;
there is no interaction between the categorical and continuous
explanatory variables.</p>
<div id="assumptions-1" class="section level3">
<h3><span class="header-section-number">6.0.1</span> 6.1 Assumptions</h3>
<p>As with models seen above, to be valid ANCOVA models must meet the
statistical assumptions of linear models that can be verified using
diagnostic plots. In addition, ANCOVA models must have:</p>
<ol style="list-style-type: decimal">
<li>The same value range for all covariates</li>
<li>Variables that are <em>fixed</em></li>
<li>No interaction between categorical and continuous variables</li>
</ol>
<p><strong><span class="ul">Note:</span></strong> A <em>fixed</em> variable is one that you are specifically
interested in (i.e. bird mass). In contrast, a random variable is noise
that you want to control for (i.e. site a bird was sampled in). If you
have random variables, see the workshop on <a href="http://qcbs.ca/wiki/r_workshop6">Linear Mixed-effect
Models</a>!</p>
</div>
<div id="types-of-ancova" class="section level3">
<h3><span class="header-section-number">6.0.2</span> 6.2 Types of ANCOVA</h3>
<p>You can have any number of factors and/or covariates, but as their
number increases, the interpretation of results gets more complex.</p>
<p>The most frequently used ANCOVAs are those with:</p>
<ol style="list-style-type: decimal">
<li>one covariate and one factor</li>
<li>one covariate and two factors</li>
<li>two covariates and one factor</li>
</ol>
<p>The different possible goals of the ANCOVA are to determine the effects
of:</p>
<ol style="list-style-type: decimal">
<li>the categorical and continuous variables on the response variable</li>
<li>the categorical variable(s) on the response variable(s) after
removing the effect of the continuous variable</li>
<li>the categorical variable(s) on the relationship between the
continuous variables(s) and the response variable</li>
</ol>
<p>Importantly, these goals are only met if there is no significant
interaction between the categorical and continuous variables! Examples
of significant interactions between the categorical and continuous
variables (for an ANCOVA with one factor and one covariate) are
illustrated by the second and third panels below:</p>
<p><img src="images/ancova_schematic.png" width="550" /></p>
<p>The same logic follows for ANCOVAs with multiple categorical and/or
continuous variables.</p>
</div>
<div id="running-an-ancova" class="section level3">
<h3><span class="header-section-number">6.0.3</span> 6.3 Running an ANCOVA</h3>
<p>Running an ANCOVA in R is comparable to running a two-way ANOVA, using
the function <code>lm</code>. However, instead of using two categorical variables
(Diet and Aquatic), we now use one categorical and one continuous
variable.</p>
<p>For example, using a build in dataset called CO2, where the response
variable is <em>uptake</em>, the continuous variable is <em>conc</em> and the factor
is <em>Treatment</em>, the ANCOVA is:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="analysis-of-covariance-ancova.html#cb49-1"></a>ancova.example &lt;-<span class="st"> </span><span class="kw">lm</span>(uptake <span class="op">~</span><span class="st"> </span>conc <span class="op">*</span><span class="st"> </span>Treatment, <span class="dt">data =</span> CO2)</span>
<span id="cb49-2"><a href="analysis-of-covariance-ancova.html#cb49-2"></a><span class="kw">anova</span>(ancova.example)</span></code></pre></div>
<p>If only your categorical variable is significant, drop your continuous
variable from the model: you will then have an <strong>ANOVA</strong>.<br />
If only your continuous variable is significant, drop your categorical
variable from the model, you will then have a <strong>simple linear
regression</strong>.<br />
If your interaction is significant, you might want to test which levels
of your categorical variables ha(s)ve different slopes and to question
whether ANCOVA is the most appropriate model.<br />
In the CO2 example above, both the continuous and categorical variable
are significant, but the interaction is non-significant. If your replace
<em>Treatment</em> with <em>Type</em>, however, you will see an example of a
significant interaction.</p>
<p>If you want to compare means across factors, you can use adjusted means,
which uses the equations given by the ANCOVA to estimate the means of
each level of the categorical variable, corrected for the effect of the
categorical variable:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="analysis-of-covariance-ancova.html#cb50-1"></a><span class="kw">install.packages</span>(<span class="st">&quot;effects&quot;</span>)</span>
<span id="cb50-2"><a href="analysis-of-covariance-ancova.html#cb50-2"></a><span class="kw">library</span>(effects)</span>
<span id="cb50-3"><a href="analysis-of-covariance-ancova.html#cb50-3"></a>adj.means &lt;-<span class="st"> </span><span class="kw">effect</span>(<span class="st">&quot;Treatment&quot;</span>, ancova.example)</span>
<span id="cb50-4"><a href="analysis-of-covariance-ancova.html#cb50-4"></a><span class="kw">plot</span>(adj.means)</span>
<span id="cb50-5"><a href="analysis-of-covariance-ancova.html#cb50-5"></a></span>
<span id="cb50-6"><a href="analysis-of-covariance-ancova.html#cb50-6"></a>adj.means &lt;-<span class="st"> </span><span class="kw">effect</span>(<span class="st">&quot;conc*Treatment&quot;</span>, ancova.example)</span>
<span id="cb50-7"><a href="analysis-of-covariance-ancova.html#cb50-7"></a><span class="kw">plot</span>(adj.means)</span></code></pre></div>
<hr />
<p>CHALLENGE 4</p>
<p>Run an ANCOVA to test the effect of <em>Diet</em>, <em>Mass</em>, and their
interaction on <em>MaxAbund</em>.<br />
++++ Challenge 4: Solution |</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="analysis-of-covariance-ancova.html#cb51-1"></a><span class="co"># If you did the section on Contrasts above, you will need</span></span>
<span id="cb51-2"><a href="analysis-of-covariance-ancova.html#cb51-2"></a><span class="co"># to reset the contrast to Treatment for ease of comparison</span></span>
<span id="cb51-3"><a href="analysis-of-covariance-ancova.html#cb51-3"></a><span class="co"># using the &#39;&#39;options()&#39;&#39; function Otherwise, skip the</span></span>
<span id="cb51-4"><a href="analysis-of-covariance-ancova.html#cb51-4"></a><span class="co"># first line of code below</span></span>
<span id="cb51-5"><a href="analysis-of-covariance-ancova.html#cb51-5"></a><span class="kw">options</span>(<span class="dt">contrasts =</span> <span class="kw">c</span>(<span class="st">&quot;contr.treatment&quot;</span>, <span class="st">&quot;contr.poly&quot;</span>))</span>
<span id="cb51-6"><a href="analysis-of-covariance-ancova.html#cb51-6"></a>ancov1 &lt;-<span class="st"> </span><span class="kw">lm</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass <span class="op">*</span><span class="st"> </span>Diet, <span class="dt">data =</span> bird)</span>
<span id="cb51-7"><a href="analysis-of-covariance-ancova.html#cb51-7"></a><span class="kw">summary</span>(ancov1)</span>
<span id="cb51-8"><a href="analysis-of-covariance-ancova.html#cb51-8"></a><span class="kw">anova</span>(ancov1)</span></code></pre></div>
<p>The R output of this model is given by</p>
<pre><code>Analysis of Variance Table
Response: logMaxAbund
              Df      Sum Sq      Mean Sq     F value     Pr(&gt;F)
logMass       1   1.9736      1.97357     4.6054      0.03743 *
Diet          4   3.3477      0.83691     1.9530      0.11850
logMass:Diet  4   2.9811      0.74527     1.7391      0.15849
Residuals     44  18.8556     0.42854</code></pre>
<p>In this case, the interaction term is not significant, meaning that the
effect of <em>logMass</em> on <em>logMaxAbund</em> does not differ between Diet
groups. The interaction term can thus be dropped, and the ANCOVA model
becomes:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="analysis-of-covariance-ancova.html#cb53-1"></a>ancov2 &lt;-<span class="st"> </span><span class="kw">lm</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass <span class="op">+</span><span class="st"> </span>Diet, <span class="dt">data =</span> bird)</span></code></pre></div>
<p>Because the R output shows that diet is also non-significant, this term
is dropped, and the final model corresponds to:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="analysis-of-covariance-ancova.html#cb54-1"></a>lm2 &lt;-<span class="st"> </span><span class="kw">lm</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass, <span class="dt">data =</span> bird)</span></code></pre></div>
<p>The model results can also be graphically represented using a plot of
the response variable as a function of the continuous explanatory
variable with different point and line colours for the different levels
of the categorical variable.</p>
<p>Plot the ANCOVA intercept and slopes (model ancov1 above) using the
<code>abline()</code> and <code>coef()</code> functions.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="analysis-of-covariance-ancova.html#cb55-1"></a><span class="kw">coef</span>(ancov1)</span>
<span id="cb55-2"><a href="analysis-of-covariance-ancova.html#cb55-2"></a></span>
<span id="cb55-3"><a href="analysis-of-covariance-ancova.html#cb55-3"></a></span>
<span id="cb55-4"><a href="analysis-of-covariance-ancova.html#cb55-4"></a><span class="kw">plot</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass, <span class="dt">data =</span> bird, <span class="dt">col =</span> Diet, <span class="dt">pch =</span> <span class="dv">19</span>,</span>
<span id="cb55-5"><a href="analysis-of-covariance-ancova.html#cb55-5"></a>    <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span><span class="st"> &quot;(Maximum Abundance)&quot;</span>), <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span></span>
<span id="cb55-6"><a href="analysis-of-covariance-ancova.html#cb55-6"></a><span class="st">        &quot;(Mass)&quot;</span>))</span>
<span id="cb55-7"><a href="analysis-of-covariance-ancova.html#cb55-7"></a><span class="kw">abline</span>(<span class="dt">a =</span> <span class="kw">coef</span>(ancov1)[<span class="dv">1</span>], <span class="dt">b =</span> <span class="kw">coef</span>(ancov1)[<span class="dv">2</span>], <span class="dt">col =</span> <span class="st">&quot;deepskyblue1&quot;</span>)</span>
<span id="cb55-8"><a href="analysis-of-covariance-ancova.html#cb55-8"></a><span class="kw">abline</span>(<span class="dt">a =</span> <span class="kw">sum</span>(<span class="kw">coef</span>(ancov1)[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="kw">coef</span>(ancov1)[<span class="dv">3</span>]), <span class="dt">b =</span> <span class="kw">sum</span>(<span class="kw">coef</span>(ancov1)[<span class="dv">2</span>] <span class="op">+</span></span>
<span id="cb55-9"><a href="analysis-of-covariance-ancova.html#cb55-9"></a><span class="st">    </span><span class="kw">coef</span>(ancov1)[<span class="dv">7</span>]), <span class="dt">col =</span> <span class="st">&quot;green2&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb55-10"><a href="analysis-of-covariance-ancova.html#cb55-10"></a><span class="kw">abline</span>(<span class="dt">a =</span> <span class="kw">sum</span>(<span class="kw">coef</span>(ancov1)[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="kw">coef</span>(ancov1)[<span class="dv">4</span>]), <span class="dt">b =</span> <span class="kw">sum</span>(<span class="kw">coef</span>(ancov1)[<span class="dv">2</span>] <span class="op">+</span></span>
<span id="cb55-11"><a href="analysis-of-covariance-ancova.html#cb55-11"></a><span class="st">    </span><span class="kw">coef</span>(ancov1)[<span class="dv">8</span>]), <span class="dt">col =</span> <span class="st">&quot;orange1&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb55-12"><a href="analysis-of-covariance-ancova.html#cb55-12"></a><span class="kw">abline</span>(<span class="dt">a =</span> <span class="kw">sum</span>(<span class="kw">coef</span>(ancov1)[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="kw">coef</span>(ancov1)[<span class="dv">5</span>]), <span class="dt">b =</span> <span class="kw">sum</span>(<span class="kw">coef</span>(ancov1)[<span class="dv">2</span>] <span class="op">+</span></span>
<span id="cb55-13"><a href="analysis-of-covariance-ancova.html#cb55-13"></a><span class="st">    </span><span class="kw">coef</span>(ancov1)[<span class="dv">9</span>]), <span class="dt">col =</span> <span class="st">&quot;lightsteelblue1&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb55-14"><a href="analysis-of-covariance-ancova.html#cb55-14"></a><span class="kw">abline</span>(<span class="dt">a =</span> <span class="kw">sum</span>(<span class="kw">coef</span>(ancov1)[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="kw">coef</span>(ancov1)[<span class="dv">6</span>]), <span class="dt">b =</span> <span class="kw">sum</span>(<span class="kw">coef</span>(ancov1)[<span class="dv">2</span>] <span class="op">+</span></span>
<span id="cb55-15"><a href="analysis-of-covariance-ancova.html#cb55-15"></a><span class="st">    </span><span class="kw">coef</span>(ancov1)[<span class="dv">10</span>]), <span class="dt">col =</span> <span class="st">&quot;darkcyan&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="images/ancova_plot.png" width="350" /></p>

</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="t-test-and-anova.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multiple-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
