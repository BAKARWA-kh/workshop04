<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Analysis of covariance (ANCOVA) | Workshop 4: Linear models</title>
  <meta name="description" content="Linear models" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Analysis of covariance (ANCOVA) | Workshop 4: Linear models" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops//assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Linear models" />
  <meta name="github-repo" content="qcbsRworkshops/workshop04" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Analysis of covariance (ANCOVA) | Workshop 4: Linear models" />
  
  <meta name="twitter:description" content="Linear models" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops//assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Developed and maintained by the contributors of the QCBS R Workshop Series" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="t-test-and-anova.html"/>
<link rel="next" href="multiple-linear-regression.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>QCBS R Workshop Series<span></span></b></span></li>
<li><a href="index.html#preface">Preface<span></span></a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>0.1</b> Code of conduct<span></span></a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#expected-behaviour"><i class="fa fa-check"></i><b>0.1.1</b> Expected behaviour<span></span></a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#unacceptable-behaviour"><i class="fa fa-check"></i><b>0.1.2</b> Unacceptable behaviour<span></span></a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i><b>0.2</b> Contributors<span></span></a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contributing"><i class="fa fa-check"></i><b>0.3</b> Contributing<span></span></a></li>
</ul></li>
<li class="part"><span><b>Linear models in <code>R</code><span></span></b></span></li>
<li class="chapter" data-level="1" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Learning objectives<span></span></a></li>
<li class="chapter" data-level="2" data-path="preparing-for-the-workshop.html"><a href="preparing-for-the-workshop.html"><i class="fa fa-check"></i><b>2</b> Preparing for the workshop<span></span></a></li>
<li class="chapter" data-level="3" data-path="the-linear-model.html"><a href="the-linear-model.html"><i class="fa fa-check"></i><b>3</b> The linear model<span></span></a><ul>
<li class="chapter" data-level="3.1" data-path="the-linear-model.html"><a href="the-linear-model.html#what-is-a-linear-model"><i class="fa fa-check"></i><b>3.1</b> What is a linear model?<span></span></a><ul>
<li class="chapter" data-level="3.1.1" data-path="the-linear-model.html"><a href="the-linear-model.html#example-abundance-and-mass-of-bird-species"><i class="fa fa-check"></i><b>3.1.1</b> Example: Abundance and mass of bird species<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="the-linear-model.html"><a href="the-linear-model.html#formulation-of-a-linear-model"><i class="fa fa-check"></i><b>3.2</b> Formulation of a linear model<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="the-linear-model.html"><a href="the-linear-model.html#evaluation-of-the-linear-model"><i class="fa fa-check"></i><b>3.3</b> Evaluation of the linear model<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="the-linear-model.html"><a href="the-linear-model.html#assumptions-of-the-linear-model"><i class="fa fa-check"></i><b>3.4</b> Assumptions of the linear model<span></span></a><ul>
<li class="chapter" data-level="3.4.1" data-path="the-linear-model.html"><a href="the-linear-model.html#normal-distribution-of-the-residuals"><i class="fa fa-check"></i><b>3.4.1</b> Normal distribution of the residuals<span></span></a></li>
<li class="chapter" data-level="3.4.2" data-path="the-linear-model.html"><a href="the-linear-model.html#homoskedasticity"><i class="fa fa-check"></i><b>3.4.2</b> Homoskedasticity<span></span></a></li>
<li class="chapter" data-level="3.4.3" data-path="the-linear-model.html"><a href="the-linear-model.html#independence-of-the-residuals"><i class="fa fa-check"></i><b>3.4.3</b> Independence of the residuals<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-linear-model.html"><a href="the-linear-model.html#notation-for-linear-models"><i class="fa fa-check"></i><b>3.5</b> Notation for linear models<span></span></a><ul>
<li class="chapter" data-level="3.5.1" data-path="the-linear-model.html"><a href="the-linear-model.html#mathematical-notation"><i class="fa fa-check"></i><b>3.5.1</b> Mathematical notation<span></span></a></li>
<li class="chapter" data-level="3.5.2" data-path="the-linear-model.html"><a href="the-linear-model.html#r-notation"><i class="fa fa-check"></i><b>3.5.2</b> R notation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="the-linear-model.html"><a href="the-linear-model.html#fitting-a-linear-model"><i class="fa fa-check"></i><b>3.6</b> Fitting a linear model<span></span></a><ul>
<li class="chapter" data-level="3.6.1" data-path="the-linear-model.html"><a href="the-linear-model.html#model-estimation"><i class="fa fa-check"></i><b>3.6.1</b> Model estimation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="the-linear-model.html"><a href="the-linear-model.html#learning-objectives-1"><i class="fa fa-check"></i><b>3.7</b> Learning objectives<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html"><i class="fa fa-check"></i><b>4</b> Linear regression in R<span></span></a><ul>
<li class="chapter" data-level="4.1" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#model-formulation"><i class="fa fa-check"></i><b>4.1</b> Model formulation<span></span></a><ul>
<li class="chapter" data-level="4.1.1" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#model-equation"><i class="fa fa-check"></i><b>4.1.1</b> Model equation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#linear-regression-in-r-1"><i class="fa fa-check"></i><b>4.2</b> Linear regression in R<span></span></a><ul>
<li class="chapter" data-level="4.2.1" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#step-1-formulate-and-run-a-linear-model"><i class="fa fa-check"></i><b>4.2.1</b> Step 1: Formulate and run a linear model<span></span></a></li>
<li class="chapter" data-level="4.2.2" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#step-2-verify-assumptions-using-diagnostic-plots-of-the-residuals"><i class="fa fa-check"></i><b>4.2.2</b> Step 2: Verify assumptions using diagnostic plots of the residuals<span></span></a></li>
<li class="chapter" data-level="4.2.3" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#step-2.-verify-assumptions-of-lm1"><i class="fa fa-check"></i><b>4.2.3</b> <strong>Step 2</strong>. Verify assumptions of <code>lm1</code><span></span></a></li>
<li class="chapter" data-level="4.2.4" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#assumptions-not-met---what-is-wrong"><i class="fa fa-check"></i><b>4.2.4</b> Assumptions not met - what is wrong?<span></span></a></li>
<li class="chapter" data-level="4.2.5" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#assumptions-not-met---how-to-proceed"><i class="fa fa-check"></i><b>4.2.5</b> Assumptions not met - how to proceed?<span></span></a></li>
<li class="chapter" data-level="4.2.6" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#step-3.-analyze-parameter-estimates"><i class="fa fa-check"></i><b>4.2.6</b> <strong>Step 3.</strong> Analyze parameter estimates<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#model-interpretation"><i class="fa fa-check"></i><b>4.3</b> Model interpretation<span></span></a><ul>
<li class="chapter" data-level="4.3.1" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#finding-a-better-model-terrestrial-birds"><i class="fa fa-check"></i><b>4.3.1</b> Finding a better model: terrestrial birds<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#challenge-2"><i class="fa fa-check"></i><b>4.4</b> Challenge 2<span></span></a><ul>
<li class="chapter" data-level="4.4.1" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#solutions"><i class="fa fa-check"></i><b>4.4.1</b> Solutions<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#linear-regression-in-r-2"><i class="fa fa-check"></i><b>4.5</b> Linear regression in R<span></span></a></li>
<li class="chapter" data-level="4.6" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#variable-names"><i class="fa fa-check"></i><b>4.6</b> Variable names<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html"><i class="fa fa-check"></i><b>5</b> t-test and ANOVA<span></span></a><ul>
<li class="chapter" data-level="5.1" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#analysis-of-variance-anova"><i class="fa fa-check"></i><b>5.1</b> Analysis of Variance (ANOVA)<span></span></a><ul>
<li class="chapter" data-level="5.1.1" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#types-of-anova"><i class="fa fa-check"></i><b>5.1.1</b> Types of ANOVA<span></span></a></li>
<li class="chapter" data-level="5.1.2" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#t-test"><i class="fa fa-check"></i><b>5.1.2</b> T-test<span></span></a></li>
<li class="chapter" data-level="5.1.3" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#running-an-anova"><i class="fa fa-check"></i><b>5.1.3</b> Running an ANOVA<span></span></a></li>
<li class="chapter" data-level="5.1.4" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#verifying-assumptions"><i class="fa fa-check"></i><b>5.1.4</b> Verifying assumptions<span></span></a></li>
<li class="chapter" data-level="5.1.5" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#model-output"><i class="fa fa-check"></i><b>5.1.5</b> Model output<span></span></a></li>
<li class="chapter" data-level="5.1.6" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#complementary-test"><i class="fa fa-check"></i><b>5.1.6</b> Complementary test<span></span></a></li>
<li class="chapter" data-level="5.1.7" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#plotting"><i class="fa fa-check"></i><b>5.1.7</b> Plotting<span></span></a></li>
<li class="chapter" data-level="5.1.8" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#going-further-contrasts"><i class="fa fa-check"></i><b>5.1.8</b> Going further: Contrasts<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#two-way-anova"><i class="fa fa-check"></i><b>5.2</b> Two-way ANOVA<span></span></a><ul>
<li class="chapter" data-level="5.2.1" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#running-a-two-way-anova"><i class="fa fa-check"></i><b>5.2.1</b> 4.1 Running a two-way ANOVA<span></span></a></li>
<li class="chapter" data-level="5.2.2" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#interaction-plot"><i class="fa fa-check"></i><b>5.2.2</b> 4.2 Interaction plot<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#unbalanced-anova-advanced-section-optional"><i class="fa fa-check"></i><b>5.3</b> Unbalanced ANOVA (advanced section/ optional)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="analysis-of-covariance-ancova.html"><a href="analysis-of-covariance-ancova.html"><i class="fa fa-check"></i><b>6</b> Analysis of covariance (ANCOVA)<span></span></a><ul>
<li class="chapter" data-level="6.0.1" data-path="analysis-of-covariance-ancova.html"><a href="analysis-of-covariance-ancova.html#assumptions-1"><i class="fa fa-check"></i><b>6.0.1</b> 6.1 Assumptions<span></span></a></li>
<li class="chapter" data-level="6.0.2" data-path="analysis-of-covariance-ancova.html"><a href="analysis-of-covariance-ancova.html#types-of-ancova"><i class="fa fa-check"></i><b>6.0.2</b> 6.2 Types of ANCOVA<span></span></a></li>
<li class="chapter" data-level="6.0.3" data-path="analysis-of-covariance-ancova.html"><a href="analysis-of-covariance-ancova.html#running-an-ancova"><i class="fa fa-check"></i><b>6.0.3</b> 6.3 Running an ANCOVA<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html"><i class="fa fa-check"></i><b>7</b> Multiple linear regression<span></span></a><ul>
<li class="chapter" data-level="7.0.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#model-formulation-1"><i class="fa fa-check"></i><b>7.0.1</b> Model formulation<span></span></a></li>
<li class="chapter" data-level="7.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#assumptions-2"><i class="fa fa-check"></i><b>7.1</b> Assumptions<span></span></a><ul>
<li class="chapter" data-level="7.1.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#if-variables-are-collinear"><i class="fa fa-check"></i><b>7.1.1</b> If variables are collinear<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#multiple-linear-regression-in-r"><i class="fa fa-check"></i><b>7.2</b> Multiple linear regression in R<span></span></a><ul>
<li class="chapter" data-level="7.2.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#the-data"><i class="fa fa-check"></i><b>7.2.1</b> The data<span></span></a></li>
<li class="chapter" data-level="7.2.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#verify-assumptions"><i class="fa fa-check"></i><b>7.2.2</b> Verify assumptions<span></span></a></li>
<li class="chapter" data-level="7.2.3" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#linear-regression"><i class="fa fa-check"></i><b>7.2.3</b> Linear regression<span></span></a></li>
<li class="chapter" data-level="7.2.4" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#find-the-best-fit-model"><i class="fa fa-check"></i><b>7.2.4</b> Find the best-fit model<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#polynomial-regression-additional-material"><i class="fa fa-check"></i><b>7.3</b> Polynomial regression (additional material)<span></span></a></li>
<li class="chapter" data-level="7.4" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#variation-partitioning-additional-material"><i class="fa fa-check"></i><b>7.4</b> Variation Partitioning (additional material)<span></span></a></li>
</ul></li>
<li class="part"><span><b>Final considerations<span></span></b></span></li>
<li class="chapter" data-level="8" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>8</b> Summary<span></span></a></li>
<li class="chapter" data-level="9" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>9</b> Additional resources<span></span></a></li>
<li class="chapter" data-level="10" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>10</b> References<span></span></a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop 4: Linear models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>


<!-- 
<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
--!>
<div id="analysis-of-covariance-ancova" class="section level1 hasAnchor">
<h1><span class="header-section-number">Chapter 6</span> Analysis of covariance (ANCOVA)<a href="analysis-of-covariance-ancova.html#analysis-of-covariance-ancova" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><img src="images/schema_ancova.png" /></p>
<p>Analysis of covariance (ANCOVA) is a linear model that tests the
influence of one categorical explanatory variable (or more) and one
continuous explanatory variable (or more) on a continuous response
variable. Each level of the categorical variable is described by its own
slope and intercept. In addition to testing if the response variable
differs for at least one level of the categorical variable, ANCOVA also
tests whether the response variable might be influenced by its
relationship with the continuous variable (called the covariate in
ANCOVA), and by any differences between group levels in the way that the
continuous variable influences the response (i.e. the interaction). The
ANCOVA hypotheses are thus: that there is no difference in the mean
among levels of the categorical variable; there is no correlation
between the response variable and the continuous explanatory variable;
there is no interaction between the categorical and continuous
explanatory variables.</p>
<p><span class="math inline">\(Y = X * Z\)</span></p>
<p>where:
<span class="math inline">\(Y\)</span>: Response variable is continuous
<span class="math inline">\(X\)</span>: Explanatory variable is categorical
<span class="math inline">\(Z\)</span>: Explanatory cariable is continuous</p>
<p><span class="math display">\[Y = \mu + Main Effect Factors + Interaction between Factors + Main Effect Covariates + Interactions between Covariates Factors + \epsilon\]</span></p>
<div id="assumptions-1" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.0.1</span> 6.1 Assumptions<a href="analysis-of-covariance-ancova.html#assumptions-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As with models seen above, to be valid ANCOVA models must meet the
statistical assumptions of linear models that can be verified using
diagnostic plots. In addition, ANCOVA models must have:</p>
<ol style="list-style-type: decimal">
<li>The same value range for all covariates</li>
<li>Variables that are <em>fixed</em></li>
<li>No interaction between categorical and continuous variables (not colinear)</li>
</ol>
<p><strong><span class="ul">Note:</span></strong> A <em>fixed</em> variable is one that you are specifically
interested in (i.e. bird mass). In contrast, a random variable is noise
that you want to control for (i.e. site a bird was sampled in). If you
have random variables, see the workshop on <a href="https://r.qcbs.ca/workshops/r-workshop-07/">Linear And Generalized Linear Mixed
Models</a>!</p>
</div>
<div id="types-of-ancova" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.0.2</span> 6.2 Types of ANCOVA<a href="analysis-of-covariance-ancova.html#types-of-ancova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can have any number of factors and/or covariates, but as their
number increases, the interpretation of results gets more complex.</p>
<p>The most frequently used ANCOVAs are those with:</p>
<ol style="list-style-type: decimal">
<li>one covariate and one factor</li>
<li>one covariate and two factors</li>
<li>two covariates and one factor</li>
</ol>
<p>The different possible goals of the ANCOVA are to determine the effects
of:</p>
<ol style="list-style-type: decimal">
<li>the categorical and continuous variables on the response variable</li>
<li>the categorical variable(s) on the response variable(s) after
removing the effect of the continuous variable</li>
<li>the categorical variable(s) on the relationship between the
continuous variables(s) and the response variable</li>
</ol>
<p>Importantly, these goals are only met if there is <strong>no significant interaction</strong> between the categorical and continuous variables! Examples
of significant interactions between the categorical and continuous
variables (for an ANCOVA with one factor and one covariate) are
illustrated by the second and third panels below:</p>
<p><img src="book-en_files/figure-html/unnamed-chunk-91-1.png" width="960" /></p>
<p>If the interaction is significant, you will have a scenario that looks like the left and middle graphs. If your covariate and factor are significant, outputs will look like the left graph. The same logic follows for ANCOVAs with multiple categorical and/or
continuous variables.</p>
</div>
<div id="running-an-ancova" class="section level3 hasAnchor">
<h3><span class="header-section-number">6.0.3</span> 6.3 Running an ANCOVA<a href="analysis-of-covariance-ancova.html#running-an-ancova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Running an ANCOVA in R is comparable to running a two-way ANOVA, using
the function <code>lm</code>. However, instead of using two categorical variables
(Diet and Aquatic), we now use one categorical and one continuous
variable.</p>
<p>For example, using a build in dataset called CO2, where the response
variable is <em>uptake</em>, the continuous variable is <em>conc</em> and the factor
is <em>Treatment</em>, the ANCOVA is:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="analysis-of-covariance-ancova.html#cb145-1"></a>ancova.example &lt;-<span class="st"> </span><span class="kw">lm</span>(uptake <span class="op">~</span><span class="st"> </span>conc <span class="op">*</span><span class="st"> </span>Treatment, <span class="dt">data =</span> CO2)</span>
<span id="cb145-2"><a href="analysis-of-covariance-ancova.html#cb145-2"></a><span class="kw">anova</span>(ancova.example)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: uptake
##                Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## conc            1 2285.0 2284.99 28.5535 8.377e-07 ***
## Treatment       1  988.1  988.11 12.3476 0.0007297 ***
## conc:Treatment  1   31.9   31.87  0.3983 0.5297890    
## Residuals      80 6402.0   80.02                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>If only your categorical variable is significant, drop your continuous
variable from the model: you will then have an <strong>ANOVA</strong>.<br />
If only your continuous variable is significant, drop your categorical
variable from the model, you will then have a <strong>simple linear
regression</strong>.<br />
If your interaction is significant, you might want to test which levels
of your categorical variables ha(s)ve different slopes and to question
whether ANCOVA is the most appropriate model.<br />
In the CO2 example above, both the continuous and categorical variable
are significant, but the interaction is non-significant. If your replace
<em>Treatment</em> with <em>Type</em>, however, you will see an example of a
significant interaction.</p>
<p>To compare the mean values of each factor, conditional on the effect of the other</p>
<p>The effects::effect() function uses the output of the ANCOVA model to estimate the means of each factor level, corrected by the effect of the covariate</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="analysis-of-covariance-ancova.html#cb147-1"></a><span class="kw">install.packages</span>(<span class="st">&quot;effects&quot;</span>)</span>
<span id="cb147-2"><a href="analysis-of-covariance-ancova.html#cb147-2"></a><span class="kw">library</span>(effects)</span></code></pre></div>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="analysis-of-covariance-ancova.html#cb148-1"></a>adj.means.ex &lt;-<span class="st"> </span><span class="kw">effect</span>(<span class="st">&quot;Treatment&quot;</span>, ancova.example)</span>
<span id="cb148-2"><a href="analysis-of-covariance-ancova.html#cb148-2"></a><span class="kw">plot</span>(adj.means.ex)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-94-1.png" width="672" /></p>
<hr />
<p>CHALLENGE 4</p>
<p>Run an ANCOVA to test the effect of <code>Diet</code>, <code>Mass</code>, and their
interaction on <code>MaxAbund</code>.<br />
</p>
<p>Response variable: <code>MaxAbund</code>
Explanatory variables:
-<code>Diet</code> (factor with 5 levels)
-<code>Mass</code> (numeric, continuous)</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="analysis-of-covariance-ancova.html#cb149-1"></a><span class="kw">str</span>(bird)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    54 obs. of  9 variables:
##  $ Family     : chr  &quot;Hawks&amp;Eagles&amp;Kites&quot; &quot;Long-tailed tits&quot; &quot;Larks&quot; &quot;Kingfishers&quot; ...
##  $ MaxAbund   : num  2.99 37.8 241.4 4.4 4.53 ...
##  $ AvgAbund   : num  0.674 4.04 23.105 0.595 2.963 ...
##  $ Mass       : num  716 5.3 35.8 119.4 315.5 ...
##  $ Diet       : Factor w/ 5 levels &quot;Insect&quot;,&quot;InsectVert&quot;,..: 5 1 4 5 2 4 5 1 1 5 ...
##  $ Passerine  : int  0 1 1 0 0 0 0 0 0 0 ...
##  $ Aquatic    : int  0 0 0 0 1 1 1 0 1 1 ...
##  $ logMass    : num  6.57 1.67 3.58 4.78 5.75 ...
##  $ logMaxAbund: num  1.09 3.63 5.49 1.48 1.51 ...</code></pre>
<details>
<p><summary><strong>Cliquez pour voir la solution au Défi 3!</strong></summary></p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="analysis-of-covariance-ancova.html#cb151-1"></a><span class="co"># If you did the section on Contrasts above, you will need</span></span>
<span id="cb151-2"><a href="analysis-of-covariance-ancova.html#cb151-2"></a><span class="co"># to reset the contrast to Treatment for ease of comparison</span></span>
<span id="cb151-3"><a href="analysis-of-covariance-ancova.html#cb151-3"></a><span class="co"># using the &#39;&#39;options()&#39;&#39; function Otherwise, skip the</span></span>
<span id="cb151-4"><a href="analysis-of-covariance-ancova.html#cb151-4"></a><span class="co"># first line of code below</span></span>
<span id="cb151-5"><a href="analysis-of-covariance-ancova.html#cb151-5"></a><span class="kw">options</span>(<span class="dt">contrasts =</span> <span class="kw">c</span>(<span class="st">&quot;contr.treatment&quot;</span>, <span class="st">&quot;contr.poly&quot;</span>))</span>
<span id="cb151-6"><a href="analysis-of-covariance-ancova.html#cb151-6"></a></span>
<span id="cb151-7"><a href="analysis-of-covariance-ancova.html#cb151-7"></a><span class="co"># solution</span></span>
<span id="cb151-8"><a href="analysis-of-covariance-ancova.html#cb151-8"></a>ancov1 &lt;-<span class="st"> </span><span class="kw">lm</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass <span class="op">*</span><span class="st"> </span>Diet, <span class="dt">data =</span> bird)</span>
<span id="cb151-9"><a href="analysis-of-covariance-ancova.html#cb151-9"></a><span class="kw">anova</span>(ancov1)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: logMaxAbund
##              Df Sum Sq Mean Sq F value  Pr(&gt;F)  
## logMass       1 10.464 10.4637  4.6054 0.03743 *
## Diet          4 17.749  4.4372  1.9530 0.11850  
## logMass:Diet  4 15.805  3.9513  1.7391 0.15849  
## Residuals    44 99.971  2.2721                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="analysis-of-covariance-ancova.html#cb153-1"></a><span class="kw">summary</span>(ancov1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = logMaxAbund ~ logMass * Diet, data = bird)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.1308 -0.7081 -0.0855  0.9854  2.5694 
## 
## Coefficients:
##                         Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)               3.7384     0.8042   4.648 3.05e-05 ***
## logMass                  -0.2865     0.1934  -1.481   0.1457    
## DietInsectVert           -4.4599     6.1652  -0.723   0.4733    
## DietPlant                 1.6796     4.7819   0.351   0.7271    
## DietPlantInsect           0.5537     1.3860   0.400   0.6914    
## DietVertebrate           -7.7409     2.9359  -2.637   0.0115 *  
## logMass:DietInsectVert    0.6745     1.2463   0.541   0.5911    
## logMass:DietPlant        -0.2631     1.1602  -0.227   0.8216    
## logMass:DietPlantInsect   0.1115     0.3427   0.325   0.7465    
## logMass:DietVertebrate    1.1665     0.4556   2.561   0.0140 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.507 on 44 degrees of freedom
## Multiple R-squared:  0.3057, Adjusted R-squared:  0.1637 
## F-statistic: 2.153 on 9 and 44 DF,  p-value: 0.04469</code></pre>
<p>In this case, the interaction term is not significant, meaning that the
effect of <em>logMass</em> on <em>logMaxAbund</em> does not differ between Diet
groups. The interaction term can thus be dropped, and the ANCOVA model
becomes:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="analysis-of-covariance-ancova.html#cb155-1"></a>ancov2 &lt;-<span class="st"> </span><span class="kw">lm</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass <span class="op">+</span><span class="st"> </span>Diet, <span class="dt">data =</span> bird)</span></code></pre></div>
<p>Because the R output shows that diet is also non-significant, this term
is dropped, and the final model corresponds to:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="analysis-of-covariance-ancova.html#cb156-1"></a>lm2 &lt;-<span class="st"> </span><span class="kw">lm</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass, <span class="dt">data =</span> bird)</span></code></pre></div>
<p>The model results can also be graphically represented using a plot of
the response variable as a function of the continuous explanatory
variable with different point and line colours for the different levels
of the categorical variable.</p>
<p>Plot the ANCOVA intercept and slopes (model ancov1 above) using the
<code>abline()</code> and <code>coef()</code> functions.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="analysis-of-covariance-ancova.html#cb157-1"></a><span class="kw">coef</span>(ancov1)</span></code></pre></div>
<pre><code>##             (Intercept)                 logMass          DietInsectVert 
##               3.7384247              -0.2864726              -4.4598537 
##               DietPlant         DietPlantInsect          DietVertebrate 
##               1.6795975               0.5537085              -7.7409274 
##  logMass:DietInsectVert       logMass:DietPlant logMass:DietPlantInsect 
##               0.6744893              -0.2631444               0.1114568 
##  logMass:DietVertebrate 
##               1.1665348</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="analysis-of-covariance-ancova.html#cb159-1"></a><span class="kw">plot</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass, <span class="dt">data =</span> bird, <span class="dt">col =</span> Diet, <span class="dt">pch =</span> <span class="dv">19</span>,</span>
<span id="cb159-2"><a href="analysis-of-covariance-ancova.html#cb159-2"></a>    <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span><span class="st"> &quot;(Maximum Abundance)&quot;</span>), <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span></span>
<span id="cb159-3"><a href="analysis-of-covariance-ancova.html#cb159-3"></a><span class="st">        &quot;(Mass)&quot;</span>))</span>
<span id="cb159-4"><a href="analysis-of-covariance-ancova.html#cb159-4"></a><span class="kw">abline</span>(<span class="dt">a =</span> <span class="kw">coef</span>(ancov1)[<span class="dv">1</span>], <span class="dt">b =</span> <span class="kw">coef</span>(ancov1)[<span class="dv">2</span>], <span class="dt">col =</span> <span class="st">&quot;deepskyblue1&quot;</span>)</span>
<span id="cb159-5"><a href="analysis-of-covariance-ancova.html#cb159-5"></a><span class="kw">abline</span>(<span class="dt">a =</span> <span class="kw">sum</span>(<span class="kw">coef</span>(ancov1)[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="kw">coef</span>(ancov1)[<span class="dv">3</span>]), <span class="dt">b =</span> <span class="kw">sum</span>(<span class="kw">coef</span>(ancov1)[<span class="dv">2</span>] <span class="op">+</span></span>
<span id="cb159-6"><a href="analysis-of-covariance-ancova.html#cb159-6"></a><span class="st">    </span><span class="kw">coef</span>(ancov1)[<span class="dv">7</span>]), <span class="dt">col =</span> <span class="st">&quot;green2&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb159-7"><a href="analysis-of-covariance-ancova.html#cb159-7"></a><span class="kw">abline</span>(<span class="dt">a =</span> <span class="kw">sum</span>(<span class="kw">coef</span>(ancov1)[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="kw">coef</span>(ancov1)[<span class="dv">4</span>]), <span class="dt">b =</span> <span class="kw">sum</span>(<span class="kw">coef</span>(ancov1)[<span class="dv">2</span>] <span class="op">+</span></span>
<span id="cb159-8"><a href="analysis-of-covariance-ancova.html#cb159-8"></a><span class="st">    </span><span class="kw">coef</span>(ancov1)[<span class="dv">8</span>]), <span class="dt">col =</span> <span class="st">&quot;orange1&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb159-9"><a href="analysis-of-covariance-ancova.html#cb159-9"></a><span class="kw">abline</span>(<span class="dt">a =</span> <span class="kw">sum</span>(<span class="kw">coef</span>(ancov1)[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="kw">coef</span>(ancov1)[<span class="dv">5</span>]), <span class="dt">b =</span> <span class="kw">sum</span>(<span class="kw">coef</span>(ancov1)[<span class="dv">2</span>] <span class="op">+</span></span>
<span id="cb159-10"><a href="analysis-of-covariance-ancova.html#cb159-10"></a><span class="st">    </span><span class="kw">coef</span>(ancov1)[<span class="dv">9</span>]), <span class="dt">col =</span> <span class="st">&quot;lightsteelblue1&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb159-11"><a href="analysis-of-covariance-ancova.html#cb159-11"></a><span class="kw">abline</span>(<span class="dt">a =</span> <span class="kw">sum</span>(<span class="kw">coef</span>(ancov1)[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="kw">coef</span>(ancov1)[<span class="dv">6</span>]), <span class="dt">b =</span> <span class="kw">sum</span>(<span class="kw">coef</span>(ancov1)[<span class="dv">2</span>] <span class="op">+</span></span>
<span id="cb159-12"><a href="analysis-of-covariance-ancova.html#cb159-12"></a><span class="st">    </span><span class="kw">coef</span>(ancov1)[<span class="dv">10</span>]), <span class="dt">col =</span> <span class="st">&quot;darkcyan&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="book-en_files/figure-html/unnamed-chunk-99-1.png" width="672" /></p>
</details>

</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="t-test-and-anova.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multiple-linear-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
