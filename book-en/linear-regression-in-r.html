<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Linear regression in R | Workshop 4: Linear models</title>
  <meta name="description" content="Linear models" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Linear regression in R | Workshop 4: Linear models" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/qcbsRworkshops/" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops//assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Linear models" />
  <meta name="github-repo" content="qcbsRworkshops/workshop04" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Linear regression in R | Workshop 4: Linear models" />
  
  <meta name="twitter:description" content="Linear models" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops//assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Developed and maintained by the contributors of the QCBS R Workshop Series" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="linear-models.html"/>
<link rel="next" href="t-test-and-anova.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>QCBS R Workshop Series</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-of-conduct"><i class="fa fa-check"></i><b>0.1</b> Code of conduct</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#expected-behaviour"><i class="fa fa-check"></i><b>0.1.1</b> Expected behaviour</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#unacceptable-behaviour"><i class="fa fa-check"></i><b>0.1.2</b> Unacceptable behaviour</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributors"><i class="fa fa-check"></i><b>0.2</b> Contributors</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contributing"><i class="fa fa-check"></i><b>0.3</b> Contributing</a></li>
</ul></li>
<li class="part"><span><b>Linear models in <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="learning-objectives.html"><a href="learning-objectives.html"><i class="fa fa-check"></i><b>1</b> Learning objectives</a></li>
<li class="chapter" data-level="2" data-path="preparing-for-the-workshop.html"><a href="preparing-for-the-workshop.html"><i class="fa fa-check"></i><b>2</b> Preparing for the workshop</a></li>
<li class="chapter" data-level="3" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>3</b> Linear models</a><ul>
<li class="chapter" data-level="3.1" data-path="linear-models.html"><a href="linear-models.html#what-is-a-linear-model"><i class="fa fa-check"></i><b>3.1</b> What is a linear model?</a><ul>
<li class="chapter" data-level="3.1.1" data-path="linear-models.html"><a href="linear-models.html#defining-mean-and-variation"><i class="fa fa-check"></i><b>3.1.1</b> Defining mean and variation</a></li>
<li class="chapter" data-level="3.1.2" data-path="linear-models.html"><a href="linear-models.html#linear-models-1"><i class="fa fa-check"></i><b>3.1.2</b> Linear models</a></li>
<li class="chapter" data-level="3.1.3" data-path="linear-models.html"><a href="linear-models.html#linear-model-assumptions"><i class="fa fa-check"></i><b>3.1.3</b> Linear model assumptions</a></li>
<li class="chapter" data-level="3.1.4" data-path="linear-models.html"><a href="linear-models.html#test-statistics-and-p-values"><i class="fa fa-check"></i><b>3.1.4</b> Test statistics and p-values</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html"><i class="fa fa-check"></i><b>4</b> Linear regression in R</a><ul>
<li class="chapter" data-level="4.1" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#simple-linear-regression"><i class="fa fa-check"></i><b>4.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="4.2" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#work-flow"><i class="fa fa-check"></i><b>4.2</b> Work flow</a><ul>
<li class="chapter" data-level="4.2.1" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#running-a-linear-model"><i class="fa fa-check"></i><b>4.2.1</b> 2.1 Running a linear model</a></li>
<li class="chapter" data-level="4.2.2" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#verifying-assumptions"><i class="fa fa-check"></i><b>4.2.2</b> Verifying assumptions</a></li>
<li class="chapter" data-level="4.2.3" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#normalizing-data"><i class="fa fa-check"></i><b>4.2.3</b> Normalizing data</a></li>
<li class="chapter" data-level="4.2.4" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#data-transformation"><i class="fa fa-check"></i><b>4.2.4</b> Data transformation</a></li>
<li class="chapter" data-level="4.2.5" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#model-output"><i class="fa fa-check"></i><b>4.2.5</b> Model output</a></li>
<li class="chapter" data-level="4.2.6" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#subsetting"><i class="fa fa-check"></i><b>4.2.6</b> Subsetting</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="linear-regression-in-r.html"><a href="linear-regression-in-r.html#challenge-1"><i class="fa fa-check"></i><b>4.3</b> CHALLENGE 1</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html"><i class="fa fa-check"></i><b>5</b> t-test and ANOVA</a><ul>
<li class="chapter" data-level="5.1" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#analysis-of-variance-anova"><i class="fa fa-check"></i><b>5.1</b> Analysis of Variance (ANOVA)</a><ul>
<li class="chapter" data-level="5.1.1" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#types-of-anova"><i class="fa fa-check"></i><b>5.1.1</b> 3.1 Types of ANOVA</a></li>
<li class="chapter" data-level="5.1.2" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#t-test"><i class="fa fa-check"></i><b>5.1.2</b> 3.2 T-test</a></li>
<li class="chapter" data-level="5.1.3" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#running-an-anova"><i class="fa fa-check"></i><b>5.1.3</b> 3.3 Running an ANOVA</a></li>
<li class="chapter" data-level="5.1.4" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#verifying-assumptions-1"><i class="fa fa-check"></i><b>5.1.4</b> 3.4 Verifying assumptions</a></li>
<li class="chapter" data-level="5.1.5" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#model-output-1"><i class="fa fa-check"></i><b>5.1.5</b> 3.5 Model output</a></li>
<li class="chapter" data-level="5.1.6" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#complementary-test"><i class="fa fa-check"></i><b>5.1.6</b> 3.6 Complementary test</a></li>
<li class="chapter" data-level="5.1.7" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#plotting"><i class="fa fa-check"></i><b>5.1.7</b> 3.7 Plotting</a></li>
<li class="chapter" data-level="5.1.8" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#going-further-contrasts"><i class="fa fa-check"></i><b>5.1.8</b> Going further: Contrasts</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#two-way-anova"><i class="fa fa-check"></i><b>5.2</b> 4. Two-way ANOVA</a><ul>
<li class="chapter" data-level="5.2.1" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#running-a-two-way-anova"><i class="fa fa-check"></i><b>5.2.1</b> 4.1 Running a two-way ANOVA</a></li>
<li class="chapter" data-level="5.2.2" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#interaction-plot"><i class="fa fa-check"></i><b>5.2.2</b> 4.2 Interaction plot</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="t-test-and-anova.html"><a href="t-test-and-anova.html#unbalanced-anova-advanced-section-optional"><i class="fa fa-check"></i><b>5.3</b> 5. Unbalanced ANOVA (advanced section/ optional)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="analysis-of-covariance-ancova.html"><a href="analysis-of-covariance-ancova.html"><i class="fa fa-check"></i><b>6</b> Analysis of covariance (ANCOVA)</a><ul>
<li class="chapter" data-level="6.0.1" data-path="analysis-of-covariance-ancova.html"><a href="analysis-of-covariance-ancova.html#assumptions-1"><i class="fa fa-check"></i><b>6.0.1</b> 6.1 Assumptions</a></li>
<li class="chapter" data-level="6.0.2" data-path="analysis-of-covariance-ancova.html"><a href="analysis-of-covariance-ancova.html#types-of-ancova"><i class="fa fa-check"></i><b>6.0.2</b> 6.2 Types of ANCOVA</a></li>
<li class="chapter" data-level="6.0.3" data-path="analysis-of-covariance-ancova.html"><a href="analysis-of-covariance-ancova.html#running-an-ancova"><i class="fa fa-check"></i><b>6.0.3</b> 6.3 Running an ANCOVA</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="multiple-regression.html"><a href="multiple-regression.html"><i class="fa fa-check"></i><b>7</b> Multiple regression</a><ul>
<li class="chapter" data-level="7.0.1" data-path="multiple-regression.html"><a href="multiple-regression.html#assumptions-2"><i class="fa fa-check"></i><b>7.0.1</b> 7.1 Assumptions</a></li>
<li class="chapter" data-level="7.0.2" data-path="multiple-regression.html"><a href="multiple-regression.html#dickcissel-dataset"><i class="fa fa-check"></i><b>7.0.2</b> 7.2 Dickcissel dataset</a></li>
<li class="chapter" data-level="7.0.3" data-path="multiple-regression.html"><a href="multiple-regression.html#going-further-polynomial-regression"><i class="fa fa-check"></i><b>7.0.3</b> Going further: Polynomial regression</a></li>
<li class="chapter" data-level="7.0.4" data-path="multiple-regression.html"><a href="multiple-regression.html#stepwise-regression"><i class="fa fa-check"></i><b>7.0.4</b> 7.4 Stepwise regression</a></li>
<li class="chapter" data-level="7.1" data-path="multiple-regression.html"><a href="multiple-regression.html#going-further-variance-partitioning"><i class="fa fa-check"></i><b>7.1</b> Going further: Variance partitioning</a></li>
</ul></li>
<li class="part"><span><b>Final considerations</b></span></li>
<li class="chapter" data-level="8" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>8</b> Summary</a></li>
<li class="chapter" data-level="9" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>9</b> Additional resources</a></li>
<li class="chapter" data-level="10" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>10</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Workshop 4: Linear models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>



<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
<div id="linear-regression-in-r" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Linear regression in R</h1>
<div id="simple-linear-regression" class="section level2">
<h2><span class="header-section-number">4.1</span> Simple linear regression</h2>
<p>Simple linear regression is a type of linear model which contains a
single, continuous explanatory variable. The regression tests whether
there is a significant correlation between the two variables.</p>
<p>Simple linear regression involves two parameters which must be
estimated: an intercept (<span class="math inline">\({β_0}\&lt;/m\&gt;) and a coefficient of correlation (\)</span>{β_1}&lt;/m&gt;). Ordinary least squares is the most
widely used estimation method, and also corresponds to the default
method of the <code>lm</code> function in R. Ordinary least squares fits a line
such that the sum of the squared vertical distances between the observed
data and the linear regression model (i.e. the residuals) is minimized.</p>
<p>Click below to see the math in more detail. Using ordinary
least squares, the intercept β<sub>0</sub> and the slope β<sub>1</sub> of the linear
regression can be calculated as:</p>
<p>$β_{1}={sum{i}{}{(x_{i}y_{i})}-overline{x}overline{y}}/sum{i}{}{(x_{i}-overline{x})}^2
= {Cov(x,y)}/{Var(x)}&lt;/m&gt;</p>
<p><span class="math inline">\(β\_{0}=overline{y}-β\_{1}overline{x}\)</span></p>
</div>
<div id="work-flow" class="section level2">
<h2><span class="header-section-number">4.2</span> Work flow</h2>
<p>Below we will explore several kinds of linear models. The way you create
and interpret each model will differ in the specifics, but the
principles behind them and the general work flow will remain the same.
For each model we will work through the following steps:</p>
<ol style="list-style-type: decimal">
<li>Visualize the data (data visualization could also come later in your
work flow)</li>
<li>Create a model</li>
<li>Test the model assumptions</li>
<li>Adjust the model if assumptions are violated</li>
<li>Interpret the model results</li>
</ol>
<div id="running-a-linear-model" class="section level3">
<h3><span class="header-section-number">4.2.1</span> 2.1 Running a linear model</h3>
<p>Using the bird dataset, we will first examine the linear regression of
maximum abundance as a function of mass.</p>
<p>In R, linear regression is implemented using the lm function from the
stats package:</p>
<p><code>lm (y ~ x)</code></p>
<table>
<tbody>
<tr class="odd">
<td align="left"><span class="ul"><strong>Note</strong></span>: before using a new function in R, users should refer to its help documentation (<code>?functionname</code>) to find out how to use the function as well as its preset default methods.</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="linear-regression-in-r.html#cb1-1"></a><span class="co"># Loading libraries and bird dataset</span></span>
<span id="cb1-2"><a href="linear-regression-in-r.html#cb1-2"></a><span class="kw">library</span>(e1071)</span>
<span id="cb1-3"><a href="linear-regression-in-r.html#cb1-3"></a><span class="kw">library</span>(MASS)</span>
<span id="cb1-4"><a href="linear-regression-in-r.html#cb1-4"></a><span class="kw">setwd</span>(<span class="st">&quot;~/Desktop/...&quot;</span>)  <span class="co"># Don&#39;t forget to set your working directory (note: your directory will be different)</span></span>
<span id="cb1-5"><a href="linear-regression-in-r.html#cb1-5"></a>bird &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;birdsdiet.csv&quot;</span>)</span>
<span id="cb1-6"><a href="linear-regression-in-r.html#cb1-6"></a></span>
<span id="cb1-7"><a href="linear-regression-in-r.html#cb1-7"></a><span class="co"># Visualize the dataframe</span></span>
<span id="cb1-8"><a href="linear-regression-in-r.html#cb1-8"></a><span class="kw">names</span>(bird)</span>
<span id="cb1-9"><a href="linear-regression-in-r.html#cb1-9"></a><span class="kw">str</span>(bird)</span>
<span id="cb1-10"><a href="linear-regression-in-r.html#cb1-10"></a><span class="kw">head</span>(bird)</span>
<span id="cb1-11"><a href="linear-regression-in-r.html#cb1-11"></a><span class="kw">summary</span>(bird)</span>
<span id="cb1-12"><a href="linear-regression-in-r.html#cb1-12"></a><span class="kw">plot</span>(bird)</span></code></pre></div>
<p>The bird dataset contains 7 variables:</p>
<table style="width:98%;">
<colgroup>
<col width="12%" />
<col width="49%" />
<col width="36%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Variable Name</th>
<th align="left">Description</th>
<th align="left">Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Family</td>
<td align="left">Common name of family</td>
<td align="left">String</td>
</tr>
<tr class="even">
<td align="left">MaxAbund</td>
<td align="left">The highest observed abundance at any site<br />
in North America</td>
<td align="left">Continuous/ numeric</td>
</tr>
<tr class="odd">
<td align="left">AvgAbund</td>
<td align="left">The average abundance across all sites<br />
where found in NA</td>
<td align="left">Continuous/ numeric</td>
</tr>
<tr class="even">
<td align="left">Mass</td>
<td align="left">The body size in grams</td>
<td align="left">Continuous/ numeric</td>
</tr>
<tr class="odd">
<td align="left">Diet</td>
<td align="left">Type of food consumed</td>
<td align="left">Discrete – 5 levels (Plant; PlantInsect;<br />
Insect; InsectVert; Vertebrate)</td>
</tr>
<tr class="even">
<td align="left">Passerine</td>
<td align="left">Is it a songbird/ perching bird</td>
<td align="left">Boolean (0/1)</td>
</tr>
<tr class="odd">
<td align="left">Aquatic</td>
<td align="left">Is it a bird that primarily lives in/ on/ next to the water</td>
<td align="left">Boolean (0/1)</td>
</tr>
</tbody>
</table>
<p>Note that Family, Diet, Passerine, and Aquatic are all categorical
variables although they are encoded in different ways (string, discrete,
boolean).</p>
<p>We are now ready to run our linear model:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="linear-regression-in-r.html#cb2-1"></a>lm1 &lt;-<span class="st"> </span><span class="kw">lm</span>(bird<span class="op">$</span>MaxAbund <span class="op">~</span><span class="st"> </span>bird<span class="op">$</span>Mass)  <span class="co"># where Y ~ X means Y &#39;as a function of&#39; X&gt;</span></span></code></pre></div>
</div>
<div id="verifying-assumptions" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Verifying assumptions</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="linear-regression-in-r.html#cb3-1"></a>opar &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))  <span class="co"># draws subsequent figures in a 2-by-2 panel</span></span>
<span id="cb3-2"><a href="linear-regression-in-r.html#cb3-2"></a><span class="kw">plot</span>(lm1)</span>
<span id="cb3-3"><a href="linear-regression-in-r.html#cb3-3"></a><span class="kw">par</span>(opar)  <span class="co"># resets to 1-by-1 plot</span></span></code></pre></div>
<div id="verifying-independence" class="section level4">
<h4><span class="header-section-number">4.2.2.1</span> Verifying independence</h4>
<p>Linear models can only be applied to independent data. This means that
the yi at a given xi value must not be influenced by other xi values.
Violation of independence can happen if your data represent some form of
dependence structure, such as spatial or temporal correlation.</p>
<p>There is no simple diagnostic plot for independence, unfortunately.
Instead, you must consider your data carefully. Is there some underlying
structure in your data that makes your data points dependent on each
other? If you collect data from the same sites over time (ie, a time
series) or if you collect multiple data points from the same organism,
your data violates the assumption of independence. You will need to use
a different type of model instead.</p>
</div>
<div id="verifying-residual-variance-is-constant-and-residual-mean-is-0" class="section level4">
<h4><span class="header-section-number">4.2.2.2</span> Verifying residual variance is constant and residual mean is 0</h4>
<p><em>Residual vs Fitted plot</em> - The first graph of the diagnostic plots is
called by <code>plot(lm1)</code>. This plot illustrates the spread of the residuals
between each fitted values. Each point represents the distance of the
response variable from the model prediction of the response variable. If
the residuals spread randomly around the 0 line, this indicates that the
relationship is linear and that the mean of the residuals is 0. If the
residuals form an approximate horizontal band around the 0 line, this
indicates homogeneity of error variance (ie, it is homoskedastic). If
the residuals form a funnel shape, this indicates the residuals are not
homoskedastic.</p>
<p><img src="images/workshop_3_lm1_residuals_vs_fitted.png" width="300" /></p>
<p><em>Scale-location plot</em> - The third graph of the diagnostic plots enables
one to verify whether the residual spread increases with a given fitted
values (i.e. identifies whether the spread in the residuals is due to
the selected explanatory variable). If the spread increases, the
homoscedasticity assumption is not respected.</p>
<p><img src="images/workshop_3_lm1_scale-location.png" width="300" /></p>
</div>
<div id="verifying-that-residuals-are-normally-distributed" class="section level4">
<h4><span class="header-section-number">4.2.2.3</span> Verifying that residuals are normally distributed</h4>
<p><em>QQ plot</em> - Normality can be assessed from the QQplot of the diagnostic
plots. This graph compares the probability distribution of the model
residuals to the probability distribution of normal data series. If the
standardized residuals lie linearly on the 1:1 line of the QQplot, the
residuals can be considered normally distributed.</p>
<p><img src="images/workshop_3_lm1_qq.png" width="300" /></p>
<p>The points of the QQplot are nonlinear, which suggests that the
residuals are not normally distributed.</p>
</div>
<div id="checking-for-high-leverage" class="section level4">
<h4><span class="header-section-number">4.2.2.4</span> Checking for high leverage</h4>
<p>In addition to the assumption testing above, we are also interested in
whether any of our data points have high leverage. This is not
assumption testing <em>per se</em>, but it will affect our interpretation of
the data. If some of the observations in a dataset possess strongly
different values from others, a model fitting problem can arise such
that these high leverage data influence the model calculation.</p>
<p><em>Residuals vs Leverage plot</em> - High leverage data can be visualised on
the fourth diagnostic plots (i.e. residuals vs leverage), which
identifies the observation numbers of the high leverage data point(s).
If (and only if!) these observations correspond to mis-measurements or
represent exceptions, they can be removed from the original dataset.<br />
<img src="images/workshop_3_lm1_leverage.png" width="300" /></p>
</div>
</div>
<div id="normalizing-data" class="section level3">
<h3><span class="header-section-number">4.2.3</span> Normalizing data</h3>
<p>In the example provided above, the model residuals were not normally
distributed and therefore the assumption of residual normality is
violated. We may still be able to use a linear regression model if we
can address this violation. The next step is to try to normalize the
variables using transformations. Often if we can make the explanatory
and/or response variables normally distributed then the model residuals
will become normally distributed. In addition to QQ-plots we can assess
the normality of a variable by drawing a histogram using the function
<code>hist</code>, and check visually whether the data series appears to follow a
normal distribution. For example:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="linear-regression-in-r.html#cb4-1"></a><span class="co"># Plot Y ~ X and the regression line</span></span>
<span id="cb4-2"><a href="linear-regression-in-r.html#cb4-2"></a><span class="kw">plot</span>(bird<span class="op">$</span>MaxAbund <span class="op">~</span><span class="st"> </span>bird<span class="op">$</span>Mass, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="st">&quot;coral&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Maximum Abundance&quot;</span>,</span>
<span id="cb4-3"><a href="linear-regression-in-r.html#cb4-3"></a>    <span class="dt">xlab =</span> <span class="st">&quot;Mass&quot;</span>)</span>
<span id="cb4-4"><a href="linear-regression-in-r.html#cb4-4"></a><span class="kw">abline</span>(lm1, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb4-5"><a href="linear-regression-in-r.html#cb4-5"></a><span class="st">`</span><span class="dt">?</span><span class="st">`</span>(plot  <span class="co"># For further details on plot() arguments</span></span>
<span id="cb4-6"><a href="linear-regression-in-r.html#cb4-6"></a>)</span>
<span id="cb4-7"><a href="linear-regression-in-r.html#cb4-7"></a><span class="co"># see colours() for list of colours</span></span>
<span id="cb4-8"><a href="linear-regression-in-r.html#cb4-8"></a></span>
<span id="cb4-9"><a href="linear-regression-in-r.html#cb4-9"></a><span class="co"># Is the data normally distributed?</span></span>
<span id="cb4-10"><a href="linear-regression-in-r.html#cb4-10"></a><span class="kw">hist</span>(bird<span class="op">$</span>MaxAbund, <span class="dt">col =</span> <span class="st">&quot;coral&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Untransformed data&quot;</span>,</span>
<span id="cb4-11"><a href="linear-regression-in-r.html#cb4-11"></a>    <span class="dt">xlab =</span> <span class="st">&quot;Maximum Abundance&quot;</span>)</span>
<span id="cb4-12"><a href="linear-regression-in-r.html#cb4-12"></a><span class="kw">hist</span>(bird<span class="op">$</span>Mass, <span class="dt">col =</span> <span class="st">&quot;coral&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Untransformed data&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Mass&quot;</span>)</span></code></pre></div>
<p><img src="images/lm1_yvsx.png" width="300" /> <img src="images/maxabund_hist.png" width="300" />
<img src="images/mass_hist.png" width="300" /></p>
<p>A third way to assess normality is to use the Shapiro-Wilk normality
test that compares the distribution of the observed data series to a
normal distribution using the function <code>shapiro.test</code>.</p>
<p>The null and alternate hypotheses of this test are:</p>
<p>H<sub>0</sub>: the observed data series is normally distributed,<br />
H<sub>1</sub>: the observed data series is not normally distributed,</p>
<p>The observed data series can be considered normally distributed when the
p-value calculated by the Shapiro-Wilk normality test is greater than or
equal to α, typically set to 0.05.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="linear-regression-in-r.html#cb5-1"></a><span class="co"># Test null hypothesis that the sample came from a normally</span></span>
<span id="cb5-2"><a href="linear-regression-in-r.html#cb5-2"></a><span class="co"># distributed population</span></span>
<span id="cb5-3"><a href="linear-regression-in-r.html#cb5-3"></a><span class="kw">shapiro.test</span>(bird<span class="op">$</span>MaxAbund)</span>
<span id="cb5-4"><a href="linear-regression-in-r.html#cb5-4"></a><span class="kw">shapiro.test</span>(bird<span class="op">$</span>Mass)</span>
<span id="cb5-5"><a href="linear-regression-in-r.html#cb5-5"></a><span class="co"># If p &lt; 0.05, then distribution is not-normal if p &gt; 0.05,</span></span>
<span id="cb5-6"><a href="linear-regression-in-r.html#cb5-6"></a><span class="co"># then distribution is normal</span></span></code></pre></div>
<p>We can also evaluate the skewness of each distribution using the
<code>Skewness</code> function:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="linear-regression-in-r.html#cb6-1"></a><span class="kw">skewness</span>(bird<span class="op">$</span>MaxAbund)</span>
<span id="cb6-2"><a href="linear-regression-in-r.html#cb6-2"></a><span class="kw">skewness</span>(bird<span class="op">$</span>Mass)</span>
<span id="cb6-3"><a href="linear-regression-in-r.html#cb6-3"></a><span class="co"># where positive values indicate a left-skewed</span></span>
<span id="cb6-4"><a href="linear-regression-in-r.html#cb6-4"></a><span class="co"># distribution, and negative value a right skew.</span></span></code></pre></div>
<p>The histograms, Shapiro tests and Skewness all indicate that the
variables need to be transformed to normalize (e.g. a log<sub>10</sub>
transformation).</p>
</div>
<div id="data-transformation" class="section level3">
<h3><span class="header-section-number">4.2.4</span> Data transformation</h3>
<p>In case of non-normality, response and explanatory variables can be
transformed to enhance their normality following these rules:</p>
<table style="width:98%;">
<colgroup>
<col width="33%" />
<col width="26%" />
<col width="37%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Type of distribution</th>
<th align="left">Transformation</th>
<th align="left">R function</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Moderately positive skewness</td>
<td align="left"><span class="math inline">\(sqrt{x}\)</span> sqrt(x)</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Substantially positive skewness</td>
<td align="left"><span class="math inline">\(log_10{(x)}\)</span> log10(x)</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Substantially positive skewness</td>
<td align="left"><span class="math inline">\(log_10{(x+C)}\)</span> log10(x +</td>
<td align="left">C) where C is a constant<br />
added to each value of x so that<br />
the smallest score is 1</td>
</tr>
<tr class="even">
<td align="left">Moderately negative skewness</td>
<td align="left"><span class="math inline">\(sqrt{(K-x)}\)</span> sqrt(K - x</td>
<td align="left">) where K is a constant<br />
subtracted from each value of x<br />
so that the smallest score is 1</td>
</tr>
<tr class="odd">
<td align="left">Substantially negative skewness</td>
<td align="left"><span class="math inline">\(log_10{(K-x)}\)</span> log10(K -</td>
<td align="left">x)</td>
</tr>
</tbody>
</table>
<p>Thus, log<sub>10</sub> transformations should be applied and saved in the bird
data frame. The model can then be re-run, verified and interpreted.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="linear-regression-in-r.html#cb7-1"></a><span class="co"># Add log10() transformed variables to your dataframe</span></span>
<span id="cb7-2"><a href="linear-regression-in-r.html#cb7-2"></a>bird<span class="op">$</span>logMaxAbund &lt;-<span class="st"> </span><span class="kw">log10</span>(bird<span class="op">$</span>MaxAbund)</span>
<span id="cb7-3"><a href="linear-regression-in-r.html#cb7-3"></a>bird<span class="op">$</span>logMass &lt;-<span class="st"> </span><span class="kw">log10</span>(bird<span class="op">$</span>Mass)</span>
<span id="cb7-4"><a href="linear-regression-in-r.html#cb7-4"></a><span class="kw">names</span>(bird)  <span class="co"># to view the dataframe + new transformed variables</span></span>
<span id="cb7-5"><a href="linear-regression-in-r.html#cb7-5"></a></span>
<span id="cb7-6"><a href="linear-regression-in-r.html#cb7-6"></a><span class="kw">hist</span>(bird<span class="op">$</span>logMaxAbund, <span class="dt">col =</span> <span class="st">&quot;yellowgreen&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Log transformed&quot;</span>,</span>
<span id="cb7-7"><a href="linear-regression-in-r.html#cb7-7"></a>    <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span><span class="st"> &quot;(Maximum Abundance)&quot;</span>))</span>
<span id="cb7-8"><a href="linear-regression-in-r.html#cb7-8"></a><span class="kw">hist</span>(bird<span class="op">$</span>logMass, <span class="dt">col =</span> <span class="st">&quot;yellowgreen&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Log transformed&quot;</span>,</span>
<span id="cb7-9"><a href="linear-regression-in-r.html#cb7-9"></a>    <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span><span class="st"> &quot;(Mass)&quot;</span>))</span>
<span id="cb7-10"><a href="linear-regression-in-r.html#cb7-10"></a><span class="kw">shapiro.test</span>(bird<span class="op">$</span>logMaxAbund)</span>
<span id="cb7-11"><a href="linear-regression-in-r.html#cb7-11"></a><span class="kw">skewness</span>(bird<span class="op">$</span>logMaxAbund)</span>
<span id="cb7-12"><a href="linear-regression-in-r.html#cb7-12"></a><span class="kw">shapiro.test</span>(bird<span class="op">$</span>logMass)</span>
<span id="cb7-13"><a href="linear-regression-in-r.html#cb7-13"></a><span class="kw">skewness</span>(bird<span class="op">$</span>logMass)</span>
<span id="cb7-14"><a href="linear-regression-in-r.html#cb7-14"></a></span>
<span id="cb7-15"><a href="linear-regression-in-r.html#cb7-15"></a><span class="co"># Re-run your analysis with the appropriate transformations</span></span>
<span id="cb7-16"><a href="linear-regression-in-r.html#cb7-16"></a>lm2 &lt;-<span class="st"> </span><span class="kw">lm</span>(bird<span class="op">$</span>logMaxAbund <span class="op">~</span><span class="st"> </span>bird<span class="op">$</span>logMass)</span>
<span id="cb7-17"><a href="linear-regression-in-r.html#cb7-17"></a></span>
<span id="cb7-18"><a href="linear-regression-in-r.html#cb7-18"></a><span class="co"># Are there remaining problems with the diagnostics</span></span>
<span id="cb7-19"><a href="linear-regression-in-r.html#cb7-19"></a><span class="co"># (heteroscedasticity, non-independence, high leverage)?</span></span>
<span id="cb7-20"><a href="linear-regression-in-r.html#cb7-20"></a>opar &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb7-21"><a href="linear-regression-in-r.html#cb7-21"></a><span class="kw">plot</span>(lm2, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="st">&quot;gray&quot;</span>)</span>
<span id="cb7-22"><a href="linear-regression-in-r.html#cb7-22"></a><span class="kw">par</span>(opar)</span></code></pre></div>
<p><img src="images/hist_logmaxabund.png" width="300" />
<img src="images/hist_logmass.png" width="300" /> <img src="images/plot_lm2_.png" width="550" /></p>
</div>
<div id="model-output" class="section level3">
<h3><span class="header-section-number">4.2.5</span> Model output</h3>
<p>Once all these assumptions have been verified, the model results can be
interpreted. These results are called in R using the function <code>summary</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="linear-regression-in-r.html#cb8-1"></a><span class="co"># Now we can look at the model coefficients and p-values</span></span>
<span id="cb8-2"><a href="linear-regression-in-r.html#cb8-2"></a><span class="kw">summary</span>(lm2)</span>
<span id="cb8-3"><a href="linear-regression-in-r.html#cb8-3"></a></span>
<span id="cb8-4"><a href="linear-regression-in-r.html#cb8-4"></a><span class="co"># You can also just call up the coefficients of the model</span></span>
<span id="cb8-5"><a href="linear-regression-in-r.html#cb8-5"></a>lm2<span class="op">$</span>coef</span>
<span id="cb8-6"><a href="linear-regression-in-r.html#cb8-6"></a></span>
<span id="cb8-7"><a href="linear-regression-in-r.html#cb8-7"></a><span class="co"># What else?</span></span>
<span id="cb8-8"><a href="linear-regression-in-r.html#cb8-8"></a><span class="kw">str</span>(<span class="kw">summary</span>(lm2))</span>
<span id="cb8-9"><a href="linear-regression-in-r.html#cb8-9"></a><span class="kw">summary</span>(lm2)<span class="op">$</span>coefficients  <span class="co"># where Std. Error is the standard error of each estimate</span></span>
<span id="cb8-10"><a href="linear-regression-in-r.html#cb8-10"></a><span class="kw">summary</span>(lm2)<span class="op">$</span>r.squared  <span class="co"># Coefficient of determination</span></span>
<span id="cb8-11"><a href="linear-regression-in-r.html#cb8-11"></a><span class="kw">summary</span>(lm2)<span class="op">$</span>adj.r.squared  <span class="co"># Adjusted coefficient of determination</span></span>
<span id="cb8-12"><a href="linear-regression-in-r.html#cb8-12"></a><span class="kw">summary</span>(lm2)<span class="op">$</span>sigma  <span class="co"># Residual standard error (square root of Error Mean Square)</span></span>
<span id="cb8-13"><a href="linear-regression-in-r.html#cb8-13"></a><span class="co"># etc…</span></span>
<span id="cb8-14"><a href="linear-regression-in-r.html#cb8-14"></a></span>
<span id="cb8-15"><a href="linear-regression-in-r.html#cb8-15"></a><span class="co"># You can also check for yourself the equation for R2:</span></span>
<span id="cb8-16"><a href="linear-regression-in-r.html#cb8-16"></a>SSE =<span class="st"> </span><span class="kw">sum</span>(<span class="kw">resid</span>(lm2)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb8-17"><a href="linear-regression-in-r.html#cb8-17"></a>SST =<span class="st"> </span><span class="kw">sum</span>((bird<span class="op">$</span>logMaxAbund <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(bird<span class="op">$</span>logMaxAbund))<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb8-18"><a href="linear-regression-in-r.html#cb8-18"></a>R2 =<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>((SSE)<span class="op">/</span>SST)</span>
<span id="cb8-19"><a href="linear-regression-in-r.html#cb8-19"></a>R2</span></code></pre></div>
<p>The output of this function presents all the results of your validated
model:</p>
<pre><code>lm(formula = logMaxAbund ~ logMass, data = bird)
Residuals:
          Min         1Q          Median          3Q          Max
               -1.93562   -0.39982    0.05487     0.40625     1.61469
              Estimate    Std. Error  t value     Pr(&gt;|t|)
(Intercept)     1.6724        0.2472      6.767       1.17e-08 ***
logMass          -0.2361          0.1170      -2.019      0.0487 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
Residual standard error: 0.6959 on 52 degrees of freedom
Multiple R-squared:  0.07267,   Adjusted R-squared:  0.05484
F-statistic: 4.075 on 1 and 52 DF,  p-value: 0.04869</code></pre>
<p>The coefficients of the regression model and their associated standard
error appear in the second and third columns of the regression table,
respectively. Thus,<br />
β<sub>0</sub> = 1.6724 ± 0.2472 is the intercept (± se) of the regression model,<br />
β<sub>1</sub> = -0.2361 ± 0.1170 is the slope (± se) of the regression model.</p>
<p>and finally: $ $<em>logMaxAbund</em> = 1.6724 (± 0.2472) - 0.2361 (±
0.1170) x <em>logMass</em></p>
<p>The t-value and their associated p-value (in the fourth and fifth
columns of the regression table, respectively) test for a significant
difference between the calculated coefficients and zero. In this case,
we can see that <em>logMass</em> has a significant influence on <em>logMaxAbund</em>
because the p-value associated with the slope of the regression model is
inferior to 0.05. Moreover, these two variables are negatively related
as the slope of the regression model is negative.<br />
Users must, however, be aware that significant relationship between two
variables does not always imply causality. Conversely, the absence of
significant linear regression between y and x does not always imply an
absence of relationship between these two variables; this is for example
the case when a relationship is not linear.</p>
<p>The goodness of fit of the linear regression model is assessed from the
<strong>adjusted-R<sup>2</sup></strong> (here, 0.05484). This value is a measure of the
proportion of variation explained by the model.</p>
<p>Click below to see the math in more detail. $
overline{R}^2=1-(1-R^2){n-1}/{n-p-1} &lt;/m&gt;</p>
<p>where<br />
p is the total number of regressors and n is the sample size,<br />
$ R^2={SS_reg}/{SS_tot} &lt;/m&gt;<br />
$ {SS_tot}=sum{i}{}{({y_i}-overline{y})}^2 <span class="math inline">\(is the total sums of squares,\
\)</span> {SS_reg}=sum{i}{}{(hat{y_i}-overline{y})}^2 $is the
regression sums of squares - also called the explained sums of squares.</p>
<p>The higher the adjusted-R<sup>2</sup> is, the better the data fit the statistical
model, knowing that this coefficient varies between 0 and 1. In this
case, the relationship between <em>logMaxAbund</em> and <em>logMass</em> is quite
weak.<br />
The last line of the R output represents the F-statistic of the model
and its associated p-value. If this p-value is inferior to 0.05, the
model explains the data relationship better than a null model.<br />
==== 2.6 Plotting ====</p>
<p>Linear regression results are generally represented by a plot of the
response variable as a function of the explanatory variable on which the
regression line is added (and if needed the confidence intervals), using
the R code:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="linear-regression-in-r.html#cb10-1"></a><span class="kw">plot</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass, <span class="dt">data =</span> bird, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="st">&quot;yellowgreen&quot;</span>,</span>
<span id="cb10-2"><a href="linear-regression-in-r.html#cb10-2"></a>    <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span><span class="st"> &quot;(Maximum Abundance)&quot;</span>), <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span></span>
<span id="cb10-3"><a href="linear-regression-in-r.html#cb10-3"></a><span class="st">        &quot;(Mass)&quot;</span>))</span>
<span id="cb10-4"><a href="linear-regression-in-r.html#cb10-4"></a><span class="kw">abline</span>(lm2, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb10-5"><a href="linear-regression-in-r.html#cb10-5"></a></span>
<span id="cb10-6"><a href="linear-regression-in-r.html#cb10-6"></a><span class="co"># You may also flag the previously identified</span></span>
<span id="cb10-7"><a href="linear-regression-in-r.html#cb10-7"></a><span class="co"># high-leveraged points</span></span>
<span id="cb10-8"><a href="linear-regression-in-r.html#cb10-8"></a><span class="kw">points</span>(bird<span class="op">$</span>logMass[<span class="dv">32</span>], bird<span class="op">$</span>logMaxAbund[<span class="dv">32</span>], <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="st">&quot;violet&quot;</span>)</span>
<span id="cb10-9"><a href="linear-regression-in-r.html#cb10-9"></a><span class="kw">points</span>(bird<span class="op">$</span>logMass[<span class="dv">21</span>], bird<span class="op">$</span>logMaxAbund[<span class="dv">21</span>], <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="st">&quot;violet&quot;</span>)</span>
<span id="cb10-10"><a href="linear-regression-in-r.html#cb10-10"></a><span class="kw">points</span>(bird<span class="op">$</span>logMass[<span class="dv">50</span>], bird<span class="op">$</span>logMaxAbund[<span class="dv">50</span>], <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="st">&quot;violet&quot;</span>)</span>
<span id="cb10-11"><a href="linear-regression-in-r.html#cb10-11"></a></span>
<span id="cb10-12"><a href="linear-regression-in-r.html#cb10-12"></a><span class="co"># We can also plot the confidence intervals</span></span>
<span id="cb10-13"><a href="linear-regression-in-r.html#cb10-13"></a>confit &lt;-<span class="st"> </span><span class="kw">predict</span>(lm2, <span class="dt">interval =</span> <span class="st">&quot;confidence&quot;</span>)</span>
<span id="cb10-14"><a href="linear-regression-in-r.html#cb10-14"></a><span class="kw">points</span>(bird<span class="op">$</span>logMass, confit[, <span class="dv">2</span>])</span>
<span id="cb10-15"><a href="linear-regression-in-r.html#cb10-15"></a><span class="kw">points</span>(bird<span class="op">$</span>logMass, confit[, <span class="dv">3</span>])</span></code></pre></div>
<p><img src="images/yvxx_lm2.png" width="400" /></p>
</div>
<div id="subsetting" class="section level3">
<h3><span class="header-section-number">4.2.6</span> Subsetting</h3>
<p>We may also run the analysis on a subset of observations, for example,
on terrestrial birds only.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="linear-regression-in-r.html#cb11-1"></a><span class="co"># Recall that you can exclude objects using &#39;!&#39;  We can</span></span>
<span id="cb11-2"><a href="linear-regression-in-r.html#cb11-2"></a><span class="co"># analyze a subset of this data using this subset command</span></span>
<span id="cb11-3"><a href="linear-regression-in-r.html#cb11-3"></a><span class="co"># in lm()</span></span>
<span id="cb11-4"><a href="linear-regression-in-r.html#cb11-4"></a>lm3 &lt;-<span class="st"> </span><span class="kw">lm</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass, <span class="dt">data =</span> bird, <span class="dt">subset =</span> <span class="op">!</span>bird<span class="op">$</span>Aquatic)  <span class="co"># removing the Aquatic birds</span></span>
<span id="cb11-5"><a href="linear-regression-in-r.html#cb11-5"></a></span>
<span id="cb11-6"><a href="linear-regression-in-r.html#cb11-6"></a><span class="co"># or equivalently</span></span>
<span id="cb11-7"><a href="linear-regression-in-r.html#cb11-7"></a>lm3 &lt;-<span class="st"> </span><span class="kw">lm</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass, <span class="dt">data =</span> bird, <span class="dt">subset =</span> bird<span class="op">$</span>Aquatic <span class="op">==</span></span>
<span id="cb11-8"><a href="linear-regression-in-r.html#cb11-8"></a><span class="st">    </span><span class="dv">0</span>)</span>
<span id="cb11-9"><a href="linear-regression-in-r.html#cb11-9"></a></span>
<span id="cb11-10"><a href="linear-regression-in-r.html#cb11-10"></a><span class="co"># Examine the model</span></span>
<span id="cb11-11"><a href="linear-regression-in-r.html#cb11-11"></a>opar &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb11-12"><a href="linear-regression-in-r.html#cb11-12"></a><span class="kw">plot</span>(lm3, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dv">33</span>, <span class="dv">33</span>, <span class="dv">33</span>, <span class="dv">100</span>, <span class="dt">maxColorValue =</span> <span class="dv">225</span>))</span>
<span id="cb11-13"><a href="linear-regression-in-r.html#cb11-13"></a><span class="kw">summary</span>(lm3)</span>
<span id="cb11-14"><a href="linear-regression-in-r.html#cb11-14"></a><span class="kw">par</span>(opar)</span>
<span id="cb11-15"><a href="linear-regression-in-r.html#cb11-15"></a></span>
<span id="cb11-16"><a href="linear-regression-in-r.html#cb11-16"></a><span class="co"># Compare the two datasets</span></span>
<span id="cb11-17"><a href="linear-regression-in-r.html#cb11-17"></a>opar &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb11-18"><a href="linear-regression-in-r.html#cb11-18"></a><span class="kw">plot</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass, <span class="dt">data =</span> bird, <span class="dt">main =</span> <span class="st">&quot;All birds&quot;</span>,</span>
<span id="cb11-19"><a href="linear-regression-in-r.html#cb11-19"></a>    <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span><span class="st"> &quot;(Maximum Abundance)&quot;</span>), <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span></span>
<span id="cb11-20"><a href="linear-regression-in-r.html#cb11-20"></a><span class="st">        &quot;(Mass)&quot;</span>))</span>
<span id="cb11-21"><a href="linear-regression-in-r.html#cb11-21"></a><span class="kw">abline</span>(lm2, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb11-22"><a href="linear-regression-in-r.html#cb11-22"></a></span>
<span id="cb11-23"><a href="linear-regression-in-r.html#cb11-23"></a><span class="kw">plot</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass, <span class="dt">data =</span> bird, <span class="dt">subset =</span> <span class="op">!</span>bird<span class="op">$</span>Aquatic,</span>
<span id="cb11-24"><a href="linear-regression-in-r.html#cb11-24"></a>    <span class="dt">main =</span> <span class="st">&quot;Terrestrial birds&quot;</span>, <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span></span>
<span id="cb11-25"><a href="linear-regression-in-r.html#cb11-25"></a><span class="st">        &quot;(Maximum Abundance)&quot;</span>), <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span></span>
<span id="cb11-26"><a href="linear-regression-in-r.html#cb11-26"></a><span class="st">        &quot;(Mass)&quot;</span>))</span>
<span id="cb11-27"><a href="linear-regression-in-r.html#cb11-27"></a><span class="kw">abline</span>(lm3, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb11-28"><a href="linear-regression-in-r.html#cb11-28"></a><span class="kw">opar</span>(par)</span></code></pre></div>
</div>
</div>
<div id="challenge-1" class="section level2">
<h2><span class="header-section-number">4.3</span> CHALLENGE 1</h2>
<p>Examine the relationship between <em>log<sub>10</sub>(MaxAbund)</em> and <em>log<sub>10</sub>(Mass)</em>
for passerine birds.<br />
<code>HINT:</code> Passerine is coded 0 and 1 just like Aquatic. You can verify
this by viewing the structure <code>str(bird)</code>.</p>
<p>++++ Challenge 1: Solution |</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="linear-regression-in-r.html#cb12-1"></a>lm4 &lt;-<span class="st"> </span><span class="kw">lm</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass, <span class="dt">data =</span> bird, <span class="dt">subset =</span> bird<span class="op">$</span>Passerine <span class="op">==</span></span>
<span id="cb12-2"><a href="linear-regression-in-r.html#cb12-2"></a><span class="st">    </span><span class="dv">1</span>)</span>
<span id="cb12-3"><a href="linear-regression-in-r.html#cb12-3"></a></span>
<span id="cb12-4"><a href="linear-regression-in-r.html#cb12-4"></a><span class="co"># Examine the diagnostic plots</span></span>
<span id="cb12-5"><a href="linear-regression-in-r.html#cb12-5"></a>opar &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb12-6"><a href="linear-regression-in-r.html#cb12-6"></a><span class="kw">plot</span>(lm4)</span>
<span id="cb12-7"><a href="linear-regression-in-r.html#cb12-7"></a><span class="kw">summary</span>(lm4)</span>
<span id="cb12-8"><a href="linear-regression-in-r.html#cb12-8"></a><span class="kw">par</span>(opar)</span>
<span id="cb12-9"><a href="linear-regression-in-r.html#cb12-9"></a></span>
<span id="cb12-10"><a href="linear-regression-in-r.html#cb12-10"></a><span class="co"># Compare variance explained by lm2, lm3 and lm4</span></span>
<span id="cb12-11"><a href="linear-regression-in-r.html#cb12-11"></a><span class="kw">str</span>(<span class="kw">summary</span>(lm4))  <span class="co"># Recall: we want adj.r.squared</span></span>
<span id="cb12-12"><a href="linear-regression-in-r.html#cb12-12"></a><span class="kw">summary</span>(lm4)<span class="op">$</span>adj.r.squared  <span class="co"># R2-adj = -0.02</span></span>
<span id="cb12-13"><a href="linear-regression-in-r.html#cb12-13"></a><span class="kw">summary</span>(lm2)<span class="op">$</span>adj.r.squared  <span class="co"># R2-adj = 0.05</span></span>
<span id="cb12-14"><a href="linear-regression-in-r.html#cb12-14"></a><span class="kw">summary</span>(lm3)<span class="op">$</span>adj.r.squared  <span class="co"># R2-adj = 0.25</span></span>
<span id="cb12-15"><a href="linear-regression-in-r.html#cb12-15"></a></span>
<span id="cb12-16"><a href="linear-regression-in-r.html#cb12-16"></a><span class="co"># Visually compare the three models</span></span>
<span id="cb12-17"><a href="linear-regression-in-r.html#cb12-17"></a>opar &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb12-18"><a href="linear-regression-in-r.html#cb12-18"></a><span class="kw">plot</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass, <span class="dt">data =</span> bird, <span class="dt">main =</span> <span class="st">&quot;All birds&quot;</span>,</span>
<span id="cb12-19"><a href="linear-regression-in-r.html#cb12-19"></a>    <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span><span class="st"> &quot;(Maximum Abundance)&quot;</span>), <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span></span>
<span id="cb12-20"><a href="linear-regression-in-r.html#cb12-20"></a><span class="st">        &quot;(Mass)&quot;</span>), <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="st">&quot;yellowgreen&quot;</span>)</span>
<span id="cb12-21"><a href="linear-regression-in-r.html#cb12-21"></a><span class="kw">abline</span>(lm2, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb12-22"><a href="linear-regression-in-r.html#cb12-22"></a></span>
<span id="cb12-23"><a href="linear-regression-in-r.html#cb12-23"></a><span class="kw">plot</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass, <span class="dt">subset =</span> Passerine <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> bird,</span>
<span id="cb12-24"><a href="linear-regression-in-r.html#cb12-24"></a>    <span class="dt">main =</span> <span class="st">&quot;Passerine birds&quot;</span>, <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span><span class="st"> &quot;(Maximum Abundance)&quot;</span>),</span>
<span id="cb12-25"><a href="linear-regression-in-r.html#cb12-25"></a>    <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span><span class="st"> &quot;(Mass)&quot;</span>), <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="st">&quot;violet&quot;</span>)</span>
<span id="cb12-26"><a href="linear-regression-in-r.html#cb12-26"></a><span class="kw">abline</span>(lm4, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb12-27"><a href="linear-regression-in-r.html#cb12-27"></a></span>
<span id="cb12-28"><a href="linear-regression-in-r.html#cb12-28"></a><span class="kw">plot</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass, <span class="dt">data =</span> bird, <span class="dt">subset =</span> <span class="op">!</span>bird<span class="op">$</span>Aquatic,</span>
<span id="cb12-29"><a href="linear-regression-in-r.html#cb12-29"></a>    <span class="dt">main =</span> <span class="st">&quot;Terrestrial birds&quot;</span>, <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span></span>
<span id="cb12-30"><a href="linear-regression-in-r.html#cb12-30"></a><span class="st">        &quot;(Maximum Abundance)&quot;</span>), <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span></span>
<span id="cb12-31"><a href="linear-regression-in-r.html#cb12-31"></a><span class="st">        &quot;(Mass)&quot;</span>), <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb12-32"><a href="linear-regression-in-r.html#cb12-32"></a><span class="kw">abline</span>(lm3, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb12-33"><a href="linear-regression-in-r.html#cb12-33"></a><span class="kw">par</span>(opar)</span></code></pre></div>
<p><strong>Conclusion:</strong> The best model among the three is lm3 (only terrestrial
birds) <img src="images/lm2_lm3_lm4.png" width="850" /> ++++</p>

</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="linear-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="t-test-and-anova.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
