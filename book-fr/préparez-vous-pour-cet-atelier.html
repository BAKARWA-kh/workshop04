<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 2 Préparez-vous pour cet atelier | Atelier 4: Modèles linéaires</title>
  <meta name="description" content="Modèles linéaires" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 2 Préparez-vous pour cet atelier | Atelier 4: Modèles linéaires" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/qcbsRworkshops/" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops//assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Modèles linéaires" />
  <meta name="github-repo" content="qcbsRworkshops/workshop04" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 2 Préparez-vous pour cet atelier | Atelier 4: Modèles linéaires" />
  
  <meta name="twitter:description" content="Modèles linéaires" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops//assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Développé et entretenu par les contributeurs et les contributrices de la Série d’ateliers R du CSBQ." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="objectifs-dapprentissage.html"/>
<link rel="next" href="test-de-t-et-anova.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>Série d’ateliers R du CSBQ</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-de-conduite"><i class="fa fa-check"></i><b>0.1</b> Code de conduite</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#comportement-attendu"><i class="fa fa-check"></i><b>0.1.1</b> Comportement attendu</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#comportements-inacceptables"><i class="fa fa-check"></i><b>0.1.2</b> Comportements inacceptables</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributeurs-et-contributrices"><i class="fa fa-check"></i><b>0.2</b> Contributeurs et contributrices</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contribuez-à-la-série"><i class="fa fa-check"></i><b>0.3</b> Contribuez à la série!</a></li>
</ul></li>
<li class="part"><span><b>Modèles linéaires en <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="objectifs-dapprentissage.html"><a href="objectifs-dapprentissage.html"><i class="fa fa-check"></i><b>1</b> Objectifs d’apprentissage</a></li>
<li class="chapter" data-level="2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html"><i class="fa fa-check"></i><b>2</b> Préparez-vous pour cet atelier</a><ul>
<li class="chapter" data-level="2.1" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#aperçu"><i class="fa fa-check"></i><b>2.1</b> 1. Aperçu</a><ul>
<li class="chapter" data-level="2.1.1" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#définir-la-moyenne-et-la-variation"><i class="fa fa-check"></i><b>2.1.1</b> 1.1 Définir la moyenne et la variation</a></li>
<li class="chapter" data-level="2.1.2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#les-modèles-linéaires"><i class="fa fa-check"></i><b>2.1.2</b> 1.2 Les modèles linéaires</a></li>
<li class="chapter" data-level="2.1.3" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#conditions-de-base-du-modèle-linéaire"><i class="fa fa-check"></i><b>2.1.3</b> 1.3 Conditions de base du modèle linéaire</a></li>
<li class="chapter" data-level="2.1.4" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#statistiques-de-tests-et-p-values"><i class="fa fa-check"></i><b>2.1.4</b> 1.4 Statistiques de tests et p-values</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#régression-linéaire-simple"><i class="fa fa-check"></i><b>2.2</b> 2. Régression linéaire simple</a><ul>
<li class="chapter" data-level="2.2.1" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#flux-de-travail"><i class="fa fa-check"></i><b>2.2.1</b> Flux de travail</a></li>
<li class="chapter" data-level="2.2.2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#effectuer-un-modèle-linéaire"><i class="fa fa-check"></i><b>2.2.2</b> 2.1 Effectuer un modèle linéaire</a></li>
<li class="chapter" data-level="2.2.3" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#validation-des-conditions-de-base"><i class="fa fa-check"></i><b>2.2.3</b> 2.2 Validation des conditions de base</a></li>
<li class="chapter" data-level="2.2.4" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#normalisation-des-données"><i class="fa fa-check"></i><b>2.2.4</b> 2.3 Normalisation des données</a></li>
<li class="chapter" data-level="2.2.5" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#transformation-des-données"><i class="fa fa-check"></i><b>2.2.5</b> 2.4 Transformation des données</a></li>
<li class="chapter" data-level="2.2.6" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#sortie-du-modèle"><i class="fa fa-check"></i><b>2.2.6</b> 2.5 Sortie du modèle</a></li>
<li class="chapter" data-level="2.2.7" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#sous-ensembles-dobservations"><i class="fa fa-check"></i><b>2.2.7</b> 2.7 Sous-ensembles d’observations</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#défi-1"><i class="fa fa-check"></i><b>2.3</b> DÉFI 1</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html"><i class="fa fa-check"></i><b>3</b> Test de t et ANOVA</a><ul>
<li class="chapter" data-level="3.1" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#anova"><i class="fa fa-check"></i><b>3.1</b> ANOVA</a><ul>
<li class="chapter" data-level="3.1.1" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#types-danova"><i class="fa fa-check"></i><b>3.1.1</b> 3.1 Types d’ANOVA</a></li>
<li class="chapter" data-level="3.1.2" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#test-de-t"><i class="fa fa-check"></i><b>3.1.2</b> 3.2 Test de t</a></li>
<li class="chapter" data-level="3.1.3" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#effectuer-une-anova"><i class="fa fa-check"></i><b>3.1.3</b> 3.3 Effectuer une ANOVA</a></li>
<li class="chapter" data-level="3.1.4" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#vérification-des-conditions-de-base"><i class="fa fa-check"></i><b>3.1.4</b> 3.4 Vérification des conditions de base</a></li>
<li class="chapter" data-level="3.1.5" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#sortie-du-modèle-1"><i class="fa fa-check"></i><b>3.1.5</b> 3.5 Sortie du modèle</a></li>
<li class="chapter" data-level="3.1.6" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#test-complémentaire"><i class="fa fa-check"></i><b>3.1.6</b> 3.6 Test complémentaire</a></li>
<li class="chapter" data-level="3.1.7" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#visualisation-des-résultats"><i class="fa fa-check"></i><b>3.1.7</b> 3.7 Visualisation des résultats</a></li>
<li class="chapter" data-level="3.1.8" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#allons-plus-loin-contrastes"><i class="fa fa-check"></i><b>3.1.8</b> Allons plus loin: Contrastes</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#anova-à-deux-critères-de-classification"><i class="fa fa-check"></i><b>3.2</b> 4. ANOVA à deux critères de classification</a><ul>
<li class="chapter" data-level="3.2.1" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#effectuer-une-anova-à-deux-critères-de-classification"><i class="fa fa-check"></i><b>3.2.1</b> 4.1 Effectuer une ANOVA à deux critères de classification</a></li>
<li class="chapter" data-level="3.2.2" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#diagramme-dinteraction"><i class="fa fa-check"></i><b>3.2.2</b> 4.2 Diagramme d’interaction</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#anova-non-équilibrée-section-avancéefacultative"><i class="fa fa-check"></i><b>3.3</b> 5. ANOVA non-équilibrée (section avancée/facultative)</a></li>
<li class="chapter" data-level="3.4" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#ancova"><i class="fa fa-check"></i><b>3.4</b> 6. ANCOVA</a><ul>
<li class="chapter" data-level="3.4.1" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#conditions-de-base-1"><i class="fa fa-check"></i><b>3.4.1</b> 6.1 Conditions de base</a></li>
<li class="chapter" data-level="3.4.2" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#types-dancova"><i class="fa fa-check"></i><b>3.4.2</b> 6.2 Types d’ANCOVA</a></li>
<li class="chapter" data-level="3.4.3" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#effectuer-une-ancova"><i class="fa fa-check"></i><b>3.4.3</b> 6.3 Effectuer une ANCOVA</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="régression-multiple.html"><a href="régression-multiple.html"><i class="fa fa-check"></i><b>4</b> Régression multiple</a><ul>
<li class="chapter" data-level="4.0.1" data-path="régression-multiple.html"><a href="régression-multiple.html#conditions-de-base-2"><i class="fa fa-check"></i><b>4.0.1</b> 7.1 Conditions de base</a></li>
<li class="chapter" data-level="4.0.2" data-path="régression-multiple.html"><a href="régression-multiple.html#jeu-de-données-dickcissel"><i class="fa fa-check"></i><b>4.0.2</b> 7.2 Jeu de données Dickcissel</a></li>
<li class="chapter" data-level="4.0.3" data-path="régression-multiple.html"><a href="régression-multiple.html#allons-plus-loin-régression-polynomiale"><i class="fa fa-check"></i><b>4.0.3</b> Allons plus loin: Régression polynomiale</a></li>
<li class="chapter" data-level="4.0.4" data-path="régression-multiple.html"><a href="régression-multiple.html#régression-pas-à-pas"><i class="fa fa-check"></i><b>4.0.4</b> 7.4 Régression pas à pas</a></li>
<li class="chapter" data-level="4.1" data-path="régression-multiple.html"><a href="régression-multiple.html#allons-plus-loin-partition-de-la-variation"><i class="fa fa-check"></i><b>4.1</b> Allons plus loin: Partition de la variation</a></li>
</ul></li>
<li class="part"><span><b>Considérations finales</b></span></li>
<li class="chapter" data-level="5" data-path="résumé.html"><a href="résumé.html"><i class="fa fa-check"></i><b>5</b> Résumé</a></li>
<li class="chapter" data-level="6" data-path="resources-additionnels.html"><a href="resources-additionnels.html"><i class="fa fa-check"></i><b>6</b> Resources additionnels</a></li>
<li class="chapter" data-level="7" data-path="réferences.html"><a href="réferences.html"><i class="fa fa-check"></i><b>7</b> Réferences</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Atelier 4: Modèles linéaires</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>


<!-- 
<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
--!>
<div id="préparez-vous-pour-cet-atelier" class="section level1">
<h1><span class="header-section-number">Chapitre 2</span> Préparez-vous pour cet atelier</h1>
<p>Tout le matériel de l’atelier se trouve sur <a href="https://github.com/QCBSRworkshops/workshop04">github.com/QCBSRworkshops/workshop04</a>. Cela inclut un <a href="https://qcbsrworkshops.github.io/workshop04/book-fr/workshop04-script-fr.R">script R</a> qui rassemble tous les morceaux de code présentés dans ce livre.</p>
<p>Pour cet atelier, nous travaillerons avec les jeux de données suivants :</p>
<ul>
<li>list here</li>
</ul>
<blockquote>
<p>Pour télécharger ces données, faites un clic droit + enregistrer sur la page qui s’ouvre.</p>
</blockquote>
<p>Vous devriez également vous assurer que vous avez téléchargé, installé et chargé les librairies R suivantes:</p>
<ul>
<li>list here</li>
</ul>

<div id="aperçu" class="section level2">
<h2><span class="header-section-number">2.1</span> 1. Aperçu</h2>
<div id="définir-la-moyenne-et-la-variation" class="section level3">
<h3><span class="header-section-number">2.1.1</span> 1.1 Définir la moyenne et la variation</h3>
<p>En science, on s’intéresse souvent à déterminer les relations entre des
variables. Dans cet atelier, nous apprendrons comment utiliser des
modèles linéaires, un ensemble de modèles qui quantifie les relations
entre des variables.</p>
<p>On commencera par définir deux concepts-clés pour comprendre les modèles
linéaires: la moyenne et la variation. La <strong>moyenne</strong> est une mesure de
la valeur moyenne d’une population. Supposons que nous avons une
variable aléatoire x, comme la grandeur des personnes dans une salle, et
que nous voulons représenter les patrons de cette variable. En premier
lieu, on peut utiliser la moyenne (qui peut être calculée de plusieurs
manières).</p>
<p>Par contre, la moyenne ne peut pas représenter une population au
complet. On peut aussi décrire une population à l’aide de mesures de
variation. La <strong>variation</strong> est la dispersion (ou l’écart) des
observations autour de la moyenne. Par exemple, il y a peu de variation
si tout le monde dans une salle ont presque la même grandeur, et
beaucoup de variation si plusieurs personnes sont de grandeurs très
différentes. L’écart moyen, la variance, l’écart type, et le
coefficient de variation (ou l’écart type relatif) sont tous des
mesures de variation que nous définirons ci-dessous. On peut mesurer
l’écart de chaque élément par rapport à la moyenne:</p>
<p>Avec l’écart de tous les éléments, on peut calculer l’<strong>écart moyen</strong>:</p>
<p>Afin de transformer tous les variables en valeurs positives sans
utiliser de valeurs absolues, on peut mettre chaque valeur au carré. On
obtient alors la <strong>variance</strong>:</p>
<p>Par contre, en mettant toutes les valeurs au carré, on change les unités
de nos variables. Si on reprend notre exemple des grandeurs de personnes
dans la salle, la variance sera en m<sup>2</sup>, une unité qui n’est plus
pertinente pour notre question initiale. Pour transformer ces valeurs en
unités appropriées, on peut calculer l’<strong>écart type</strong>:</p>
<p>Finalement, pour exprimer le <strong>coefficient de variation</strong> (également
nommé l’écart type relatif) en pourcentage, nous avons:</p>
</div>
<div id="les-modèles-linéaires" class="section level3">
<h3><span class="header-section-number">2.1.2</span> 1.2 Les modèles linéaires</h3>
<p>Dans les modèles linéaires, on utilise les concepts de moyenne et de
variation pour décrire la relation entre deux variables. On dit
"modèles linéaires", parce qu’ils décrivent la relation entre
variables avec une droite:</p>
<p>$ {y_i} = {β_0} + {β_1}{x_{i1}} + ... + {β_p}{x_{ip}} + {ε_i}
&lt;/m&gt;</p>
<p>où<br />
<span class="math inline">\({y_i}\)</span>est la variable réponse,<br />
<span class="math inline">\({β_0}\)</span>est l’ordonnée à l’origine de la droite de
régression,<br />
<span class="math inline">\({β_1}\)</span>est le coefficient de variation de la 1<sup>ère</sup> variable
explicative,<br />
<span class="math inline">\({β_p}\)</span>est le coefficient de variation de la p<sup>ème</sup> variable
explicative,<br />
<span class="math inline">\({x_i1}\)</span>est la variable explicative continue pour la première
observation,<br />
<span class="math inline">\({x_ip}\)</span>est la variable explicative continue pour la p<sup>ième</sup>
observation,\\<br />
<span class="math inline">\({ε_i}\)</span>sont les résidus du modèle (i.e. la variance
inexpliquée).<br />
La <strong>variable réponse</strong> (<span class="math inline">\(y\&lt;/m\&gt;) est la variable que nous voulons expliquer, ou la variable dépendante. Il n&#39;y a qu&#39;une variable réponse. Les **variables explicatives** (\)</span>x&lt;/m&gt;) sont des
variables qui peuvent (potentiellement) expliquer la variable réponse.
Celles-ci sont les variables indépendantes. On peut inclure une ou
plusieurs variables explicatives. Par exemple, supposons que nous
voulons expliquer la variation en grandeur des personnes dans cette
salle. La grandeur est la variable réponse. Des variables explicatives
peuvent être l’âge ou le sexe.</p>
<p>Dans les modèles linéaires, les variables réponses doivent être
continues, mais les variables explicatives peuvent être continues ou
catégoriques. Une <strong>variable continue</strong> a une infinité de valeurs
possibles. Une <strong>variable catégorique</strong> a un nombre limité de valeurs
possibles. L’âge, la température, et la latitude sont des variables
continues. Le sexe, le stade de développement, et le pays sont des
variables catégoriques. Pour les variables explicatives continues, le
modèle linéaire évalue s’il y a une corrélation significative entre la
variable réponse et la ou les variables explicatives. Pour les variables
explicatives catégoriques, le modèle linéaire évalue si la valeur
moyenne de la variable réponse diffère significativement entre les
différents niveaux (ou groupes) des variables explicatives. Ceci
deviendra plus clair en explorant les types de modèles linéaires dans
les sections suivantes.</p>
<p>Dans presque tous les cas, les variables explicatives n’expliquent pas
toute la variation dans la variable réponse. Par exemple, le sexe et
l’âge ne ne seront pas assez pour prédire la grandeur de chaque
personne parfaitement. La variation qui reste inexpliquée sont les
<strong>résidus</strong>, ou l’erreur.</p>
<p>Le but d’un modèle linéaire est de trouver la meilleure estimation des
paramètres (les variables β), puis d’évaluer la qualité de
l’ajustement ("<em>goodness of fit</em>") du modèle. Plusieurs méthodes ont
été développées pour calculer l’intercept et les coefficient de modèles
linéaires. Le choix approprié dépend du modèle. Le concept général de
ces méthodes consiste de minimiser les résidus.</p>
<p>Selon le type et le nombre de variables explicatives considérées,
différents outils statistiques peuvent être utilisés pour évaluer ces
relations entre variables. Le tableau ci-dessous liste les 5 types
d’analyses statistiques abordées dans cet atelier:</p>
<table style="width:98%;">
<colgroup>
<col width="24%" />
<col width="16%" />
<col width="16%" />
<col width="28%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Analyse statistique</th>
<th align="left">Type de variable<br />
réponse Y</th>
<th align="left">Type de variable<br />
explicative X</th>
<th align="left">Nombre de<br />
variables explicatives</th>
<th align="left">Nombre de<br />
niveaux k</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Régression linéaire simple</td>
<td align="left">Continue</td>
<td align="left">Continue</td>
<td align="left">1</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Test de t</td>
<td align="left">:::</td>
<td align="left">Catégorique</td>
<td align="left">1</td>
<td align="left">2</td>
</tr>
<tr class="odd">
<td align="left">ANOVA</td>
<td align="left">:::</td>
<td align="left">Catégorique</td>
<td align="left">1 (ANOVA à un facteur), 2<br />
(ANOVA à deux facteurs) ou plus</td>
<td align="left">3 ou plus</td>
</tr>
<tr class="even">
<td align="left">ANCOVA</td>
<td align="left">:::</td>
<td align="left">Continue<br />
ET catégorique</td>
<td align="left">2 ou plus</td>
<td align="left">2 ou plus</td>
</tr>
<tr class="odd">
<td align="left">Régression multiple</td>
<td align="left">:::</td>
<td align="left">Continue</td>
<td align="left">2 ou plus</td>
<td align="left"></td>
</tr>
</tbody>
</table>
</div>
<div id="conditions-de-base-du-modèle-linéaire" class="section level3">
<h3><span class="header-section-number">2.1.3</span> 1.3 Conditions de base du modèle linéaire</h3>
<p>Pour être valide, les modèles linéaires s’appuient sur 4 conditions de
base. Si les 4 conditions ne sont pas respectées, les résultats du
modèle ne peuvent pas être interprétés de façon valable.</p>
<ol style="list-style-type: decimal">
<li>Les résidus sont <strong>indépendants</strong></li>
<li>Les résidus suivent une <strong>distribution normale</strong></li>
<li>Les résidus ont une <strong>moyenne de 0</strong></li>
<li>Les résidus sont <strong>homoscédastiques</strong> (i.e. leur variance est
constante)</li>
</ol>
<p>Notez que ces 4 conditions concernent les résidus, et non les variables
réponses ou explicatives. Les résidus doivent être indépendants,
c’est-à-dire qu’il n’y a pas de structure manquante dans le modèle
(comme une autocorrélation spatiale ou temporelle). Les résidus doivent
aussi suivre une distribution normale avec une moyenne de 0, signifiant
que la majorité des résidus ont une valeur proche de 0 (i.e. l’erreur
est très petite) et que la distribution est symmétrique (i.e. la
variable réponse est sous-estimée autant qu’elle est surestimée). Les
residus doivent être homoscédastiques, c’est-à-dire que l’erreur ne
change pas beaucoup quand les variables explicatives changent de valeur.</p>
<p>Dans les section suivantes, nous ne répétons pas les conditions
ci-dessus pour chaque modèle. <strong>Prenez conscience, par contre, que ces
conditions de base s’appliquent à tous les modèles linéaires, incluant
tous ceux qui seront abordés ci-dessous.</strong></p>
</div>
<div id="statistiques-de-tests-et-p-values" class="section level3">
<h3><span class="header-section-number">2.1.4</span> 1.4 Statistiques de tests et p-values</h3>
<p>Une fois que le modèle a été exécuté dans R, on reçoit une <strong>sortie du
modèle</strong> composé de plusieurs éléments. Comprendre chacun de ces
éléments et identifier les éléments pertinents de la sortie demande un
peu de pratique. La sortie inclut une estimation des paramètres (les
variables β), ainsi que des statistiques de tests. Le statistique de
test dépend du modèle linéaire employé (t est le statistique de test
pour la régression linéaire et le test de t, et F est le statistique de
test pour l’ANOVA).</p>
<p>Dans un modèle linéaire, l’<strong>hypothèse nulle</strong> est typiquement qu’il
n’y a aucune relation entre deux variables continues, out qu’il n’y a
pas de différence entre les niveaux d’une variable catégorique. <strong>Plus
la valeur absolue d’un statistique de test est grande, moins il est
probable que l’hypothèse nulle soit valide</strong>. La probabilité exacte se
trouve dans la sortie du modèle, et s’appelle le <strong>"p-value"</strong>. On
peut penser au p-value comme la probabilité que l’hypothèse nulle est
valide, malgré que c’est une simplification. <em>(Plus précisément, le
p-value est la probabilité que, étant donné que l’hypothèse nulle est
valide, la magnitude du statistique de test serait plus grande ou égale
à le statistique de test réellement observé.)</em> Par convention, si un
p-value est <strong>inférieur à 0.05 (5%)</strong>, l’hypothèse nulle est rejetée.
Cette valeur de seuil s’appelle <strong>α</strong> (alpha). Si on rejette
l’hypothèse nulle, on dit alors que l’hypothèse contraire est
soutenue: il y a une relation significative entre variables ou une
différence significative entre groupes. <strong>Notez qu’on ne "prouve" pas
d’hypothèses</strong>, mais qu’on les soutient ou on les rejette.</p>

</div>
</div>
<div id="régression-linéaire-simple" class="section level2">
<h2><span class="header-section-number">2.2</span> 2. Régression linéaire simple</h2>
<p>La régression linéaire simple est un type de modèle linéaire qui
contient <strong>seulement une variable explicative continue</strong>. La régression
détermine si les deux variables (1 explicative, et 1 réponse) sont
significativement corrélés.</p>
<p>Une régression linéaire simple concerne deux paramètres qui doivent être
estimés: l’<strong>ordonnée à l’origine</strong> (β<sub>0</sub>) et un <strong>coefficient de
corrélation</strong> (β<sub>1</sub>).</p>
<p>La méthode des moindres carrés est la méthode la plus couramment
utilisée, et est employée par défaut dans la fonction <code>lm()</code> dans R. La
méthode des moindres carrés fait passer une droite de manière à
minimiser la somme des distances verticales au carré entre la droite et
les données observées : autrement dit, la méthode vise à minimiser les
résidus.</p>
<p>Cliquez ci-dessous pour plus de détails mathématiques.</p>
<p>À l’aide de la méthode des moindres carrés, le coefficient
de corrélation (β<sub>1</sub>) et l’ordonnée à l’origine (β<sub>0</sub>) peuvent être
calculés de la façon suivante :</p>
<p><span class="math inline">\(β\_{1}={sum{i}{}{(x\_{i}y\_{i})}-overline{x}overline{y}}/sum{i}{}{(x\_{i}-overline{x})}\^2 = {Cov(x,y)}/{Var(x)}\)</span></p>
<p><span class="math inline">\(β\_{0}=overline{y}-β\_{1}overline{x}\)</span></p>
<div id="flux-de-travail" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Flux de travail</h3>
<p>Dans cet atelier, nous explorerons plusieurs types de modèles linéaires.
La création et l’interprétation de chaque modèle diffère dans les
détails, mais les principes généraux et le flux de travail s’appliquent
à tous les types. Pour chaque modèle, on suivra donc les étapes de
travail suivantes:</p>
<ol style="list-style-type: decimal">
<li>Visualiser les données (ceci peut aussi se faire plus tard)</li>
<li>Créer un modèle</li>
<li>Tester les 4 conditions de base du modèle</li>
<li>Ajuster le modèle si les conditions de base ne sont pas respectées</li>
<li>Interpréter les résultats du modèle</li>
</ol>
</div>
<div id="effectuer-un-modèle-linéaire" class="section level3">
<h3><span class="header-section-number">2.2.2</span> 2.1 Effectuer un modèle linéaire</h3>
<p>En utilisant le jeu de données <code>bird</code>, nous allons exécuter une première
régression linéaire sur l’abondance maximale en fonction de la masse.</p>
<p>Dans R, une régression linéaire est implémentée à l’aide de la fonction
<code>lm()</code> de la librairie <code>stats</code> :</p>
<p><code>lm (y ~ x)</code></p>
<table>
<tbody>
<tr class="odd">
<td align="left"><span class="ul"><strong>Note</strong></span> : Avant d’utiliser une nouvelle fonction dans R, vous devriez vous référer à sa page d’aide (<code>?nomdelafonction</code>) afin de comprendre comment utiliser la fonction ainsi que les paramètres par défaut.</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="préparez-vous-pour-cet-atelier.html#cb1-1"></a><span class="co"># Chargez les paquets et le jeu de données bird</span></span>
<span id="cb1-2"><a href="préparez-vous-pour-cet-atelier.html#cb1-2"></a><span class="kw">library</span>(e1071)</span>
<span id="cb1-3"><a href="préparez-vous-pour-cet-atelier.html#cb1-3"></a><span class="kw">library</span>(MASS)</span>
<span id="cb1-4"><a href="préparez-vous-pour-cet-atelier.html#cb1-4"></a><span class="kw">setwd</span>(<span class="st">&quot;~/Desktop/...&quot;</span>)  <span class="co"># N&#39;oubliez pas de spécifier votre répertoire de travail (note: le vôtre sera différent de celui-ci)</span></span>
<span id="cb1-5"><a href="préparez-vous-pour-cet-atelier.html#cb1-5"></a>bird &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;birdsdiet.csv&quot;</span>)</span>
<span id="cb1-6"><a href="préparez-vous-pour-cet-atelier.html#cb1-6"></a></span>
<span id="cb1-7"><a href="préparez-vous-pour-cet-atelier.html#cb1-7"></a><span class="co"># Visualisez le tableau de données :</span></span>
<span id="cb1-8"><a href="préparez-vous-pour-cet-atelier.html#cb1-8"></a><span class="kw">names</span>(bird)</span>
<span id="cb1-9"><a href="préparez-vous-pour-cet-atelier.html#cb1-9"></a><span class="kw">str</span>(bird)</span>
<span id="cb1-10"><a href="préparez-vous-pour-cet-atelier.html#cb1-10"></a><span class="kw">head</span>(bird)</span>
<span id="cb1-11"><a href="préparez-vous-pour-cet-atelier.html#cb1-11"></a><span class="kw">summary</span>(bird)</span>
<span id="cb1-12"><a href="préparez-vous-pour-cet-atelier.html#cb1-12"></a><span class="kw">plot</span>(bird)</span></code></pre></div>
<p>Le jeu de données bird contient sept variables:</p>
<table style="width:99%;">
<colgroup>
<col width="15%" />
<col width="47%" />
<col width="35%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Nom de la variable</th>
<th align="left">Description</th>
<th align="left">Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Family</td>
<td align="left">Nom de la famille</td>
<td align="left">Chaînes de caractères</td>
</tr>
<tr class="even">
<td align="left">MaxAbund</td>
<td align="left">Abondance la plus élevée observée<br />
en Amérique du Nord</td>
<td align="left">Continue/numérique</td>
</tr>
<tr class="odd">
<td align="left">AvgAbund</td>
<td align="left">Abondance moyenne sur tous les sites<br />
en Amérique du Nord</td>
<td align="left">Continue/numérique</td>
</tr>
<tr class="even">
<td align="left">Mass</td>
<td align="left">Taille corporelle en grammes</td>
<td align="left">Continue/numérique</td>
</tr>
<tr class="odd">
<td align="left">Diet</td>
<td align="left">Type de nourriture consommée</td>
<td align="left">Catégorique – 5 niveaux (Plant; PlantInsect;<br />
Insect; InsectVert; Vertebrate)</td>
</tr>
<tr class="even">
<td align="left">Passerine</td>
<td align="left">Est-ce un passereau?</td>
<td align="left">Binaire (0/1)</td>
</tr>
<tr class="odd">
<td align="left">Aquatic</td>
<td align="left">Est-ce un oiseau qui vit principalement dans ou près de l’eau? B</td>
<td align="left">inaire (0/1)</td>
</tr>
</tbody>
</table>
<p>Notez que Family, Diet, Passerine, et Aquatic sont tous des variables
catégoriques, malgré le fait qu’ils soient encodés de façons
différentes (chaîne de caractères, catégorique, binaire).</p>
<p>Nous sommes maintenant prêts à exécuter le modèle linéaire :</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="préparez-vous-pour-cet-atelier.html#cb2-1"></a>lm1 &lt;-<span class="st"> </span><span class="kw">lm</span>(bird<span class="op">$</span>MaxAbund <span class="op">~</span><span class="st"> </span>bird<span class="op">$</span>Mass)  <span class="co"># où Y ~ X signifie Y &#39;en fonction de&#39; X&gt;</span></span></code></pre></div>
</div>
<div id="validation-des-conditions-de-base" class="section level3">
<h3><span class="header-section-number">2.2.3</span> 2.2 Validation des conditions de base</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="préparez-vous-pour-cet-atelier.html#cb3-1"></a>opar &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))  <span class="co"># Permet de créer les graphiques dans un panneau 2 x 2</span></span>
<span id="cb3-2"><a href="préparez-vous-pour-cet-atelier.html#cb3-2"></a><span class="kw">plot</span>(lm1)</span>
<span id="cb3-3"><a href="préparez-vous-pour-cet-atelier.html#cb3-3"></a><span class="kw">par</span>(opar)  <span class="co"># Remet la fenêtre graphique à un seul panneau</span></span></code></pre></div>
<div id="vérifier-lindépendance" class="section level4">
<h4><span class="header-section-number">2.2.3.1</span> Vérifier l’indépendance</h4>
<p>Les modèles linéaires s’appliquent seulement aux données indépendantes.
En d’autres mots, le <em>y<sub>i</sub></em> correspondant à une certaine valeur <em>x<sub>i</sub></em>
ne doit pas être influencée par d’autres valeurs <em>x<sub>i</sub></em>. Si vos données
contiennent une certaine forme de structure de dépendance, comme une
corrélation spatiale ou temporelle, l’hypothèse de l’indépendance est
invalide.</p>
<p>Malheureusement, il n’existe pas un graphique de diagnostique simple
pour vérifier l’indépendance. Au contraire, il faut considérer son jeu
de données avec soin et prudence. Est-ce qu’il y a un structure
présente dans vos données qui crée une dépendance entre observations? Si
les données s’agissent d’une série temporelle (donc, les observations
proviennent des mêmes sites à plusieurs reprises), ou que plusieurs
observations proviennent d’un même organisme, l’hypothèse
d’indépendance est invalide. Il faut donc choisir un autre type de
modèle.</p>
<p><br />
</p>
</div>
<div id="vérifier-lhomoscédasticité-et-la-moyenne-résiduelle-de-0" class="section level4">
<h4><span class="header-section-number">2.2.3.2</span> Vérifier l’homoscédasticité et la moyenne résiduelle de 0</h4>
<p><strong><em>Graphique des résidus vs. valeurs prédites</em></strong> - Le premier graphique
de diagnostic est créé avec la fonction <code>plot(lm1)</code>. Ce graphique
illustre la dispersion des résidus en fonction des valeurs prédites par
le modèle de régression linéaire. Chaque point représente la distance
entre la variable réponse et la réponse prédite par le modèle.</p>
<ul>
<li>Si les résidus sont dispersés de façon <strong>aléatoire autour de la
ligne de 0</strong>, la relation est linéaire et la moyenne des résidus
est 0.</li>
<li>Si les résidus forment une <strong>bande horizontale</strong> approximative
autour de la ligne de 0, la variance des résidus est homogène (donc,
ils sont homoscédastiques).</li>
<li>Si les résidus sont organisés <strong>en forme d’entonnoir</strong>, les résidus
ne sont pas homoscédastiques.</li>
</ul>
<p><img src="images/workshop_3_lm1_residuals_vs_fitted.png" width="300" /></p>
<p><br />
<strong><em>Graphique "Scale-location"</em></strong> - Le troisième graphique de
diagnostique permet de vérifier si la dispersion des résidus augmente
pour une valeur prédite donnée (i.e. si la dispersion des résidus est
causée par la variable explicative). Si la dispersion augmente, la
condition de base d’homoscédasticité n’est pas respectée.</p>
<p><img src="images/workshop_3_lm1_scale-location.png" width="300" /></p>
<p><br />
</p>
</div>
<div id="vérifier-la-normalité-des-résidus" class="section level4">
<h4><span class="header-section-number">2.2.3.3</span> Vérifier la normalité des résidus</h4>
<p><strong><em>Diagramme quantile-quantile (Q-Q)</em></strong> - La normalité des résidus peut
être évaluée à l’aide d’un diagramme quantile-quantile. Ce graphique
compare la distribution de probabilité des résidus du modèle à une
distribution de probabilité de données normales. Si les résidus
standardisés se trouvent près d’une ligne 1:1, les résidus peuvent être
considérés comme normalement distribués.</p>
<p><img src="images/workshop_3_lm1_qq.png" width="300" /></p>
<p>Dans ce cas-ci, les points ne sont pas bien alignés sur la droite, ce
qui suggère que les résidus ne sont pas distribués normalement.</p>
<p><br />
</p>
</div>
<div id="influence-des-observations-aberrantes" class="section level4">
<h4><span class="header-section-number">2.2.3.4</span> Influence des observations aberrantes</h4>
<p><strong><em>Diagramme de résidus vs. influence</em></strong> - En plus de valider les
hypothèses de bases ci-dessus, on s’intéresse aussi à déterminer si
certaines observations ont une forte influence. Bien qu’on ne teste pas
un test de condition de base, ceci peut influencer notre interprétation
des données. Si une ou certaines observations sont aberrantes (dont, si
elles ont des valeurs très différentes des autres), le modèle peut être
mal ajusté en raison de leur influence exagérée sur la calculation du
modèle. Si (et seulement si!) ces observations correspondent à des
erreurs de mesure ou à des exceptions, elles peuvent être retirées du
jeu de données.<br />
<img src="images/workshop_3_lm1_leverage.png" width="300" /></p>
</div>
</div>
<div id="normalisation-des-données" class="section level3">
<h3><span class="header-section-number">2.2.4</span> 2.3 Normalisation des données</h3>
<p>Dans l’exemple précédent, les résidus du modèle ne suivaient pas une
distribution normale, alors la condition de base de normalité est
invalide. On peut quand même utiliser un modèle linéaire si on réussit à
normaliser les données, afin de respecter la condition de normalité.
L’étape suivante est donc de normaliser les données à l’aide de
transformations mathématiques. Souvent, si on normalise les variables
explicatives et/ou réponses, les résidus suivent une distribution
normale. En plus des diagramme QQ, on peut évaluer la normalité d’une
variable en traçant un histogramme avec la fonction <code>hist()</code>, et en
vérifiant visuellement que la variable suit une distribution normale.
Par exemple :</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="préparez-vous-pour-cet-atelier.html#cb4-1"></a><span class="co"># Graphique Y ~ X et la ligne de régression</span></span>
<span id="cb4-2"><a href="préparez-vous-pour-cet-atelier.html#cb4-2"></a><span class="kw">plot</span>(bird<span class="op">$</span>MaxAbund <span class="op">~</span><span class="st"> </span>bird<span class="op">$</span>Mass, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="st">&quot;coral&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Maximum Abundance&quot;</span>,</span>
<span id="cb4-3"><a href="préparez-vous-pour-cet-atelier.html#cb4-3"></a>    <span class="dt">xlab =</span> <span class="st">&quot;Mass&quot;</span>)</span>
<span id="cb4-4"><a href="préparez-vous-pour-cet-atelier.html#cb4-4"></a><span class="kw">abline</span>(lm1, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb4-5"><a href="préparez-vous-pour-cet-atelier.html#cb4-5"></a><span class="st">`</span><span class="dt">?</span><span class="st">`</span>(plot  <span class="co"># Pour obtenir plus de détails sur les arguments de la fonction plot().</span></span>
<span id="cb4-6"><a href="préparez-vous-pour-cet-atelier.html#cb4-6"></a>)</span>
<span id="cb4-7"><a href="préparez-vous-pour-cet-atelier.html#cb4-7"></a><span class="co"># Allez voir colours() pour une liste de couleurs.</span></span>
<span id="cb4-8"><a href="préparez-vous-pour-cet-atelier.html#cb4-8"></a></span>
<span id="cb4-9"><a href="préparez-vous-pour-cet-atelier.html#cb4-9"></a><span class="co"># Les données sont-elles distribuées normalement ?</span></span>
<span id="cb4-10"><a href="préparez-vous-pour-cet-atelier.html#cb4-10"></a><span class="kw">hist</span>(bird<span class="op">$</span>MaxAbund, <span class="dt">col =</span> <span class="st">&quot;coral&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Untransformed data&quot;</span>,</span>
<span id="cb4-11"><a href="préparez-vous-pour-cet-atelier.html#cb4-11"></a>    <span class="dt">xlab =</span> <span class="st">&quot;Maximum Abundance&quot;</span>)</span>
<span id="cb4-12"><a href="préparez-vous-pour-cet-atelier.html#cb4-12"></a><span class="kw">hist</span>(bird<span class="op">$</span>Mass, <span class="dt">col =</span> <span class="st">&quot;coral&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Untransformed data&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Mass&quot;</span>)</span></code></pre></div>
<p><img src="images/lm1_yvsx.png" width="300" /> <img src="images/maxabund_hist.png" width="300" />
<img src="images/mass_hist.png" width="300" /></p>
<p>Une troisième façon d’évaluer la normalité des données est d’utiliser
le test de Shapiro-Wilk (fonction <code>shapiro.test()</code>), qui compare la
distribution des données observées à une distribution normale.</p>
<p>Les hypothèses nulle et contraire sont:</p>
<p>H<sub>0</sub>: les données observées sont distribuées normalement<br />
H<sub>1</sub>: les données observées ne sont pas distribuées normalement</p>
<p>Les données observées peuvent être considérées comme normalement
distribuées lorsque la valeur de p calculée par le test de Shapiro-Wilk
est supérieure au seuil α (généralement 0.05).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="préparez-vous-pour-cet-atelier.html#cb5-1"></a><span class="co"># Teste l&#39;hypothèse nulle que l&#39;échantillon provient d&#39;une</span></span>
<span id="cb5-2"><a href="préparez-vous-pour-cet-atelier.html#cb5-2"></a><span class="co"># population distribuée normalement</span></span>
<span id="cb5-3"><a href="préparez-vous-pour-cet-atelier.html#cb5-3"></a><span class="kw">shapiro.test</span>(bird<span class="op">$</span>MaxAbund)</span>
<span id="cb5-4"><a href="préparez-vous-pour-cet-atelier.html#cb5-4"></a><span class="kw">shapiro.test</span>(bird<span class="op">$</span>Mass)</span>
<span id="cb5-5"><a href="préparez-vous-pour-cet-atelier.html#cb5-5"></a><span class="co"># Si p &lt; 0.05, la distribution n&#39;est pas normale Si p &gt;</span></span>
<span id="cb5-6"><a href="préparez-vous-pour-cet-atelier.html#cb5-6"></a><span class="co"># 0.05, la distribution est normale</span></span></code></pre></div>
<p>On peut également évaluer l’asymétrie d’une distribution avec la
fonction <code>skewness()</code> :</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="préparez-vous-pour-cet-atelier.html#cb6-1"></a><span class="kw">skewness</span>(bird<span class="op">$</span>MaxAbund)</span>
<span id="cb6-2"><a href="préparez-vous-pour-cet-atelier.html#cb6-2"></a><span class="kw">skewness</span>(bird<span class="op">$</span>Mass)</span>
<span id="cb6-3"><a href="préparez-vous-pour-cet-atelier.html#cb6-3"></a><span class="co"># Une valeur positive indique une asymétrie vers la gauche</span></span>
<span id="cb6-4"><a href="préparez-vous-pour-cet-atelier.html#cb6-4"></a><span class="co"># (i.e. left-skewed distribution) tandis qu&#39;une valeur</span></span>
<span id="cb6-5"><a href="préparez-vous-pour-cet-atelier.html#cb6-5"></a><span class="co"># négative indique une asymétrie vers la droite (i.e. right</span></span>
<span id="cb6-6"><a href="préparez-vous-pour-cet-atelier.html#cb6-6"></a><span class="co"># skewed distribution).</span></span></code></pre></div>
<p>Les histogrammes, le test de Shapiro-Wilk, et le coefficient
d’asymétrie ("skewness") indiquent tous que les variables doivent
être transformées afin de respecter la condition de normalité (e.g. une
transformation log<sub>10</sub>).</p>
</div>
<div id="transformation-des-données" class="section level3">
<h3><span class="header-section-number">2.2.5</span> 2.4 Transformation des données</h3>
<p>Lorsque la condition de normalité n’est pas respectée, les variables
peuvent être transformées afin d’améliorer la normalité de leur
distribution en respectant ces règles :</p>
<table style="width:98%;">
<colgroup>
<col width="30%" />
<col width="25%" />
<col width="42%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Type de distribution</th>
<th align="left">Transformation</th>
<th align="left">Fonction R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Asymétrie positive modérée</td>
<td align="left"><span class="math inline">\(sqrt{x}\)</span> sqrt(x)</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">Asymétrie positive importante</td>
<td align="left"><span class="math inline">\(log_10{(x)}\)</span> log10(x)</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Asymétrie positive importante</td>
<td align="left"><span class="math inline">\(log_10{(x+C)}\)</span> log10(x +</td>
<td align="left">C) où C est une constante<br />
ajoutée à chaque valeur de x afin que<br />
la plus petite valeur soit 1</td>
</tr>
<tr class="even">
<td align="left">Asymétrie négative modérée</td>
<td align="left"><span class="math inline">\(sqrt{(K-x)}\)</span> sqrt(K - x</td>
<td align="left">) où K est une constante<br />
soustraite de chaque valeur de x afin que<br />
la plus petite valeur soit 1</td>
</tr>
<tr class="odd">
<td align="left">Asymétrie négative importante</td>
<td align="left"><span class="math inline">\(log_10{(K-x)}\)</span> log10(K -</td>
<td align="left">x)</td>
</tr>
</tbody>
</table>
<p>Dans notre cas, une transformation logarithmique (log<sub>10</sub>) devrait être
utilisée et enregistrée dans le tableau de données <code>bird</code>. Le modèle
peut ainsi être exécuté, vérifié, et interprété.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="préparez-vous-pour-cet-atelier.html#cb7-1"></a><span class="co"># Ajoutez les variables transformées au tableau</span></span>
<span id="cb7-2"><a href="préparez-vous-pour-cet-atelier.html#cb7-2"></a>bird<span class="op">$</span>logMaxAbund &lt;-<span class="st"> </span><span class="kw">log10</span>(bird<span class="op">$</span>MaxAbund)</span>
<span id="cb7-3"><a href="préparez-vous-pour-cet-atelier.html#cb7-3"></a>bird<span class="op">$</span>logMass &lt;-<span class="st"> </span><span class="kw">log10</span>(bird<span class="op">$</span>Mass)</span>
<span id="cb7-4"><a href="préparez-vous-pour-cet-atelier.html#cb7-4"></a><span class="kw">names</span>(bird)  <span class="co"># pour visualiser le tableau avec les nouvelles variables</span></span>
<span id="cb7-5"><a href="préparez-vous-pour-cet-atelier.html#cb7-5"></a></span>
<span id="cb7-6"><a href="préparez-vous-pour-cet-atelier.html#cb7-6"></a><span class="kw">hist</span>(bird<span class="op">$</span>logMaxAbund, <span class="dt">col =</span> <span class="st">&quot;yellowgreen&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Log transformed&quot;</span>,</span>
<span id="cb7-7"><a href="préparez-vous-pour-cet-atelier.html#cb7-7"></a>    <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span><span class="st"> &quot;(Maximum Abundance)&quot;</span>))</span>
<span id="cb7-8"><a href="préparez-vous-pour-cet-atelier.html#cb7-8"></a><span class="kw">hist</span>(bird<span class="op">$</span>logMass, <span class="dt">col =</span> <span class="st">&quot;yellowgreen&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Log transformed&quot;</span>,</span>
<span id="cb7-9"><a href="préparez-vous-pour-cet-atelier.html#cb7-9"></a>    <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span><span class="st"> &quot;(Mass)&quot;</span>))</span>
<span id="cb7-10"><a href="préparez-vous-pour-cet-atelier.html#cb7-10"></a><span class="kw">shapiro.test</span>(bird<span class="op">$</span>logMaxAbund)</span>
<span id="cb7-11"><a href="préparez-vous-pour-cet-atelier.html#cb7-11"></a><span class="kw">skewness</span>(bird<span class="op">$</span>logMaxAbund)</span>
<span id="cb7-12"><a href="préparez-vous-pour-cet-atelier.html#cb7-12"></a><span class="kw">shapiro.test</span>(bird<span class="op">$</span>logMass)</span>
<span id="cb7-13"><a href="préparez-vous-pour-cet-atelier.html#cb7-13"></a><span class="kw">skewness</span>(bird<span class="op">$</span>logMass)</span>
<span id="cb7-14"><a href="préparez-vous-pour-cet-atelier.html#cb7-14"></a></span>
<span id="cb7-15"><a href="préparez-vous-pour-cet-atelier.html#cb7-15"></a><span class="co"># Refaire l&#39;analyse avec les transformations appropriées</span></span>
<span id="cb7-16"><a href="préparez-vous-pour-cet-atelier.html#cb7-16"></a>lm2 &lt;-<span class="st"> </span><span class="kw">lm</span>(bird<span class="op">$</span>logMaxAbund <span class="op">~</span><span class="st"> </span>bird<span class="op">$</span>logMass)</span>
<span id="cb7-17"><a href="préparez-vous-pour-cet-atelier.html#cb7-17"></a></span>
<span id="cb7-18"><a href="préparez-vous-pour-cet-atelier.html#cb7-18"></a><span class="co"># Reste-il des problèmes avec ce modèle</span></span>
<span id="cb7-19"><a href="préparez-vous-pour-cet-atelier.html#cb7-19"></a><span class="co"># (hétéroscédasticité, non-indépendance, forte influence)?</span></span>
<span id="cb7-20"><a href="préparez-vous-pour-cet-atelier.html#cb7-20"></a>opar &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb7-21"><a href="préparez-vous-pour-cet-atelier.html#cb7-21"></a><span class="kw">plot</span>(lm2, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="st">&quot;gray&quot;</span>)</span>
<span id="cb7-22"><a href="préparez-vous-pour-cet-atelier.html#cb7-22"></a><span class="kw">par</span>(opar)</span></code></pre></div>
<p><img src="images/hist_logmaxabund.png" width="300" />
<img src="images/hist_logmass.png" width="300" /> <img src="images/plot_lm2_.png" width="550" /></p>
</div>
<div id="sortie-du-modèle" class="section level3">
<h3><span class="header-section-number">2.2.6</span> 2.5 Sortie du modèle</h3>
<p>Une fois que les hypothèses (ou conditions) de base ont été validées,
les résultats du modèle peuvent être interprétés. On obtient nos
résultats avec la fonction <code>summary()</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="préparez-vous-pour-cet-atelier.html#cb8-1"></a><span class="co"># Examinons les coefficients du modèle ainsi que les</span></span>
<span id="cb8-2"><a href="préparez-vous-pour-cet-atelier.html#cb8-2"></a><span class="co"># valeurs de p</span></span>
<span id="cb8-3"><a href="préparez-vous-pour-cet-atelier.html#cb8-3"></a><span class="kw">summary</span>(lm2)</span>
<span id="cb8-4"><a href="préparez-vous-pour-cet-atelier.html#cb8-4"></a></span>
<span id="cb8-5"><a href="préparez-vous-pour-cet-atelier.html#cb8-5"></a><span class="co"># Vous pouvez faire apparaître seulement les coefficients</span></span>
<span id="cb8-6"><a href="préparez-vous-pour-cet-atelier.html#cb8-6"></a>lm2<span class="op">$</span>coef</span>
<span id="cb8-7"><a href="préparez-vous-pour-cet-atelier.html#cb8-7"></a></span>
<span id="cb8-8"><a href="préparez-vous-pour-cet-atelier.html#cb8-8"></a><span class="co"># Quoi d&#39;autre ?</span></span>
<span id="cb8-9"><a href="préparez-vous-pour-cet-atelier.html#cb8-9"></a><span class="kw">str</span>(<span class="kw">summary</span>(lm2))</span>
<span id="cb8-10"><a href="préparez-vous-pour-cet-atelier.html#cb8-10"></a><span class="kw">summary</span>(lm2)<span class="op">$</span>coefficients  <span class="co"># où Std. Error est l&#39;erreur type de chaque coefficient</span></span>
<span id="cb8-11"><a href="préparez-vous-pour-cet-atelier.html#cb8-11"></a><span class="kw">summary</span>(lm2)<span class="op">$</span>r.squared  <span class="co"># Coefficient de détermination</span></span>
<span id="cb8-12"><a href="préparez-vous-pour-cet-atelier.html#cb8-12"></a><span class="kw">summary</span>(lm2)<span class="op">$</span>adj.r.squared  <span class="co"># Coefficient de détermination ajusté</span></span>
<span id="cb8-13"><a href="préparez-vous-pour-cet-atelier.html#cb8-13"></a><span class="kw">summary</span>(lm2)<span class="op">$</span>sigma  <span class="co"># Erreur type résiduelle (racine du carré moyen de l&#39;erreur)</span></span>
<span id="cb8-14"><a href="préparez-vous-pour-cet-atelier.html#cb8-14"></a><span class="co"># etc.</span></span>
<span id="cb8-15"><a href="préparez-vous-pour-cet-atelier.html#cb8-15"></a></span>
<span id="cb8-16"><a href="préparez-vous-pour-cet-atelier.html#cb8-16"></a><span class="co"># Vous pouvez également vérifier l&#39;équation du coefficient</span></span>
<span id="cb8-17"><a href="préparez-vous-pour-cet-atelier.html#cb8-17"></a><span class="co"># de détermination (R&lt;sup&gt;2&lt;/sup&gt;)par vous-mêmes :</span></span>
<span id="cb8-18"><a href="préparez-vous-pour-cet-atelier.html#cb8-18"></a>SSE &lt;-<span class="st"> </span><span class="kw">sum</span>(<span class="kw">resid</span>(lm2)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb8-19"><a href="préparez-vous-pour-cet-atelier.html#cb8-19"></a>SST &lt;-<span class="st"> </span><span class="kw">sum</span>((bird<span class="op">$</span>logMaxAbund <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(bird<span class="op">$</span>logMaxAbund))<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb8-20"><a href="préparez-vous-pour-cet-atelier.html#cb8-20"></a>R2 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>((SSE)<span class="op">/</span>SST)</span>
<span id="cb8-21"><a href="préparez-vous-pour-cet-atelier.html#cb8-21"></a>R2</span></code></pre></div>
<p>La sortie de cette fonction présente tous les résultats du modèle :</p>
<pre><code>lm(formula = logMaxAbund ~ logMass, data = bird)
Residuals:
          Min         1Q          Median          3Q          Max
               -1.93562   -0.39982    0.05487     0.40625     1.61469
              Estimate    Std. Error  t value     Pr(&gt;|t|)
(Intercept)     1.6724        0.2472      6.767       1.17e-08 ***
logMass          -0.2361          0.1170      -2.019      0.0487 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
Residual standard error: 0.6959 on 52 degrees of freedom
Multiple R-squared:  0.07267,   Adjusted R-squared:  0.05484
F-statistic: 4.075 on 1 and 52 DF,  p-value: 0.04869</code></pre>
<p>Les <strong>coefficients de régression</strong> du modèle et leur <strong>erreur type</strong> se
trouvent dans les deuxième et troisième colonnes du tableau de la
régression, respectivement. Donc,<br />
β<sub>0</sub> = 1.6724 ± 0.2472 est l’ordonnée à l’origine (± e.t.) du modèle
de régression,<br />
β<sub>1</sub> = -0.2361 ± 0.1170 est la pente (± e.t.) du modèle de régression.</p>
<p>et finalement : $ $<em>logMaxAbund</em> = 1.6724 (± 0.2472) - 0.2361
(± 0.1170) x <em>logMass</em> représente le modèle paramétré.</p>
<p>Les valeurs de <strong>t</strong> et leurs <strong>p-values</strong> (dans les 4<sup>ème</sup> et 5<sup>ème</sup>
colonnes du tableau, respectivement) testent si les coefficients de
régression diffèrent significativement de zéro. Dans notre cas, on voit
que la variable <em>logMass</em> a une influence significative sur la variable
<em>logMaxAbund</em> parce que le p-value associée à au coefficient de
variation (i.e. la pente) du modèle de régression est inférieure à 0.05.
De plus, la relation entre ces deux variables est négative, car le
coefficient de variation du modèle a une valeur négative.<br />
<strong>Rappel:</strong> Une corrélation entre deux variables n’implique pas
nécessairement une relation de causalité. Inversement, l’absence de
corrélation entre deux variables n’implique pas nécessairement une
absence de relation entre ces deux variables; c’est le cas, par
exemple, lorsque la relation n’est pas linéaire.</p>
<p>L’ajustement d’un modèle de régression linéaire est donné par le
<strong>R<sup>2</sup> ajusté</strong> (ici 0.05484). Cette valeur mesure la proportion de
variation qui est expliquée par le modèle.</p>
<p>Pour plus de détails à propos de son calcul, cliquez ci-dessous:
$ overline{R}^2=1-(1-R^2){n-1}/{n-p-1} &lt;/m&gt;</p>
<p>où<br />
p est le nombre total de paramètres de régression et n est la taille
d’échantillon,<br />
$ R^2={SS_reg}/{SS_tot} &lt;/m&gt;<br />
$ {SS_tot}=sum{i}{}{({y_i}-overline{y})}^2 <span class="math inline">\(est la dispersion totale,\
\)</span> {SS_reg}=sum{i}{}{(hat{y_i}-overline{y})}^2 $est la
dispersion de la régression - aussi appelée la variance expliquée par le
modèle.<br />
Le R<sup>2</sup> ajusté varie entre 0 et 1. Plus ce coefficient est élevé (donc,
plus qu’il s’approche de 1), plus le modèle est bien ajusté aux
données. Dans ce cas-ci, la relation entre les variables <em>logMaxAbund</em>
et <em>logMass</em> est très faible.<br />
La dernière ligne de la sortie du modèle représente la <strong>statistique F</strong>
du modèle et le <strong>p-value</strong> qui y est associée. Si la valeur de p est
inférieure à 0.05, le modèle de régression décrit mieux la relation
entre les variables qu’un modèle nul.<br />
</p>
<p>2.6 Visualisation graphique</p>
<p>Les résultats d’une régression linéaire sont généralement illustrés par
un graphique de la variable réponse en fonction des variables
explicatives. Une droite de régression y est tracée (et, si nécessaire,
les intervalles de confiance) avec le code R suivant :</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="préparez-vous-pour-cet-atelier.html#cb10-1"></a><span class="kw">plot</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass, <span class="dt">data =</span> bird, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="st">&quot;yellowgreen&quot;</span>,</span>
<span id="cb10-2"><a href="préparez-vous-pour-cet-atelier.html#cb10-2"></a>    <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span><span class="st"> &quot;(Maximum Abundance)&quot;</span>), <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span></span>
<span id="cb10-3"><a href="préparez-vous-pour-cet-atelier.html#cb10-3"></a><span class="st">        &quot;(Mass)&quot;</span>))</span>
<span id="cb10-4"><a href="préparez-vous-pour-cet-atelier.html#cb10-4"></a><span class="kw">abline</span>(lm2, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb10-5"><a href="préparez-vous-pour-cet-atelier.html#cb10-5"></a></span>
<span id="cb10-6"><a href="préparez-vous-pour-cet-atelier.html#cb10-6"></a><span class="co"># On peut faire ressortir les points avec une forte</span></span>
<span id="cb10-7"><a href="préparez-vous-pour-cet-atelier.html#cb10-7"></a><span class="co"># influence</span></span>
<span id="cb10-8"><a href="préparez-vous-pour-cet-atelier.html#cb10-8"></a><span class="kw">points</span>(bird<span class="op">$</span>logMass[<span class="dv">32</span>], bird<span class="op">$</span>logMaxAbund[<span class="dv">32</span>], <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="st">&quot;violet&quot;</span>)</span>
<span id="cb10-9"><a href="préparez-vous-pour-cet-atelier.html#cb10-9"></a><span class="kw">points</span>(bird<span class="op">$</span>logMass[<span class="dv">21</span>], bird<span class="op">$</span>logMaxAbund[<span class="dv">21</span>], <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="st">&quot;violet&quot;</span>)</span>
<span id="cb10-10"><a href="préparez-vous-pour-cet-atelier.html#cb10-10"></a><span class="kw">points</span>(bird<span class="op">$</span>logMass[<span class="dv">50</span>], bird<span class="op">$</span>logMaxAbund[<span class="dv">50</span>], <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="st">&quot;violet&quot;</span>)</span>
<span id="cb10-11"><a href="préparez-vous-pour-cet-atelier.html#cb10-11"></a></span>
<span id="cb10-12"><a href="préparez-vous-pour-cet-atelier.html#cb10-12"></a><span class="co"># On peut également tracer les intervalles de confiance</span></span>
<span id="cb10-13"><a href="préparez-vous-pour-cet-atelier.html#cb10-13"></a>confit &lt;-<span class="st"> </span><span class="kw">predict</span>(lm2, <span class="dt">interval =</span> <span class="st">&quot;confidence&quot;</span>)</span>
<span id="cb10-14"><a href="préparez-vous-pour-cet-atelier.html#cb10-14"></a><span class="kw">points</span>(bird<span class="op">$</span>logMass, confit[, <span class="dv">2</span>])</span>
<span id="cb10-15"><a href="préparez-vous-pour-cet-atelier.html#cb10-15"></a><span class="kw">points</span>(bird<span class="op">$</span>logMass, confit[, <span class="dv">3</span>])</span></code></pre></div>
<p><img src="images/yvxx_lm2.png" width="400" /></p>
</div>
<div id="sous-ensembles-dobservations" class="section level3">
<h3><span class="header-section-number">2.2.7</span> 2.7 Sous-ensembles d’observations</h3>
<p>Il est aussi possible d’analyser seulement une partie des observations.
Par exemple, on peut refaire l’analyse de régression sur seulement les
oiseaux terrestres.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="préparez-vous-pour-cet-atelier.html#cb11-1"></a><span class="co"># Souvenez-vous qu&#39;on peut exclure des valeurs avec le</span></span>
<span id="cb11-2"><a href="préparez-vous-pour-cet-atelier.html#cb11-2"></a><span class="co"># symbole &#39;!&#39;  On peut analyser un sous-ensemble des</span></span>
<span id="cb11-3"><a href="préparez-vous-pour-cet-atelier.html#cb11-3"></a><span class="co"># données de &#39;bird&#39; en utilisant l&#39;argument &#39;subset&#39; de la</span></span>
<span id="cb11-4"><a href="préparez-vous-pour-cet-atelier.html#cb11-4"></a><span class="co"># fonction lm().</span></span>
<span id="cb11-5"><a href="préparez-vous-pour-cet-atelier.html#cb11-5"></a>lm3 &lt;-<span class="st"> </span><span class="kw">lm</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass, <span class="dt">data =</span> bird, <span class="dt">subset =</span> <span class="op">!</span>bird<span class="op">$</span>Aquatic)  <span class="co"># enlever les oiseaux aquatiques du modèle</span></span>
<span id="cb11-6"><a href="préparez-vous-pour-cet-atelier.html#cb11-6"></a></span>
<span id="cb11-7"><a href="préparez-vous-pour-cet-atelier.html#cb11-7"></a><span class="co"># Cette commande permet également d&#39;exclure les oiseaux</span></span>
<span id="cb11-8"><a href="préparez-vous-pour-cet-atelier.html#cb11-8"></a><span class="co"># aquatiques</span></span>
<span id="cb11-9"><a href="préparez-vous-pour-cet-atelier.html#cb11-9"></a>lm3 &lt;-<span class="st"> </span><span class="kw">lm</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass, <span class="dt">data =</span> bird, <span class="dt">subset =</span> bird<span class="op">$</span>Aquatic <span class="op">==</span></span>
<span id="cb11-10"><a href="préparez-vous-pour-cet-atelier.html#cb11-10"></a><span class="st">    </span><span class="dv">0</span>)</span>
<span id="cb11-11"><a href="préparez-vous-pour-cet-atelier.html#cb11-11"></a></span>
<span id="cb11-12"><a href="préparez-vous-pour-cet-atelier.html#cb11-12"></a><span class="co"># Examinons le modèle</span></span>
<span id="cb11-13"><a href="préparez-vous-pour-cet-atelier.html#cb11-13"></a>opar &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb11-14"><a href="préparez-vous-pour-cet-atelier.html#cb11-14"></a><span class="kw">plot</span>(lm3)</span>
<span id="cb11-15"><a href="préparez-vous-pour-cet-atelier.html#cb11-15"></a><span class="kw">summary</span>(lm3)</span>
<span id="cb11-16"><a href="préparez-vous-pour-cet-atelier.html#cb11-16"></a><span class="kw">par</span>(opar)</span>
<span id="cb11-17"><a href="préparez-vous-pour-cet-atelier.html#cb11-17"></a></span>
<span id="cb11-18"><a href="préparez-vous-pour-cet-atelier.html#cb11-18"></a><span class="co"># Comparons les deux analyses</span></span>
<span id="cb11-19"><a href="préparez-vous-pour-cet-atelier.html#cb11-19"></a>opar &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb11-20"><a href="préparez-vous-pour-cet-atelier.html#cb11-20"></a><span class="kw">plot</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass, <span class="dt">data =</span> bird, <span class="dt">main =</span> <span class="st">&quot;All birds&quot;</span>,</span>
<span id="cb11-21"><a href="préparez-vous-pour-cet-atelier.html#cb11-21"></a>    <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span><span class="st"> &quot;(Maximum Abundance)&quot;</span>), <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span></span>
<span id="cb11-22"><a href="préparez-vous-pour-cet-atelier.html#cb11-22"></a><span class="st">        &quot;(Mass)&quot;</span>))</span>
<span id="cb11-23"><a href="préparez-vous-pour-cet-atelier.html#cb11-23"></a><span class="kw">abline</span>(lm2, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb11-24"><a href="préparez-vous-pour-cet-atelier.html#cb11-24"></a></span>
<span id="cb11-25"><a href="préparez-vous-pour-cet-atelier.html#cb11-25"></a><span class="kw">plot</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass, <span class="dt">data =</span> bird, <span class="dt">subset =</span> <span class="op">!</span>bird<span class="op">$</span>Aquatic,</span>
<span id="cb11-26"><a href="préparez-vous-pour-cet-atelier.html#cb11-26"></a>    <span class="dt">main =</span> <span class="st">&quot;Terrestrial birds&quot;</span>, <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span></span>
<span id="cb11-27"><a href="préparez-vous-pour-cet-atelier.html#cb11-27"></a><span class="st">        &quot;(Maximum Abundance)&quot;</span>), <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span></span>
<span id="cb11-28"><a href="préparez-vous-pour-cet-atelier.html#cb11-28"></a><span class="st">        &quot;(Mass)&quot;</span>), <span class="dt">pch =</span> <span class="dv">19</span>)</span>
<span id="cb11-29"><a href="préparez-vous-pour-cet-atelier.html#cb11-29"></a><span class="kw">abline</span>(lm3, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb11-30"><a href="préparez-vous-pour-cet-atelier.html#cb11-30"></a><span class="kw">opar</span>(par)</span></code></pre></div>
</div>
</div>
<div id="défi-1" class="section level2">
<h2><span class="header-section-number">2.3</span> DÉFI 1</h2>
<p>Examinez la relation entre <em>log<sub>10</sub>(MaxAbund)</em> et <em>log<sub>10</sub>(Mass)</em> pour
les passereaux (i.e. passerine birds).<br />
<code>Conseil :</code> La variable ‘Passerine’ est codée comme 0 et 1, comme la
variable ‘Aquatic’. Vous pouvez vérifier ceci avec la commande
<code>str(bird)</code>.</p>
<p>++++ Défi 1 : Solution |</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="préparez-vous-pour-cet-atelier.html#cb12-1"></a>lm4 &lt;-<span class="st"> </span><span class="kw">lm</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass, <span class="dt">data =</span> bird, <span class="dt">subset =</span> bird<span class="op">$</span>Passerine <span class="op">==</span></span>
<span id="cb12-2"><a href="préparez-vous-pour-cet-atelier.html#cb12-2"></a><span class="st">    </span><span class="dv">1</span>)</span>
<span id="cb12-3"><a href="préparez-vous-pour-cet-atelier.html#cb12-3"></a></span>
<span id="cb12-4"><a href="préparez-vous-pour-cet-atelier.html#cb12-4"></a><span class="co"># Examinez les graphiques de diagnostic</span></span>
<span id="cb12-5"><a href="préparez-vous-pour-cet-atelier.html#cb12-5"></a>opar &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb12-6"><a href="préparez-vous-pour-cet-atelier.html#cb12-6"></a><span class="kw">plot</span>(lm4)</span>
<span id="cb12-7"><a href="préparez-vous-pour-cet-atelier.html#cb12-7"></a><span class="kw">summary</span>(lm4)</span>
<span id="cb12-8"><a href="préparez-vous-pour-cet-atelier.html#cb12-8"></a><span class="kw">par</span>(opar)</span>
<span id="cb12-9"><a href="préparez-vous-pour-cet-atelier.html#cb12-9"></a></span>
<span id="cb12-10"><a href="préparez-vous-pour-cet-atelier.html#cb12-10"></a><span class="co"># Comparez la variance expliquée par lm2, lm3 et lm4</span></span>
<span id="cb12-11"><a href="préparez-vous-pour-cet-atelier.html#cb12-11"></a><span class="kw">str</span>(<span class="kw">summary</span>(lm4))  <span class="co"># Rappelez-vous qu&#39;on veut le R^2 ajusté</span></span>
<span id="cb12-12"><a href="préparez-vous-pour-cet-atelier.html#cb12-12"></a><span class="kw">summary</span>(lm4)<span class="op">$</span>adj.r.squared  <span class="co"># R2-adj = -0.02</span></span>
<span id="cb12-13"><a href="préparez-vous-pour-cet-atelier.html#cb12-13"></a><span class="kw">summary</span>(lm2)<span class="op">$</span>adj.r.squared  <span class="co"># R2-adj = 0.05</span></span>
<span id="cb12-14"><a href="préparez-vous-pour-cet-atelier.html#cb12-14"></a><span class="kw">summary</span>(lm3)<span class="op">$</span>adj.r.squared  <span class="co"># R2-adj = 0.25</span></span>
<span id="cb12-15"><a href="préparez-vous-pour-cet-atelier.html#cb12-15"></a></span>
<span id="cb12-16"><a href="préparez-vous-pour-cet-atelier.html#cb12-16"></a><span class="co"># Comparez visuellement les trois modèles</span></span>
<span id="cb12-17"><a href="préparez-vous-pour-cet-atelier.html#cb12-17"></a>opar &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</span>
<span id="cb12-18"><a href="préparez-vous-pour-cet-atelier.html#cb12-18"></a><span class="kw">plot</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass, <span class="dt">data =</span> bird, <span class="dt">main =</span> <span class="st">&quot;All birds&quot;</span>,</span>
<span id="cb12-19"><a href="préparez-vous-pour-cet-atelier.html#cb12-19"></a>    <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span><span class="st"> &quot;(Maximum Abundance)&quot;</span>), <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span></span>
<span id="cb12-20"><a href="préparez-vous-pour-cet-atelier.html#cb12-20"></a><span class="st">        &quot;(Mass)&quot;</span>), <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="st">&quot;yellowgreen&quot;</span>)</span>
<span id="cb12-21"><a href="préparez-vous-pour-cet-atelier.html#cb12-21"></a><span class="kw">abline</span>(lm2, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb12-22"><a href="préparez-vous-pour-cet-atelier.html#cb12-22"></a></span>
<span id="cb12-23"><a href="préparez-vous-pour-cet-atelier.html#cb12-23"></a><span class="kw">plot</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass, <span class="dt">subset =</span> Passerine <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> bird,</span>
<span id="cb12-24"><a href="préparez-vous-pour-cet-atelier.html#cb12-24"></a>    <span class="dt">main =</span> <span class="st">&quot;Passerine birds&quot;</span>, <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span><span class="st"> &quot;(Maximum Abundance)&quot;</span>),</span>
<span id="cb12-25"><a href="préparez-vous-pour-cet-atelier.html#cb12-25"></a>    <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span><span class="st"> &quot;(Mass)&quot;</span>), <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="st">&quot;violet&quot;</span>)</span>
<span id="cb12-26"><a href="préparez-vous-pour-cet-atelier.html#cb12-26"></a><span class="kw">abline</span>(lm4, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb12-27"><a href="préparez-vous-pour-cet-atelier.html#cb12-27"></a></span>
<span id="cb12-28"><a href="préparez-vous-pour-cet-atelier.html#cb12-28"></a><span class="kw">plot</span>(logMaxAbund <span class="op">~</span><span class="st"> </span>logMass, <span class="dt">data =</span> bird, <span class="dt">subset =</span> <span class="op">!</span>bird<span class="op">$</span>Aquatic,</span>
<span id="cb12-29"><a href="préparez-vous-pour-cet-atelier.html#cb12-29"></a>    <span class="dt">main =</span> <span class="st">&quot;Terrestrial birds&quot;</span>, <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span></span>
<span id="cb12-30"><a href="préparez-vous-pour-cet-atelier.html#cb12-30"></a><span class="st">        &quot;(Maximum Abundance)&quot;</span>), <span class="dt">xlab =</span> <span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="op">*</span></span>
<span id="cb12-31"><a href="préparez-vous-pour-cet-atelier.html#cb12-31"></a><span class="st">        &quot;(Mass)&quot;</span>), <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb12-32"><a href="préparez-vous-pour-cet-atelier.html#cb12-32"></a><span class="kw">abline</span>(lm3, <span class="dt">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb12-33"><a href="préparez-vous-pour-cet-atelier.html#cb12-33"></a><span class="kw">par</span>(opar)</span></code></pre></div>
<p><strong>Conclusion :</strong> Le meilleur modèle parmi les trois est lm3 (celui
effectué sur seulement les oiseaux terrestres )
<img src="images/lm2_lm3_lm4.png" width="850" /> ++++</p>

</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="objectifs-dapprentissage.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="test-de-t-et-anova.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
