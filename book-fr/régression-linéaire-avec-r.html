<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 4 Régression linéaire avec R | Atelier 4: Modèles linéaires</title>
  <meta name="description" content="Modèles linéaires" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 4 Régression linéaire avec R | Atelier 4: Modèles linéaires" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops//assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Modèles linéaires" />
  <meta name="github-repo" content="qcbsRworkshops/workshop04" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 4 Régression linéaire avec R | Atelier 4: Modèles linéaires" />
  
  <meta name="twitter:description" content="Modèles linéaires" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops//assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Développé et entretenu par les contributeurs et les contributrices de la Série d’ateliers R du CSBQ." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="le-modèle-linéaire.html"/>
<link rel="next" href="test-de-t-et-anova.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>Série d’ateliers R du CSBQ</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-de-conduite"><i class="fa fa-check"></i><b>0.1</b> Code de conduite</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#comportement-attendu"><i class="fa fa-check"></i><b>0.1.1</b> Comportement attendu</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#comportements-inacceptables"><i class="fa fa-check"></i><b>0.1.2</b> Comportements inacceptables</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributeurs-et-contributrices"><i class="fa fa-check"></i><b>0.2</b> Contributeurs et contributrices</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contribuez-à-la-série"><i class="fa fa-check"></i><b>0.3</b> Contribuez à la série!</a></li>
</ul></li>
<li class="part"><span><b>Modèles linéaires en <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="objectifs-dapprentissage.html"><a href="objectifs-dapprentissage.html"><i class="fa fa-check"></i><b>1</b> Objectifs d’apprentissage</a></li>
<li class="chapter" data-level="2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html"><i class="fa fa-check"></i><b>2</b> Préparez-vous pour cet atelier</a></li>
<li class="chapter" data-level="3" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html"><i class="fa fa-check"></i><b>3</b> Le modèle linéaire</a>
<ul>
<li class="chapter" data-level="3.1" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#quest-ce-quun-modèle-linéaire"><i class="fa fa-check"></i><b>3.1</b> Qu’est-ce qu’un modèle linéaire ?</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#exemple-abondance-et-masse-des-espèces-doiseaux"><i class="fa fa-check"></i><b>3.1.1</b> Exemple : Abondance et masse des espèces d’oiseaux</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#formulation-dun-modèle-linéaire"><i class="fa fa-check"></i><b>3.2</b> Formulation d’un modèle linéaire</a></li>
<li class="chapter" data-level="3.3" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#évaluation-du-modèle-linéaire"><i class="fa fa-check"></i><b>3.3</b> Évaluation du modèle linéaire</a></li>
<li class="chapter" data-level="3.4" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#conditions-dapplication-du-modèle-linéaire"><i class="fa fa-check"></i><b>3.4</b> Conditions d’application du modèle linéaire</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#normalité-des-résidus"><i class="fa fa-check"></i><b>3.4.1</b> Normalité des résidus</a></li>
<li class="chapter" data-level="3.4.2" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#homoscédasticité"><i class="fa fa-check"></i><b>3.4.2</b> Homoscédasticité</a></li>
<li class="chapter" data-level="3.4.3" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#indépendance-des-résidus"><i class="fa fa-check"></i><b>3.4.3</b> Indépendance des résidus</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#notation-des-modèles-linéaires"><i class="fa fa-check"></i><b>3.5</b> Notation des modèles linéaires</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#notation-mathématique"><i class="fa fa-check"></i><b>3.5.1</b> Notation mathématique</a></li>
<li class="chapter" data-level="3.5.2" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#notation-en-r"><i class="fa fa-check"></i><b>3.5.2</b> Notation en R</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#effectuer-un-modèle-linéaire"><i class="fa fa-check"></i><b>3.6</b> Effectuer un modèle linéaire</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#estimation-du-modèle"><i class="fa fa-check"></i><b>3.6.1</b> Estimation du modèle</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#modèles-linéaires"><i class="fa fa-check"></i><b>3.7</b> Modèles linéaires</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html"><i class="fa fa-check"></i><b>4</b> Régression linéaire avec R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#formulation-du-modèle"><i class="fa fa-check"></i><b>4.1</b> Formulation du modèle</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#équation-du-modèle"><i class="fa fa-check"></i><b>4.1.1</b> Équation du modèle</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#régression-linéaire-avec-r-1"><i class="fa fa-check"></i><b>4.2</b> Régression linéaire avec R</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#étape-1.-formuler-et-exécuter-un-modèle-linéaire"><i class="fa fa-check"></i><b>4.2.1</b> <strong>Étape 1.</strong> Formuler et exécuter un modèle linéaire</a></li>
<li class="chapter" data-level="4.2.2" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#étape-2.-vérifier-les-conditions-dapplication-avec-les-graphiques-diagnostics"><i class="fa fa-check"></i><b>4.2.2</b> <strong>Étape 2.</strong> Vérifier les conditions d’application avec les graphiques diagnostics</a></li>
<li class="chapter" data-level="4.2.3" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#étape-2.-vérifier-les-conditions-dapplication-pour-lm1"><i class="fa fa-check"></i><b>4.2.3</b> <strong>Étape 2</strong>. Vérifier les conditions d’application pour <code>lm1</code></a></li>
<li class="chapter" data-level="4.2.4" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#conditions-non-respectées---quelle-est-la-cause"><i class="fa fa-check"></i><b>4.2.4</b> Conditions non respectées - Quelle est la cause ?</a></li>
<li class="chapter" data-level="4.2.5" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#conditions-non-respectées---comment-procéder"><i class="fa fa-check"></i><b>4.2.5</b> Conditions non respectées - Comment procéder ?</a></li>
<li class="chapter" data-level="4.2.6" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#étape-3.-analyser-les-paramètres"><i class="fa fa-check"></i><b>4.2.6</b> <strong>Étape 3.</strong> Analyser les paramètres</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#interprétation-du-modèle"><i class="fa fa-check"></i><b>4.3</b> Interprétation du modèle</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#trouver-un-meilleur-modèle-oiseaux-terrestres"><i class="fa fa-check"></i><b>4.3.1</b> Trouver un meilleur modèle: oiseaux terrestres</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#défi-2"><i class="fa fa-check"></i><b>4.4</b> Défi 2</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#solutions"><i class="fa fa-check"></i><b>4.4.1</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#régression-linéaire-avec-r-2"><i class="fa fa-check"></i><b>4.5</b> Régression linéaire avec R</a></li>
<li class="chapter" data-level="4.6" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#noms-de-variables"><i class="fa fa-check"></i><b>4.6</b> Noms de variables</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html"><i class="fa fa-check"></i><b>5</b> Test de t et ANOVA</a>
<ul>
<li class="chapter" data-level="5.1" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#anova"><i class="fa fa-check"></i><b>5.1</b> ANOVA</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#types-danova"><i class="fa fa-check"></i><b>5.1.1</b> Types d’ANOVA</a></li>
<li class="chapter" data-level="5.1.2" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#test-de-t"><i class="fa fa-check"></i><b>5.1.2</b> Test de t</a></li>
<li class="chapter" data-level="5.1.3" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#effectuer-une-anova"><i class="fa fa-check"></i><b>5.1.3</b> Effectuer une ANOVA</a></li>
<li class="chapter" data-level="5.1.4" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#vérification-des-conditions-dapplication"><i class="fa fa-check"></i><b>5.1.4</b> Vérification des conditions d’application</a></li>
<li class="chapter" data-level="5.1.5" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#exemple-avec-le-jeu-de-données-bird"><i class="fa fa-check"></i><b>5.1.5</b> Exemple avec le jeu de données <code>bird</code></a></li>
<li class="chapter" data-level="5.1.6" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#sortie-du-modèle"><i class="fa fa-check"></i><b>5.1.6</b> Sortie du modèle</a></li>
<li class="chapter" data-level="5.1.7" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#tests-complémentaires"><i class="fa fa-check"></i><b>5.1.7</b> Tests complémentaires</a></li>
<li class="chapter" data-level="5.1.8" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#visualisation-des-résultats"><i class="fa fa-check"></i><b>5.1.8</b> Visualisation des résultats</a></li>
<li class="chapter" data-level="5.1.9" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#allons-plus-loin-contrastes"><i class="fa fa-check"></i><b>5.1.9</b> Allons plus loin: Contrastes</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#anova-à-deux-critères-de-classification"><i class="fa fa-check"></i><b>5.2</b> ANOVA à deux critères de classification</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#effectuer-une-anova-à-deux-critères-de-classification"><i class="fa fa-check"></i><b>5.2.1</b> Effectuer une ANOVA à deux critères de classification</a></li>
<li class="chapter" data-level="5.2.2" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#diagramme-dinteraction"><i class="fa fa-check"></i><b>5.2.2</b> Diagramme d’interaction</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#anova-non-équilibrée-section-avancéefacultative"><i class="fa fa-check"></i><b>5.3</b> ANOVA non-équilibrée (section avancée/facultative)</a></li>
<li class="chapter" data-level="5.4" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#ancova"><i class="fa fa-check"></i><b>5.4</b> 6. ANCOVA</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#conditions-de-base-1"><i class="fa fa-check"></i><b>5.4.1</b> 6.1 Conditions de base</a></li>
<li class="chapter" data-level="5.4.2" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#types-dancova"><i class="fa fa-check"></i><b>5.4.2</b> 6.2 Types d’ANCOVA</a></li>
<li class="chapter" data-level="5.4.3" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#effectuer-une-ancova"><i class="fa fa-check"></i><b>5.4.3</b> 6.3 Effectuer une ANCOVA</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="régression-multiple.html"><a href="régression-multiple.html"><i class="fa fa-check"></i><b>6</b> Régression multiple</a>
<ul>
<li class="chapter" data-level="6.0.1" data-path="régression-multiple.html"><a href="régression-multiple.html#formulation-du-modèle-1"><i class="fa fa-check"></i><b>6.0.1</b> Formulation du modèle</a></li>
<li class="chapter" data-level="6.1" data-path="régression-multiple.html"><a href="régression-multiple.html#conditions-dapplication"><i class="fa fa-check"></i><b>6.1</b> Conditions d’application</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="régression-multiple.html"><a href="régression-multiple.html#en-cas-de-colinéarité"><i class="fa fa-check"></i><b>6.1.1</b> En cas de colinéarité</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="régression-multiple.html"><a href="régression-multiple.html#régression-linéaire-multiple-dans-r"><i class="fa fa-check"></i><b>6.2</b> Régression linéaire multiple dans R</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="régression-multiple.html"><a href="régression-multiple.html#les-données"><i class="fa fa-check"></i><b>6.2.1</b> Les données</a></li>
<li class="chapter" data-level="6.2.2" data-path="régression-multiple.html"><a href="régression-multiple.html#vérification-des-conditions-dapplication-1"><i class="fa fa-check"></i><b>6.2.2</b> Vérification des conditions d’application</a></li>
<li class="chapter" data-level="6.2.3" data-path="régression-multiple.html"><a href="régression-multiple.html#régression-linéaire"><i class="fa fa-check"></i><b>6.2.3</b> Régression linéaire</a></li>
<li class="chapter" data-level="6.2.4" data-path="régression-multiple.html"><a href="régression-multiple.html#définir-le-meilleur-modèle"><i class="fa fa-check"></i><b>6.2.4</b> Définir le meilleur modèle</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="régression-multiple.html"><a href="régression-multiple.html#régression-polynomiale-matériel-facultatif"><i class="fa fa-check"></i><b>6.3</b> Régression polynomiale (matériel facultatif)</a></li>
<li class="chapter" data-level="6.4" data-path="régression-multiple.html"><a href="régression-multiple.html#partitionnement-de-la-variation-matériel-facultatif"><i class="fa fa-check"></i><b>6.4</b> Partitionnement de la variation (matériel facultatif)</a></li>
</ul></li>
<li class="part"><span><b>Considérations finales</b></span></li>
<li class="chapter" data-level="7" data-path="résumé.html"><a href="résumé.html"><i class="fa fa-check"></i><b>7</b> Résumé</a></li>
<li class="chapter" data-level="8" data-path="ressources-additionnelles.html"><a href="ressources-additionnelles.html"><i class="fa fa-check"></i><b>8</b> Ressources additionnelles</a></li>
<li class="chapter" data-level="9" data-path="réferences.html"><a href="réferences.html"><i class="fa fa-check"></i><b>9</b> Réferences</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Atelier 4: Modèles linéaires</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>


<!-- 
<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
--!>
<div id="régression-linéaire-avec-r" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapitre 4</span> Régression linéaire avec R<a href="régression-linéaire-avec-r.html#régression-linéaire-avec-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Dans l’exemple suivant, nous reprendrons les données d’abondance et de masse des oiseaux pour effectuer une régression linéaire en R. Basé sur l’hypothèse, nous formulons une formule qui nous permet d’exécuter le modèle et puis nous vérifions les conditions d’application de celui-ci. Nous verrons également comment interpréter la sortie du modèle et comment le représenter graphiquement.</p>
<div id="formulation-du-modèle" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Formulation du modèle<a href="régression-linéaire-avec-r.html#formulation-du-modèle" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
<p>Les données sont composées de la masse moyenne des individus d’une espèce et l’abondance de ces espèces. Nous sommes intéressés à quantifier la relation entre la masse d’un individu et l’abondance de l’espèce (ou l’effet de la masse sur l’abondance).</p>
<p>Nous avons formulé l’hypothèse que pour différentes espèces d’oiseaux, la <strong>masse moyenne d’un individu a un effet sur l’abondance maximale</strong> de l’espèce, en raison de contraintes écologiques (sources de nourriture, disponibilité de l’habitat, etc.).</p>
<div id="équation-du-modèle" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Équation du modèle<a href="régression-linéaire-avec-r.html#équation-du-modèle" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En notation mathématique, un modèle linéaire prend la forme de l’équation d’une droite pour laquelle la variable prédite est l’abondance maximale “MaxAbund” et la variable prédicteur est la masse des individus “Mass”.</p>
<p><span class="math display">\[\textrm{MaxAbund}_i = \beta_0 + \beta_1 \times \textrm{Mass}_i + \epsilon_i \;, \quad \epsilon_i \sim \mathcal{N}(0, \sigma^2)\]</span></p>
<blockquote>
<p>Notez que le modèle linéaire a trois variables: <span class="math inline">\(\beta_0\)</span> , <span class="math inline">\(\beta_1\)</span> et <span class="math inline">\(\sigma^1\)</span>. <span class="math inline">\(\sigma^1\)</span> défini la variance des données autour du modèle et est une variable de la distribution normale qui décrit la distribution des données autour du modèle (de part et d’autre de notre droite).</p>
</blockquote>
<p><strong>Formule en R</strong></p>
<p>Dans le langage de programmation R, l’équation est traduite par :</p>
<pre><code>MaxAbund ~ Mass</code></pre>
<p>où la variable prédite est placée à gauche du tilde et la variable prédicteur est à droite.</p>
</div>
</div>
<div id="régression-linéaire-avec-r-1" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Régression linéaire avec R<a href="régression-linéaire-avec-r.html#régression-linéaire-avec-r-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
<p>Effectuer une régression linéaire avec R se découpe en trois étapes:</p>
<ol style="list-style-type: decimal">
<li>Formuler et exécuter un modèle linéaire basé sur un hypothèse</li>
<li>Vérifier les conditions d’application du modèle linéaire</li>
<li>Examiner la sortie du modèle et si les conditions sont respectées
<ul>
<li>Analyser les paramètres de régression</li>
<li>Tracer le modèle</li>
<li>Effectuer des tests de signification sur les estimations des paramètres (si nécessaire)</li>
</ul></li>
</ol>
<p>Nous allons explorer chaque étape dans les sections suivantes.</p>
<p>Aussi, dans le cas ou les conditions ne sont pas respectées, nous verrons qu’il est possible d’envisager l’utilisation d’un <em>Modèle linéaire généralisé</em> (GLM) ou la transformation des données.</p>
<div id="étape-1.-formuler-et-exécuter-un-modèle-linéaire" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> <strong>Étape 1.</strong> Formuler et exécuter un modèle linéaire<a href="régression-linéaire-avec-r.html#étape-1.-formuler-et-exécuter-un-modèle-linéaire" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La fonction <code>lm()</code> est utilisée pour ajuster un modèle linéaire, en fournissant la formule du modèle comme premier argument :</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="régression-linéaire-avec-r.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Régression linéaire de l&#39;abondance maximale en fonction</span></span>
<span id="cb18-2"><a href="régression-linéaire-avec-r.html#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># de la masse</span></span>
<span id="cb18-3"><a href="régression-linéaire-avec-r.html#cb18-3" aria-hidden="true" tabindex="-1"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(MaxAbund <span class="sc">~</span> Mass, <span class="at">data =</span> bird)</span></code></pre></div>
<p>Avec cette ligne de code, nous définissons un nouvel objet <code>lm1</code> qui contient le modèle linéaire. Nous spécifions également deux arguments dans la fonction. Le premier <code>MaxAbund ~ Mass</code> est la formule du modèle et le second <code>bird</code> définis l’objet qui contient les variables.</p>
<blockquote>
<p>Avant d’utiliser une nouvelle fonction dans R, vous devriez vous référer à sa page d’aide (<code>?nomdelafonction</code>) afin de comprendre comment utiliser la fonction ainsi que les paramètres par défaut.</p>
</blockquote>
<p>Regardons les estimations des paramètres :</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="régression-linéaire-avec-r.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Examen de la sortie de la régression</span></span>
<span id="cb19-2"><a href="régression-linéaire-avec-r.html#cb19-2" aria-hidden="true" tabindex="-1"></a>lm1</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = MaxAbund ~ Mass, data = bird)
## 
## Coefficients:
## (Intercept)         Mass  
##    38.16646      0.01439</code></pre>
<p>Comment les paramètres se comparent-ils à nos prédictions ? Vous remarquerez que le paramètre pour la masse est positif alors que nous avons prédit une relation négative (<em>Les espèces caractérisées par des individus plus grands ont une abondance maximale plus faible</em>).</p>
<p>Cependant, pouvons-nous nous fier aux estimations? Pour en être certain, il faut vérifier les conditions d’application !</p>
</div>
<div id="étape-2.-vérifier-les-conditions-dapplication-avec-les-graphiques-diagnostics" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> <strong>Étape 2.</strong> Vérifier les conditions d’application avec les graphiques diagnostics<a href="régression-linéaire-avec-r.html#étape-2.-vérifier-les-conditions-dapplication-avec-les-graphiques-diagnostics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Une méthode efficace pour vérifier le respect des conditions d’application du modèle est de procéder à un examen visuel. Quatre graphiques diagnostiques peuvent être produits d’un objet <code>lm</code>. Pour ce faire, nous utilisons ces commandes :</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="régression-linéaire-avec-r.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tracer les quatres graphiques diagnostiques</span></span>
<span id="cb21-2"><a href="régression-linéaire-avec-r.html#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb21-3"><a href="régression-linéaire-avec-r.html#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm1)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-17-1.png" width="528" /></p>
<p><code>par()</code> est une fonction qui permet de définir les paramètres du graphique. Ici, nous spécifions <code>mfrow=c(2,2)</code> qui permet d’afficher une grille de 2 x 2 graphiques à la fois. Finalement, <code>plot()</code>produit les graphiques.</p>
<blockquote>
<p>Pour afficher une seule figure (parcelle) à la fois, nous pouvons spécifier <code>par(mfrow=1)</code>.</p>
</blockquote>
<div id="graphique-1---résidus-vs-valeurs-prédites" class="section level4 hasAnchor" number="4.2.2.1">
<h4><span class="header-section-number">4.2.2.1</span> Graphique #1 - Résidus vs valeurs prédites<a href="régression-linéaire-avec-r.html#graphique-1---résidus-vs-valeurs-prédites" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Le premier graphique nous informe de la distribution des résidus en fonction des valeurs prédites par le modèle de régression linéaire. Chaque point représente la distance entre la variable réponse et la réponse prédite par le modèle. Il nous informe sur l’<em>indépendance</em> des résidus et sur leur <em>distribution</em>. Il faut se rappeler qu’avec la régression linéaire, nous avons besoin d’une distribution uniforme des résidus (condition d’<em>homoscédasticité</em>).</p>
<p><img src="book-fr_files/figure-html/unnamed-chunk-18-1.png" width="624" /></p>
<p>Sur l’axe des <strong>y</strong> nous retrouvons les résidus <span class="math inline">\(\epsilon_i\)</span> et sur l’axe des <strong>x</strong> les valeurs prédites <span class="math inline">\(\hat{y_i} = \beta_0 + \beta_1 \times x_i\)</span>.</p>
<p>Dans une situation idéale, la dispersion des points ne présente pas de patron.</p>
<ul>
<li>Si les résidus sont dispersés de façon <strong>aléatoire autour de la ligne de 0</strong>, la relation est linéaire et la moyenne des résidus est 0.</li>
<li>Si les résidus forment une <strong>bande horizontale</strong> approximative autour de la ligne de 0, la variance des résidus est homogène (donc, ils sont homoscédastiques).</li>
<li>Si les résidus sont organisés <strong>en forme d’entonnoir</strong>, les résidus ne sont pas homoscédastiques.</li>
</ul>
<hr />
<p><strong>Alerte !</strong> Il faut être alerté si la distribution des points est non-linéaire comme dans ces deux exemples :</p>
<p><img src="book-fr_files/figure-html/unnamed-chunk-19-1.png" width="816" /></p>
<p>Ces exemples présentent une relation non linéaire et un exemple d’hétéroscédasticité qui est l’opposé de l’homoscédasticité, ce qui signifie que la condition de normalité est n’est pas respectée.</p>
<p>Dans cette situation, il faut plutôt utiliser un <strong>modèle linéaire généralisé</strong> (MLG) qui permet d’autres distributions (Poisson, binomial, binomial négatif, etc.) ou essayer de <strong>transformer</strong> la variable réponse et/ou les prédicteurs.</p>
<hr />
</div>
<div id="graphique-2---échelle-localisée" class="section level4 hasAnchor" number="4.2.2.2">
<h4><span class="header-section-number">4.2.2.2</span> Graphique #2 - Échelle localisée<a href="régression-linéaire-avec-r.html#graphique-2---échelle-localisée" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Le deuxième graphique diagnostique permet de vérifier si la <em>dispersion des résidus</em> augmente pour une valeur prédite donnée (i.e. si la dispersion des résidus est causée par la variable explicative). Si la dispersion augmente, la condition de base d’homoscédasticité n’est pas respectée.</p>
<p><img src="book-fr_files/figure-html/unnamed-chunk-20-1.png" width="576" /></p>
<p>Sur l’axe des <strong>y</strong> nous retrouvons la racine carrée des résidus standardisés <span class="math inline">\(\sqrt{\frac{\epsilon_i}{\sigma}}\)</span> et sur l’axe des <strong>x</strong> les valeurs prédites <span class="math inline">\(\hat{y_i} = \beta_0 + \beta_1 \times x_i\)</span>.</p>
<p>Nous recherchons ici aussi une dispersion des points sans patron, donc un prédicteur distribué de manière égale.</p>
<hr />
<p><strong>Alerte !</strong> Il faut être méfiant si la distribution des points présente une tendance marquée :</p>
<p><img src="book-fr_files/figure-html/unnamed-chunk-21-1.png" width="576" /></p>
<p>Dans une situation comme celle-ci, nous ne pouvons nous fier aux résultats de modèle et devons plutôt essayer d’utiliser un <strong>modèle linéaire généralisé</strong> (MLG) qui permet d’autres distributions (Poisson, binomial, binomial négatif, etc.) ou de <strong>transformer</strong> la variable réponse et/ou les prédicteurs.</p>
<hr />
</div>
<div id="graphique-3---normal-qq" class="section level4 hasAnchor" number="4.2.2.3">
<h4><span class="header-section-number">4.2.2.3</span> Graphique #3 - Normal QQ<a href="régression-linéaire-avec-r.html#graphique-3---normal-qq" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Le troisième graphique présente la distribution des résidus. Avec ce graphique quantile-quantile, nous pouvons évaluer la normalité des résidus. Ce graphique compare la distribution de probabilité des résidus du modèle à une distribution de probabilité de données normales.</p>
<p><img src="book-fr_files/figure-html/unnamed-chunk-22-1.png" width="576" /></p>
<p>Sur l’axe des <strong>y</strong> nous retrouvons les résidus standardisés <span class="math inline">\(\frac{\epsilon_i}{\sigma}\)</span> et sur l’axe des <strong>x</strong> les quantiles d’une distribution normale standard <span class="math inline">\(\mathcal{N}(0, \sigma^2)\)</span>.</p>
<p>Nous voulons voir les résidus standardisés sont près de la ligne 1:1. Ainsi, les résidus peuvent être considérés comme normalement distribués.</p>
<hr />
<p><strong>Alerte !</strong> Il faut être méfiant si la distribution des points ne suit pas la ligne 1:1 :</p>
<p><img src="book-fr_files/figure-html/unnamed-chunk-23-1.png" width="576" /></p>
<p>Dans ce cas-ci, les points ne sont pas bien alignés sur la droite, ce qui suggère que les résidus ne sont pas distribués normalement. Il faut plutôt essayer d’utiliser un <strong>modèle linéaire généralisé</strong> (MLG) qui permet d’autres distributions (Poisson, binomial, binomial négatif, etc.) ou de <strong>transformer</strong> la variable réponse et/ou les prédicteurs.</p>
<hr />
</div>
<div id="graphique-4---résidus-vs-effet-de-levier" class="section level4 hasAnchor" number="4.2.2.4">
<h4><span class="header-section-number">4.2.2.4</span> Graphique #4 - Résidus vs effet de levier<a href="régression-linéaire-avec-r.html#graphique-4---résidus-vs-effet-de-levier" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Ce dernier graphique diagnostique présente les résidus et leur influence. Il permet de déterminer si certaines observations ont une forte influence. Bien que nous ne testons pas un test de condition de base, la présence de points avec une forte influence peut influencer notre interprétation des données. Si une ou certaines observations sont aberrantes (donc, si elles ont des valeurs très différentes des autres), le modèle peut être mal ajusté en raison de leur influence exagérée sur l’estimation du modèle.</p>
<p>Le graphique des résidus vs effet de levier présente les <em>points de levier</em> qui sont des observations extrêmes du prédicteur et leur influence sur la régression. L’influence est quantifiée par la <em>distance Cook</em>. <strong>Une distance supérieure à 0,5 est problématique</strong>.</p>
<p><strong>Exemple d’effet de levier et d’influence</strong></p>
<p>Il ne s’agit pas ici de graphiques diagnostiques, mais de figures qui illustrent les concepts d’effet de levier et d’influence.</p>
<p><img src="book-fr_files/figure-html/unnamed-chunk-24-1.png" width="739.2" /></p>
<p>Sur l’axe des <strong>y</strong> nous retrouvons la réponse et le prédicteur sur l’axe des <strong>x</strong>.</p>
<p>Le modèle ne devrait pas <strong>pas dépendre fortement d’observations isolées</strong>. Une influence élevée de points de levier cause le modèle à passer près des points de levier, car ils manquent d’observations voisines.</p>
<p><strong>Graphique #4</strong></p>
<p>Le graphique diagnostique présente Sur l’axe des <strong>y</strong> les résidus standardisés <span class="math inline">\(\frac{\epsilon_i}{\sigma}\)</span> et l’effet de levier sur l’axe des <strong>x</strong>. La ligne pointillée rouge marque la distance de Cook de 0,5.</p>
<p><img src="book-fr_files/figure-html/unnamed-chunk-25-1.png" width="864" /></p>
<p>Nous voulons observer des résidus se situant à l’intérieur des lignes pointillées marquant la distance de Cook de 0,5.</p>
<hr />
<p><strong>Alerte !</strong> Il faut être méfiant si un ou des points se trouvent à l’extérieur de la ligne pointillée :</p>
<p><img src="book-fr_files/figure-html/unnamed-chunk-26-1.png" width="768" /></p>
<p>Le 29 a un effet de levier et une distance de Cook de plus de 0,5. Il correspond à une donnée aberrante. Il ne faut cependant jamais supprimer les valeurs aberrantes sans avoir de bonnes raisons de le faire ! Si (et seulement si!) ces observations correspondent à des
erreurs de mesure ou à des exceptions, elles peuvent être retirées du jeu de données.</p>
<hr />
</div>
</div>
<div id="étape-2.-vérifier-les-conditions-dapplication-pour-lm1" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> <strong>Étape 2</strong>. Vérifier les conditions d’application pour <code>lm1</code><a href="régression-linéaire-avec-r.html#étape-2.-vérifier-les-conditions-dapplication-pour-lm1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Le modèle <code>lm1</code> respecte-t-il les conditions du modèle linéaire ?</p>
<p><img src="book-fr_files/figure-html/unnamed-chunk-27-1.png" width="720" /></p>
<p>En se basant sur les connaissances acquises dans les sections précédentes, ces graphiques diagnostiques présentent de sérieux problèmes.
* Les graphiques 1 et 2 présentent de fortes tendances,
* Le graphique 3 montre que les résidus ne suivent pas une distribution normale,
* Le graphique 4 met en évidence l’effet levier du point 32 et de son influence très élevée.</p>
<hr />
</div>
<div id="conditions-non-respectées---quelle-est-la-cause" class="section level3 hasAnchor" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Conditions non respectées - Quelle est la cause ?<a href="régression-linéaire-avec-r.html#conditions-non-respectées---quelle-est-la-cause" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pour comprendre la source des problèmes du modèle linéaire, traçons le modèle avec les observations :</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="régression-linéaire-avec-r.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphique du modèle et des observations</span></span>
<span id="cb22-2"><a href="régression-linéaire-avec-r.html#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb22-3"><a href="régression-linéaire-avec-r.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(lm1)  <span class="co"># constante et pente</span></span></code></pre></div>
<pre><code>## (Intercept)        Mass 
## 38.16645523  0.01438562</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="régression-linéaire-avec-r.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(MaxAbund <span class="sc">~</span> Mass, <span class="at">data =</span> bird)  <span class="co"># graphique à gauche</span></span>
<span id="cb24-2"><a href="régression-linéaire-avec-r.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(lm1)  <span class="co"># ligne définie par les paramètres du modèle</span></span>
<span id="cb24-3"><a href="régression-linéaire-avec-r.html#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">residuals</span>(lm1))  <span class="co"># graphique à droite : distribution des résidus</span></span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-28-1.png" width="1056" /></p>
<p>À gauche nous avons les données ainsi que la droite représentant l’estimation du modèle (<code>MaxAbund ~ Mass</code>). À gauche, la distribution des résidus.</p>
<p>Nous pouvons vérifier si les résidus suivent une distribution normale à l’aide d’un test de <em>Shapiro-Wilk</em> et d’un test d’asymétrie (<em>skewness</em>) :</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="régression-linéaire-avec-r.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de la normalité des résidus</span></span>
<span id="cb25-2"><a href="régression-linéaire-avec-r.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(lm1))</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  residuals(lm1)
## W = 0.64158, p-value = 3.172e-10</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="régression-linéaire-avec-r.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test d&#39;asymétrie</span></span>
<span id="cb27-2"><a href="régression-linéaire-avec-r.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb27-3"><a href="régression-linéaire-avec-r.html#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(<span class="fu">residuals</span>(lm1))</span></code></pre></div>
<pre><code>## [1] 3.154719</code></pre>
<p>Le test de Shapiro-Wilk compare la distribution des données observées à une distribution normale. Les données observées peuvent être considérées comme normalement distribuées lorsque la valeur de p calculée par le test de Shapiro-Wilk est supérieure au seuil de significativité α (généralement 0.05). Ici, la valeur de p (<code>p-value</code>) retournée indique une distribution significativement différente d’une normale.</p>
<p>Le test d’asymétrie mesure le décalage des résidus. Une valeur positive représente un décalage vers la gauche et une valeur négative un décalage vers la droite. Ici, la valeur positive d’asymétrie indique que la distribution est décalée vers la gauche.</p>
<hr />
</div>
<div id="conditions-non-respectées---comment-procéder" class="section level3 hasAnchor" number="4.2.5">
<h3><span class="header-section-number">4.2.5</span> Conditions non respectées - Comment procéder ?<a href="régression-linéaire-avec-r.html#conditions-non-respectées---comment-procéder" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Clairement, les conditions d’application du modèle linéaire <code>lm1</code> ne sont pas respectées. Nous ne pouvons donc pas nous fier aux résultats du modèle. Il faut se tourner vers une autre alternative et il y a deux options lorsque les conditions d’application du modèle linéaire ne sont pas respectées.</p>
<p><strong>Utiliser un autre type de modèle</strong></p>
<p>Les ateliers R 6 à 8 du CSBQ explorent d’autres modèles qui pourraient être mieux adaptés à l’hypothèse et aux données.</p>
<p><strong>Transformer les données</strong></p>
<p>Il est également possible de modifier ses données, que ce soit la variable réponse ou les prédicteurs. Plusieurs types de transformations sont possibles et leur utilité dépend de la distribution de la variable et du type de modèle. Cependant, <strong>la modification des variables est souvent délicate en pratique</strong>. La transformation peut <strong>régler certains</strong> problèmes, mais peut en <strong>créer d’autres</strong>.</p>
<blockquote>
<p>Il est à noter que les <strong>résultats des tests de signification</strong> sur les données transformées ne sont <strong>pas automatiquement valables</strong> pour les données non transformées.</p>
</blockquote>
<hr />
<div id="défi-1-un-modèle-sur-variables-transformées" class="section level4 hasAnchor" number="4.2.5.1">
<h4><span class="header-section-number">4.2.5.1</span> Défi 1: Un modèle sur variables transformées<a href="régression-linéaire-avec-r.html#défi-1-un-modèle-sur-variables-transformées" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Notre modèle présente de sérieux problèmes. Essayons une transformation logarithmique pour voir si ça peut corriger la situation.</p>
<p>Premièrement, transformez données et exécutez une nouvelle régression linéaire sur ces données. Par la suite, vérifiez le respect des conditions d’application du nouveau modèle en utilisant les graphiques diagnostiques.</p>
<p><strong>Étape 1</strong></p>
<p>Débutons par la transformation des données de notre jeu de données :</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="régression-linéaire-avec-r.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformation logarithmique des données</span></span>
<span id="cb29-2"><a href="régression-linéaire-avec-r.html#cb29-2" aria-hidden="true" tabindex="-1"></a>bird<span class="sc">$</span>logMaxAbund <span class="ot">&lt;-</span> <span class="fu">log10</span>(bird<span class="sc">$</span>MaxAbund)</span>
<span id="cb29-3"><a href="régression-linéaire-avec-r.html#cb29-3" aria-hidden="true" tabindex="-1"></a>bird<span class="sc">$</span>logMass <span class="ot">&lt;-</span> <span class="fu">log10</span>(bird<span class="sc">$</span>Mass)</span></code></pre></div>
<p>Avec ces données <code>logMaxAbund</code> et <code>logMass</code> transformées, nous exécutons une nouvelle régression linéaire et sauvegardons l’objet du modèle sous <code>lm2</code>.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="régression-linéaire-avec-r.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modèle linéaire sur les données transformées</span></span>
<span id="cb30-2"><a href="régression-linéaire-avec-r.html#cb30-2" aria-hidden="true" tabindex="-1"></a>lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(logMaxAbund <span class="sc">~</span> logMass, <span class="at">data =</span> bird)</span></code></pre></div>
<p>Nous pouvons observer que les paramètres s’alignent avec notre prédiction. C’est-à-dire, que le coefficient <code>logMass</code> est négatif et donc que l’abondance décroit avec la masse de l’espèce. Cependant, il faut encore vérifier conditions d’application du modèle pour s’assurer de la validité des résultats.</p>
<p><strong>Étape 2</strong></p>
<p>Vérifions les conditions pour <code>lm2</code> en utilisant les graphiques diagnostiques.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="régression-linéaire-avec-r.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphiques diagnostiques</span></span>
<span id="cb31-2"><a href="régression-linéaire-avec-r.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="fl">1.15</span>, <span class="fl">1.2</span>))</span>
<span id="cb31-3"><a href="régression-linéaire-avec-r.html#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm2)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-32-1.png" width="720" /></p>
<p>Les graphiques diagnostiques semblent beaucoup mieux, mais il reste des problèmes. Certains graphiques présentent encore des tendances marquées. Traçons le modèle avec les observations :</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="régression-linéaire-avec-r.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphique du modèle et des observations</span></span>
<span id="cb32-2"><a href="régression-linéaire-avec-r.html#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb32-3"><a href="régression-linéaire-avec-r.html#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(lm2)  <span class="co"># constantes et pente</span></span></code></pre></div>
<pre><code>## (Intercept)     logMass 
##   1.6723673  -0.2361498</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="régression-linéaire-avec-r.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(logMaxAbund <span class="sc">~</span> logMass, <span class="at">data =</span> bird)  <span class="co"># graphique à gauche</span></span>
<span id="cb34-2"><a href="régression-linéaire-avec-r.html#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(lm2)  <span class="co"># ligne définie par les paramètres du modèle</span></span>
<span id="cb34-3"><a href="régression-linéaire-avec-r.html#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">residuals</span>(lm2))  <span class="co"># graphique à droite : distribution des résidus</span></span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-33-1.png" width="1056" /></p>
<p>Le modèle semble mieux expliquer les données et la distribution des résidus s’est beaucoup rapprochée de la distribution normale.</p>
<hr />
</div>
</div>
<div id="étape-3.-analyser-les-paramètres" class="section level3 hasAnchor" number="4.2.6">
<h3><span class="header-section-number">4.2.6</span> <strong>Étape 3.</strong> Analyser les paramètres<a href="régression-linéaire-avec-r.html#étape-3.-analyser-les-paramètres" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La dernière étape d’une régression linéaire avec R est de vérifier les paramètres du modèle. Nous utilisons alors la commande <code>summary()</code> pour obtenir plus d’informations sure le modèle ajusté.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="régression-linéaire-avec-r.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Paramètres du modèle ajusté</span></span>
<span id="cb35-2"><a href="régression-linéaire-avec-r.html#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm2)</span></code></pre></div>
<pre><code>
Call:
lm(formula = logMaxAbund ~ logMass, data = bird)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.93562 -0.39982  0.05487  0.40625  1.61469 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   1.6724     0.2472   6.767 1.17e-08 ***
logMass      -0.2361     0.1170  -2.019   0.0487 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.6959 on 52 degrees of freedom
Multiple R-squared:  0.07267,   Adjusted R-squared:  0.05484 
F-statistic: 4.075 on 1 and 52 DF,  p-value: 0.04869</code></pre>
<p>La sortie de <code>summary()</code> présente plusieurs valeurs :
1. <code>Coefficients</code> : Estimations des paramètres et leur écart type
2. <code>Pr(&gt;|t|)</code> : Résultats d’un test de t visant à déterminer si les paramètres sont différents de 0
3. <code>Adjusted R squared</code> (R au carré ajusté) : Dans quelle mesure le modèle explique-t-il les données ?
4. <code>F-statistic</code> (statistique F) (ANOVA) : Le modèle est-il significativement différent d’un modèle sans prédicteur (modèle nul) ?</p>
<p>Nous aborderons dans la prochaine section les Tests de T et l’ANOVA. Nous pouvons cependant déjà en dégager que notre modèle n’est que marginalement meilleur que le modèle nul.</p>
<p>Avec l’objet <code>lm2</code>, nous pouvons aussi extraire les paramètres du modèle et les autres résultats :</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="régression-linéaire-avec-r.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vecteurs de résidus et valeurs prédites</span></span>
<span id="cb37-2"><a href="régression-linéaire-avec-r.html#cb37-2" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">residuals</span>(lm2)</span>
<span id="cb37-3"><a href="régression-linéaire-avec-r.html#cb37-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">fitted</span>(lm2)</span>
<span id="cb37-4"><a href="régression-linéaire-avec-r.html#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(lm2)  <span class="co"># coefficients</span></span></code></pre></div>
<pre><code>## (Intercept)     logMass 
##   1.6723673  -0.2361498</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="régression-linéaire-avec-r.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm2)<span class="sc">$</span>coefficients  <span class="co"># coefficients avec test de t</span></span></code></pre></div>
<pre><code>##               Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept)  1.6723673  0.2471519  6.766557 1.166186e-08
## logMass     -0.2361498  0.1169836 -2.018658 4.869342e-02</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="régression-linéaire-avec-r.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm2)<span class="sc">$</span>adj.r.squared  <span class="co"># R au carré ajusté</span></span></code></pre></div>
<pre><code>## [1] 0.05483696</code></pre>
</div>
</div>
<div id="interprétation-du-modèle" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Interprétation du modèle<a href="régression-linéaire-avec-r.html#interprétation-du-modèle" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
<p>L’interprétation du modèle est l’étape finale lorsque nous obtenons un modèle qui respecte les conditions d’application. L’interprétation est l’évaluation de l’appui du modèle pour l’hypothèse. Bref, nous répondons à la question: <em>Dans quelle mesure le modèle soutient notre hypothèse ?</em></p>
<p><strong>Hypothèse</strong></p>
<blockquote>
<p>Pour différentes espèces d’oiseaux, la <strong>masse moyenne d’un individu a un effet sur l’abondance maximale</strong> de l’espèce, en raison de contraintes écologiques (sources de nourriture, disponibilité de l’habitat, etc.).</p>
</blockquote>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="régression-linéaire-avec-r.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sommaire du modèle linéaire avec les données</span></span>
<span id="cb43-2"><a href="régression-linéaire-avec-r.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co"># log-transformées</span></span>
<span id="cb43-3"><a href="régression-linéaire-avec-r.html#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm2)</span></code></pre></div>
<pre><code>
Call:
lm(formula = logMaxAbund ~ logMass, data = bird)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.93562 -0.39982  0.05487  0.40625  1.61469 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   1.6724     0.2472   6.767 1.17e-08 ***
logMass      -0.2361     0.1170  -2.019   0.0487 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.6959 on 52 degrees of freedom
Multiple R-squared:  0.07267,   Adjusted R-squared:  0.05484 
F-statistic: 4.075 on 1 and 52 DF,  p-value: 0.04869</code></pre>
<p>Le modèle <code>lm2</code> ne présente que très <strong>peu preuves à l’appui</strong> de l’hypothèse. En regardant les paramètres du modèle comme nous l’avons vu précédemment, nous observons que le modèle explique peu de la réponse.</p>
<p>Le faible <code>R au carré ajusté</code> indique qu’une faible partie de la variance de la variable réponse est expliquée par le modèle. La masse n’explique qu’une petite fraction de l’abondance des espèces.</p>
<p>Le <code>F-test</code> est à peine significatif ce qui indique que le modèle n’est que légèrement meilleur qu’un modèle sans variables prédictives.</p>
<p>Finalement, la taille d’effet estimé (le coefficient) du paramètre <code>logMass</code> est très près de zéro et n’est que marginalement significative, c’est-à-dire qu’une augmentation ou une diminution de la masse des espèces n’entraine quasiment pas de changement dans leur abondance.</p>
<p>Les résultats ne sont pas à la hauteur de ce que nous aimerions, peut-être devrions-nous formuler une hypothèse plus précise ?</p>
<div id="trouver-un-meilleur-modèle-oiseaux-terrestres" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Trouver un meilleur modèle: oiseaux terrestres<a href="régression-linéaire-avec-r.html#trouver-un-meilleur-modèle-oiseaux-terrestres" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Formulons une nouvelle hypothèse plus précise. Cette fois, concentrons-nous seulement sur les oiseaux terrestres. L’abondance des oiseaux aquatiques ne répond peut-être pas de la même façon à la masse que les oiseaux terrestres.</p>
<p><strong>Nouvelle hypothèse</strong></p>
<blockquote>
<p>Pour différentes espèces d’oiseaux <span style="color:green"><strong>terrestres</strong></span>, la <strong>masse moyenne d’un individu a un effet sur l’abondance maximale</strong> de l’espèce, en raison de contraintes écologiques (sources de nourriture, disponibilité de l’habitat, etc.).</p>
</blockquote>
<p>Nous pouvons maintenant ajuster le modèle linéaire pour exclure les oiseaux aquatiques. Il suffit :</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="régression-linéaire-avec-r.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modèle linéaire avec oiseaux terrestres</span></span>
<span id="cb45-2"><a href="régression-linéaire-avec-r.html#cb45-2" aria-hidden="true" tabindex="-1"></a>lm3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(logMaxAbund <span class="sc">~</span> logMass, <span class="at">data =</span> bird, <span class="at">subset =</span> <span class="sc">!</span>bird<span class="sc">$</span>Aquatic)</span>
<span id="cb45-3"><a href="régression-linéaire-avec-r.html#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># exclut les oiseaux aquatiques (!birdsAquatic == TRUE) ou</span></span>
<span id="cb45-4"><a href="régression-linéaire-avec-r.html#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># de façon équivalente : lm3 &lt;- lm(logMaxAbund~logMass,</span></span>
<span id="cb45-5"><a href="régression-linéaire-avec-r.html#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># data=bird, subset=bird$Aquatic == 0)</span></span>
<span id="cb45-6"><a href="régression-linéaire-avec-r.html#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="régression-linéaire-avec-r.html#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Sortie du modèle</span></span>
<span id="cb45-8"><a href="régression-linéaire-avec-r.html#cb45-8" aria-hidden="true" tabindex="-1"></a>lm3</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = logMaxAbund ~ logMass, data = bird, subset = !bird$Aquatic)
## 
## Coefficients:
## (Intercept)      logMass  
##      2.2701      -0.6429</code></pre>
<p>Et vérifions les conditions d’application du modèle :</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="régression-linéaire-avec-r.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb47-2"><a href="régression-linéaire-avec-r.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm3)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-39-1.png" width="720" /></p>
<p>Au vu des graphiques diagnostiques, nous pouvons conclure qu les conditions d’application sont respectées !</p>
<p>Finalement, le modèle fournit des <strong>preuves à l’appui</strong> de notre hypothèse :</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="régression-linéaire-avec-r.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm3)</span></code></pre></div>
<pre><code>
Call:
lm(formula = logMaxAbund ~ logMass, data = bird, subset = !bird$Aquatic)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.78289 -0.23135  0.04031  0.22932  1.68109 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   2.2701     0.2931   7.744 2.96e-09 ***
logMass      -0.6429     0.1746  -3.683 0.000733 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.6094 on 37 degrees of freedom
Multiple R-squared:  0.2682,    Adjusted R-squared:  0.2485 
F-statistic: 13.56 on 1 and 37 DF,  p-value: 0.000733</code></pre>
<p>Le <code>R au carré ajusté</code> est de 0,25, ce qui indique que le modèle est raisonnablement bien ajusté aux données. Le modèle est bien meilleur qu’un modèle sans variables prédictives. Le <code>F-test</code> est significatif (&lt; 0.05). Le <code>T-test</code> montre que l’estimation du paramètre “logMass” est clairement différente de 0 (<em>t-test</em>) et que la masse a un effet sur l’abondance des espèces.</p>
<hr />
</div>
</div>
<div id="défi-2" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Défi 2<a href="régression-linéaire-avec-r.html#défi-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Pour le deuxième défi, rassemblons toutes les étapes et essayons avec de nouvelles données :</p>
<ol style="list-style-type: decimal">
<li>Formuler une autre hypothèse similaire sur l’abondance maximale et la masse moyenne d’un individu, cette fois pour les <strong>passereaux</strong> (“passerine birds”).</li>
<li>Ajuster un <strong>modèle</strong> pour évaluer cette hypothèse, en utilisant les variables transformées (c’est-à-dire <code>logMaxAbund</code> et <code>logMass</code>). Sauvegarder le modèle sous le nom de <code>lm4</code>.</li>
<li><strong>Vérifier les conditions d’application</strong> du modèle linéaire à l’aide des graphiques diagnostiques.</li>
<li>Interpréter les résultats : Le modèle fournit-il des <strong>preuves à l’appui de l’hypothèse ?</strong></li>
</ol>
<blockquote>
<p>Indice : Comme les espèces aquatiques, les passereaux (variable <code>Passerine</code>) sont codées 0/1 (vérifier avec <code>str(bird)</code>)</p>
</blockquote>
<div id="solutions" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Solutions<a href="régression-linéaire-avec-r.html#solutions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Hypothèse</strong></p>
<blockquote>
<p>Pour différentes espèces de <span style="color:green"><strong>passereaux</strong></span>, la <strong>masse moyenne d’un individu a un effet sur l’abondance maximale</strong> de l’espèce, en raison de contraintes écologiques (sources de nourriture, disponibilité de l’habitat, etc.).</p>
</blockquote>
<p><strong>Ajuster le modèle</strong></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="régression-linéaire-avec-r.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modèle linéaire pour les passeraux</span></span>
<span id="cb50-2"><a href="régression-linéaire-avec-r.html#cb50-2" aria-hidden="true" tabindex="-1"></a>lm4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(logMaxAbund <span class="sc">~</span> logMass, <span class="at">data =</span> bird, <span class="at">subset =</span> bird<span class="sc">$</span>Passerine <span class="sc">==</span></span>
<span id="cb50-3"><a href="régression-linéaire-avec-r.html#cb50-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>)</span>
<span id="cb50-4"><a href="régression-linéaire-avec-r.html#cb50-4" aria-hidden="true" tabindex="-1"></a>lm4</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = logMaxAbund ~ logMass, data = bird, subset = bird$Passerine == 
##     1)
## 
## Coefficients:
## (Intercept)      logMass  
##      1.2429       0.2107</code></pre>
<p><strong>Vérifier les conditions d’application</strong></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="régression-linéaire-avec-r.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb52-2"><a href="régression-linéaire-avec-r.html#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lm4)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-43-1.png" width="768" /></p>
<p><strong>Vaut-il la peine d’interpréter les résultats ?</strong></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="régression-linéaire-avec-r.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm4)</span></code></pre></div>
<pre><code>
Call:
lm(formula = logMaxAbund ~ logMass, data = bird, subset = bird$Passerine == 
    1)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.24644 -0.20937  0.02494  0.25192  0.93624 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)   1.2429     0.4163   2.985  0.00661 **
logMass       0.2107     0.3076   0.685  0.50010   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.5151 on 23 degrees of freedom
Multiple R-squared:   0.02, Adjusted R-squared:  -0.02261 
F-statistic: 0.4694 on 1 and 23 DF,  p-value: 0.5001</code></pre>
<p>Les résultats du modèle ne doivent pas être interprétés, car les conditions d’application du modèle linéaire ne sont pas respectées!</p>
</div>
</div>
<div id="régression-linéaire-avec-r-2" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Régression linéaire avec R<a href="régression-linéaire-avec-r.html#régression-linéaire-avec-r-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
<p>Effectuer une régression linéaire avec R se découpe en trois étapes:</p>
<ol style="list-style-type: decimal">
<li>Formuler et exécuter un modèle linéaire basé sur une hypothèse</li>
<li>Vérifier les conditions d’application du modèle linéaire</li>
<li>Examiner la sortie du modèle et si les conditions sont respectées
<ul>
<li>Analyser les paramètres de régression</li>
<li>Tracer le modèle</li>
<li>Effectuer des tests de signification sur les estimations des paramètres (si nécessaire)</li>
</ul></li>
</ol>
<p>Nous allons explorer chaque étape dans les sections suivantes.</p>
<p>Aussi, dans le cas où les conditions ne sont pas respectées, nous verrons qu’il est possible d’envisager l’utilisation d’un <em>Modèle linéaire généralisé</em> (GLM) ou la transformation des données.</p>
</div>
<div id="noms-de-variables" class="section level2 hasAnchor" number="4.6">
<h2><span class="header-section-number">4.6</span> Noms de variables<a href="régression-linéaire-avec-r.html#noms-de-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<hr />
<p>Des termes différents sont utilisés pour la <em>réponse</em> et le <em>prédicteur</em>, en fonction du contexte et du domaine scientifique. Les termes ne sont pas toujours synonymes. Voici deux tableaux pour vous éclairer sur le jargon que vous rencontrerez.</p>
<table>
<thead>
<tr class="header">
<th align="left">résponse</th>
<th align="left">prédicteur</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">var. expliqué</td>
<td align="left">var. explicatif</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">covariable</td>
</tr>
<tr class="odd">
<td align="left">var. endogène</td>
<td align="left">var. exogène</td>
</tr>
<tr class="even">
<td align="left">var. dépendante</td>
<td align="left">var. indépendante</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="header">
<th align="left">response</th>
<th align="left">predictor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"></td>
<td align="left">explanatory var.</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">covariate</td>
</tr>
<tr class="odd">
<td align="left">outcome</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">output var.</td>
<td align="left">input var.</td>
</tr>
<tr class="odd">
<td align="left">dependent var.</td>
<td align="left">independent var.</td>
</tr>
</tbody>
</table>

</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="le-modèle-linéaire.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="test-de-t-et-anova.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
