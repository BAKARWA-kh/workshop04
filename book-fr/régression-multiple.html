<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 4 Régression multiple | Atelier 4: Modèles linéaires</title>
  <meta name="description" content="Modèles linéaires" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 4 Régression multiple | Atelier 4: Modèles linéaires" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://github.com/qcbsRworkshops/" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops//assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Modèles linéaires" />
  <meta name="github-repo" content="qcbsRworkshops/workshop04" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 4 Régression multiple | Atelier 4: Modèles linéaires" />
  
  <meta name="twitter:description" content="Modèles linéaires" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops//assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Développé et entretenu par les contributeurs et les contributrices de la Série d’ateliers R du CSBQ." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="test-de-t-et-anova.html"/>
<link rel="next" href="résumé.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>Série d’ateliers R du CSBQ</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-de-conduite"><i class="fa fa-check"></i><b>0.1</b> Code de conduite</a><ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#comportement-attendu"><i class="fa fa-check"></i><b>0.1.1</b> Comportement attendu</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#comportements-inacceptables"><i class="fa fa-check"></i><b>0.1.2</b> Comportements inacceptables</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributeurs-et-contributrices"><i class="fa fa-check"></i><b>0.2</b> Contributeurs et contributrices</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contribuez-à-la-série"><i class="fa fa-check"></i><b>0.3</b> Contribuez à la série!</a></li>
</ul></li>
<li class="part"><span><b>Modèles linéaires en <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="objectifs-dapprentissage.html"><a href="objectifs-dapprentissage.html"><i class="fa fa-check"></i><b>1</b> Objectifs d’apprentissage</a></li>
<li class="chapter" data-level="2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html"><i class="fa fa-check"></i><b>2</b> Préparez-vous pour cet atelier</a><ul>
<li class="chapter" data-level="2.1" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#aperçu"><i class="fa fa-check"></i><b>2.1</b> 1. Aperçu</a><ul>
<li class="chapter" data-level="2.1.1" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#définir-la-moyenne-et-la-variation"><i class="fa fa-check"></i><b>2.1.1</b> 1.1 Définir la moyenne et la variation</a></li>
<li class="chapter" data-level="2.1.2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#les-modèles-linéaires"><i class="fa fa-check"></i><b>2.1.2</b> 1.2 Les modèles linéaires</a></li>
<li class="chapter" data-level="2.1.3" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#conditions-de-base-du-modèle-linéaire"><i class="fa fa-check"></i><b>2.1.3</b> 1.3 Conditions de base du modèle linéaire</a></li>
<li class="chapter" data-level="2.1.4" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#statistiques-de-tests-et-p-values"><i class="fa fa-check"></i><b>2.1.4</b> 1.4 Statistiques de tests et p-values</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#régression-linéaire-simple"><i class="fa fa-check"></i><b>2.2</b> 2. Régression linéaire simple</a><ul>
<li class="chapter" data-level="2.2.1" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#flux-de-travail"><i class="fa fa-check"></i><b>2.2.1</b> Flux de travail</a></li>
<li class="chapter" data-level="2.2.2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#effectuer-un-modèle-linéaire"><i class="fa fa-check"></i><b>2.2.2</b> 2.1 Effectuer un modèle linéaire</a></li>
<li class="chapter" data-level="2.2.3" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#validation-des-conditions-de-base"><i class="fa fa-check"></i><b>2.2.3</b> 2.2 Validation des conditions de base</a></li>
<li class="chapter" data-level="2.2.4" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#normalisation-des-données"><i class="fa fa-check"></i><b>2.2.4</b> 2.3 Normalisation des données</a></li>
<li class="chapter" data-level="2.2.5" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#transformation-des-données"><i class="fa fa-check"></i><b>2.2.5</b> 2.4 Transformation des données</a></li>
<li class="chapter" data-level="2.2.6" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#sortie-du-modèle"><i class="fa fa-check"></i><b>2.2.6</b> 2.5 Sortie du modèle</a></li>
<li class="chapter" data-level="2.2.7" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#sous-ensembles-dobservations"><i class="fa fa-check"></i><b>2.2.7</b> 2.7 Sous-ensembles d’observations</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html#défi-1"><i class="fa fa-check"></i><b>2.3</b> DÉFI 1</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html"><i class="fa fa-check"></i><b>3</b> Test de t et ANOVA</a><ul>
<li class="chapter" data-level="3.1" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#anova"><i class="fa fa-check"></i><b>3.1</b> ANOVA</a><ul>
<li class="chapter" data-level="3.1.1" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#types-danova"><i class="fa fa-check"></i><b>3.1.1</b> 3.1 Types d’ANOVA</a></li>
<li class="chapter" data-level="3.1.2" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#test-de-t"><i class="fa fa-check"></i><b>3.1.2</b> 3.2 Test de t</a></li>
<li class="chapter" data-level="3.1.3" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#effectuer-une-anova"><i class="fa fa-check"></i><b>3.1.3</b> 3.3 Effectuer une ANOVA</a></li>
<li class="chapter" data-level="3.1.4" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#vérification-des-conditions-de-base"><i class="fa fa-check"></i><b>3.1.4</b> 3.4 Vérification des conditions de base</a></li>
<li class="chapter" data-level="3.1.5" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#sortie-du-modèle-1"><i class="fa fa-check"></i><b>3.1.5</b> 3.5 Sortie du modèle</a></li>
<li class="chapter" data-level="3.1.6" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#test-complémentaire"><i class="fa fa-check"></i><b>3.1.6</b> 3.6 Test complémentaire</a></li>
<li class="chapter" data-level="3.1.7" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#visualisation-des-résultats"><i class="fa fa-check"></i><b>3.1.7</b> 3.7 Visualisation des résultats</a></li>
<li class="chapter" data-level="3.1.8" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#allons-plus-loin-contrastes"><i class="fa fa-check"></i><b>3.1.8</b> Allons plus loin: Contrastes</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#anova-à-deux-critères-de-classification"><i class="fa fa-check"></i><b>3.2</b> 4. ANOVA à deux critères de classification</a><ul>
<li class="chapter" data-level="3.2.1" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#effectuer-une-anova-à-deux-critères-de-classification"><i class="fa fa-check"></i><b>3.2.1</b> 4.1 Effectuer une ANOVA à deux critères de classification</a></li>
<li class="chapter" data-level="3.2.2" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#diagramme-dinteraction"><i class="fa fa-check"></i><b>3.2.2</b> 4.2 Diagramme d’interaction</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#anova-non-équilibrée-section-avancéefacultative"><i class="fa fa-check"></i><b>3.3</b> 5. ANOVA non-équilibrée (section avancée/facultative)</a></li>
<li class="chapter" data-level="3.4" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#ancova"><i class="fa fa-check"></i><b>3.4</b> 6. ANCOVA</a><ul>
<li class="chapter" data-level="3.4.1" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#conditions-de-base-1"><i class="fa fa-check"></i><b>3.4.1</b> 6.1 Conditions de base</a></li>
<li class="chapter" data-level="3.4.2" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#types-dancova"><i class="fa fa-check"></i><b>3.4.2</b> 6.2 Types d’ANCOVA</a></li>
<li class="chapter" data-level="3.4.3" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#effectuer-une-ancova"><i class="fa fa-check"></i><b>3.4.3</b> 6.3 Effectuer une ANCOVA</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="régression-multiple.html"><a href="régression-multiple.html"><i class="fa fa-check"></i><b>4</b> Régression multiple</a><ul>
<li class="chapter" data-level="4.0.1" data-path="régression-multiple.html"><a href="régression-multiple.html#conditions-de-base-2"><i class="fa fa-check"></i><b>4.0.1</b> 7.1 Conditions de base</a></li>
<li class="chapter" data-level="4.0.2" data-path="régression-multiple.html"><a href="régression-multiple.html#jeu-de-données-dickcissel"><i class="fa fa-check"></i><b>4.0.2</b> 7.2 Jeu de données Dickcissel</a></li>
<li class="chapter" data-level="4.0.3" data-path="régression-multiple.html"><a href="régression-multiple.html#allons-plus-loin-régression-polynomiale"><i class="fa fa-check"></i><b>4.0.3</b> Allons plus loin: Régression polynomiale</a></li>
<li class="chapter" data-level="4.0.4" data-path="régression-multiple.html"><a href="régression-multiple.html#régression-pas-à-pas"><i class="fa fa-check"></i><b>4.0.4</b> 7.4 Régression pas à pas</a></li>
<li class="chapter" data-level="4.1" data-path="régression-multiple.html"><a href="régression-multiple.html#allons-plus-loin-partition-de-la-variation"><i class="fa fa-check"></i><b>4.1</b> Allons plus loin: Partition de la variation</a></li>
</ul></li>
<li class="part"><span><b>Considérations finales</b></span></li>
<li class="chapter" data-level="5" data-path="résumé.html"><a href="résumé.html"><i class="fa fa-check"></i><b>5</b> Résumé</a></li>
<li class="chapter" data-level="6" data-path="resources-additionnels.html"><a href="resources-additionnels.html"><i class="fa fa-check"></i><b>6</b> Resources additionnels</a></li>
<li class="chapter" data-level="7" data-path="réferences.html"><a href="réferences.html"><i class="fa fa-check"></i><b>7</b> Réferences</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Atelier 4: Modèles linéaires</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>


<!-- 
<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
--!>
<div id="régression-multiple" class="section level1">
<h1><span class="header-section-number">Chapitre 4</span> Régression multiple</h1>
<p>Une régression multiple teste les effets de plusieurs variables
explicatives continues sur une variable réponse continue.</p>
<div id="conditions-de-base-2" class="section level3">
<h3><span class="header-section-number">4.0.1</span> 7.1 Conditions de base</h3>
<p>En plus des conditions de base habituelles des modèles linéaires, il est
important de tester pour <strong>l’orthogonalité</strong> parce que ceci influence
l’interprétation du modèle. Les variables sont orthogonales quand les
variables explicatives sont colinéaires. Si une variable explicative est
corrélée avec une autre variable, elles expliquent probablement la même
variabilité dans la variable réponse, et l’effet d’une variable sera
caché par l’autre.S’il existe une relation entre deux variables
explicatives, elles sont donc <strong>colinéaires</strong>.</p>
<p>La colinéarité doit être évitée, car il ne sera pas possible de
distinguer les effets propres à chaque variable. Voici quelques
solutions possibles :</p>
<ol style="list-style-type: decimal">
<li>Gardez seulement <strong>une</strong> des variables colinéaires,</li>
<li>Essayez une analyse multidimensionelle <em><a href="http://qcbs.ca/wiki/r_atelier9">(voir
l’atelier 9)</a></em>,</li>
<li>Essayez une analyse pseudo-orthogonale.</li>
</ol>
<p>La colinéarité entre variables explicatives peut être vérifiée à l’aide
du <strong>facteur d’inflation de la variance</strong> (VIF ou <em>"variance inflation
factor"</em>) en utilisant la fonction <code>vif</code> du paquet <code>HH</code>.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="régression-multiple.html#cb56-1"></a><span class="kw">vif</span>(clDD <span class="op">~</span><span class="st"> </span>clFD <span class="op">+</span><span class="st"> </span>clTmi <span class="op">+</span><span class="st"> </span>clTma <span class="op">+</span><span class="st"> </span>clP <span class="op">+</span><span class="st"> </span>grass, <span class="dt">data =</span> Dickcissel)</span></code></pre></div>
<p>qui produit la sortie suivante:</p>
<pre><code>  clFD        clTmi       clTma           clP         grass
 13.605855    9.566169    4.811837    3.196599    1.165775</code></pre>
<p>Les variables colinéaires ont un VIF plus grand que 5. La sortie R
montre alors que <em>clDD</em>, <em>clFD</em>, et <em>clTmi</em> sont fortement colinéaires.
Seulement une de ces variables explicatives peut être retenue dans le
modèle de régression final.</p>
</div>
<div id="jeu-de-données-dickcissel" class="section level3">
<h3><span class="header-section-number">4.0.2</span> 7.2 Jeu de données Dickcissel</h3>
<p>Le jeu de données Dickcissel (du nom d’un petit oiseau granivore de la
famille des Cardinalidae) explore les effets de plusieurs variables
environnementales qui pourraient expliquer l’abondance et la présence
d’une espèce d’oiseau des prairies nord-américaines avec des pics
d’abondance au Kansas, É-U. Le jeu de données contient 15 variables :</p>
<table style="width:98%;">
<colgroup>
<col width="26%" />
<col width="43%" />
<col width="28%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Nom de la variable</th>
<th align="left">Description</th>
<th align="left">Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">abund</td>
<td align="left">Le nombre d’individus  C
observé sur chaque route</td>
<td align="left">ontinu/ numérique</td>
</tr>
<tr class="even">
<td align="left">Present</td>
<td align="left">Présence/ absence<br />
de l’espèce</td>
<td align="left">Binaire ("Présent"/ "Absent")</td>
</tr>
<tr class="odd">
<td align="left">broadleaf, conif, crop, grass,<br />
shrub, urban, wetland</td>
<td align="left">Variables du paysage à moins de 20 km de rayon<br />
du centre de la route</td>
<td align="left">Continu/ numérique</td>
</tr>
<tr class="even">
<td align="left">NDVI</td>
<td align="left">Indice de végétation (une mesure de la productivité)</td>
<td align="left">Nombre entier</td>
</tr>
<tr class="odd">
<td align="left">clDD, clFD, clTma, clTmi, clP</td>
<td align="left">Données climatiques (DD = degrés jours,<br />
FD = jours de gel, Tma = température max,<br />
Tmi = température min,<br />
P = précipitation)</td>
<td align="left">Continu/ numérique</td>
</tr>
</tbody>
</table>
<p>Dans R, une régression multiple est effectuée à l’aide de la fonction
<code>lm()</code> et les résultats peuvent être visualisés avec la fonction
<code>summary()</code>. En utilisant le jeu de données Dickcissel, on peut tester
les effets du <em>climat</em>, de la <em>productivité</em> et du <em>paysage</em> sur
l’<em>abondance</em> du Dickcissel à l’aide d’un modèle de régression
multiple.</p>
<hr />
<p><strong>DÉFI 5</strong></p>
<p>Est-il nécessaire de transformer la variable réponse <em>abund</em> ?</p>
<p>++++ Défi 5: Solution|</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="régression-multiple.html#cb58-1"></a><span class="kw">hist</span>(Dickcissel<span class="op">$</span>abund, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Dickcissel abundance&quot;</span>)</span>
<span id="cb58-2"><a href="régression-multiple.html#cb58-2"></a><span class="kw">shapiro.test</span>(Dickcissel<span class="op">$</span>abund)</span>
<span id="cb58-3"><a href="régression-multiple.html#cb58-3"></a><span class="kw">skewness</span>(Dickcissel<span class="op">$</span>abund)</span>
<span id="cb58-4"><a href="régression-multiple.html#cb58-4"></a><span class="kw">summary</span>(Dickcissel<span class="op">$</span>abund)</span></code></pre></div>
<p>Il y a plusieurs zéros dans la distribution de la variable <em>abund</em>. On
peut ajouter une constante avant d’effectuer une transformation
logarithmique, étant donnée la forte asymétrie de la distribution :</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="régression-multiple.html#cb59-1"></a><span class="kw">hist</span>(<span class="kw">log10</span>(Dickcissel<span class="op">$</span>abund<span class="fl">+0.1</span>), =<span class="dt">main=</span><span class="st">&quot;&quot;</span>, <span class="dt">xlab=</span><span class="kw">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>]<span class="op">*</span><span class="st">&quot;(Dickcissel Abundance + 0.1)&quot;</span>))</span>
<span id="cb59-2"><a href="régression-multiple.html#cb59-2"></a><span class="kw">shapiro.test</span>(<span class="kw">log10</span>(Dickcissel<span class="op">$</span>abund<span class="fl">+0.1</span>))</span>
<span id="cb59-3"><a href="régression-multiple.html#cb59-3"></a><span class="kw">skewness</span>(<span class="kw">log10</span>(Dickcissel<span class="op">$</span>abund<span class="fl">+0.1</span>))</span></code></pre></div>
<p>La variable n’est toujours pas distribuée normalement après la
transformation.</p>
<p>++++</p>
<hr />
<p>Dans le défi 5, vous avez probablement remarqué que la variable réponse
<em>abund</em> n’a pas pu être normalisée. Il faudrait alors peut-être laisser
tomber la supposition de normalité et passer à un <a href="http://qcbs.ca/wiki/r_atelier7">modèle linéaire
généralisé</a>, mais ceci ira à plus tard !</p>
<p>Pour l’instant, nous allons utiliser la variable <em>abund</em>
non-transformée et comparer l’importance relative de trois variables
explicatives (<em>climat</em>, <em>productivité</em> et <em>paysage</em>) sur l’<em>abondance</em>.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="régression-multiple.html#cb60-1"></a>lm.mult &lt;-<span class="st"> </span><span class="kw">lm</span>(abund <span class="op">~</span><span class="st"> </span>clTma <span class="op">+</span><span class="st"> </span>NDVI <span class="op">+</span><span class="st"> </span>grass, <span class="dt">data =</span> Dickcissel)</span>
<span id="cb60-2"><a href="régression-multiple.html#cb60-2"></a><span class="kw">summary</span>(lm.mult)</span></code></pre></div>
<p>La sortie de R indique quelles variables explicatives sont
significatives :</p>
<pre><code>lm(formula = abund ~ clTma + NDVI + grass, data = Dickcissel)
Residuals:
 Min          1Q          Median          3Q           Max
-35.327   -11.029     -4.337      2.150       180.725
Coefficients:
              Estimate    Std. Error  t value     Pr(&gt;|t|)
(Intercept)   -83.60813       11.57745    -7.222      1.46e-12 ***
clTma         3.27299     0.40677     8.046       4.14e-15 ***
NDVI          0.13716     0.05486     2.500       0.0127 *
grass         10.41435        4.68962     2.221       0.0267 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
Residual standard error: 22.58 on 642 degrees of freedom
Multiple R-squared:  0.117,     Adjusted R-squared:  0.1128
F-statistic: 28.35 on 3 and 642 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Dans ce cas-ci, les trois variables explicatives ont une influence
significative sur l’abondance de Dickcissel, la plus significative
étant le climat (p = 4.14e-15). Ces trois variables expliquent 11.28% de
la variabilité de l’abondance de Dickcissel (R carré ajusté = 0.1128).
Le modèle global est également significatif et explique la variabilité
de l’abondance de Dickcissel mieux qu’un modèle nul (p &lt; 2.2e-16).</p>
<p>Un graphique de la variable réponse en fonction de chaque variable
explicative peut être utilisé pour représenter les résultats du modèle :</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="régression-multiple.html#cb62-1"></a><span class="kw">plot</span>(abund <span class="op">~</span><span class="st"> </span>clTma, <span class="dt">data =</span> Dickcissel, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="st">&quot;orange&quot;</span>)</span>
<span id="cb62-2"><a href="régression-multiple.html#cb62-2"></a><span class="kw">plot</span>(abund <span class="op">~</span><span class="st"> </span>NDVI, <span class="dt">data =</span> Dickcissel, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="st">&quot;skyblue&quot;</span>)</span>
<span id="cb62-3"><a href="régression-multiple.html#cb62-3"></a><span class="kw">plot</span>(abund <span class="op">~</span><span class="st"> </span>grass, <span class="dt">data =</span> Dickcissel, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>)</span></code></pre></div>
<p><img src="images/lm_fig%2013.png" width="850" /></p>
</div>
<div id="allons-plus-loin-régression-polynomiale" class="section level3">
<h3><span class="header-section-number">4.0.3</span> Allons plus loin: Régression polynomiale</h3>
<p>Les relations entre variables réponses et variables
explicatives ne sont pas toujours linéaires. Dans ce cas, une régression
linéaire, qui correspond à une droite reliant deux variables, est
incapable de représenter la relation entre ces deux variables. Une
régression polynomiale permet de tracer une courbe polynomiale entre la
variable réponse et la variable explicative, et permet de représenter
une relation non linéaire basée sur le modèle mathématique suivant :</p>
<p>$ {y_i} = {β_0} + {β_1}{x_i} +
{β_2}[](images/x_i}^2} + {β_3}{{x_i}^3} + {ε_i} </m> pour un polynôme de degré 3\
<m> {y_i} = {β_0} + {β_1}{x_i} + {β_2}{{x_i}^2} + {ε_i} </m> pour un polynôme de degré 2</p>
<p>où</p>
<p>β<sub>0</sub> est l’ordonnée à l’origine de la droite de régression,\
β<sub>1</sub> est l’effet de la variable x,\
β<sub>2</sub> est l’effet de la variable x au carré (x<sup>2</sup>),\
β<sub>3</sub> est l’effet de la variable x au cube (x<sup>3</sup>),\
ε<sub>i</sub> sont les résidus du modèle (i.e. la variation inexpliquée).</p>
<p>Le degré du polynôme est l’exposant le plus élevé de l’équation. En connaissant le degré du polynôme, on peut le qualifier /</p>
<p>{{/polynomial_degree.png){width=“250”}</p>
<p>Dans R, ces modèles sont effectués avec la fonction <code>lm()</code> et peuvent
être comparés entre eux avec la fonction <code>anova()</code> :</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="régression-multiple.html#cb63-1"></a>lm.linear &lt;-<span class="st"> </span><span class="kw">lm</span>(abund <span class="op">~</span><span class="st"> </span>clDD, <span class="dt">data =</span> Dickcissel)</span>
<span id="cb63-2"><a href="régression-multiple.html#cb63-2"></a>lm.quad &lt;-<span class="st"> </span><span class="kw">lm</span>(abund <span class="op">~</span><span class="st"> </span>clDD <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(clDD<span class="op">^</span><span class="dv">2</span>), <span class="dt">data =</span> Dickcissel)</span>
<span id="cb63-3"><a href="régression-multiple.html#cb63-3"></a>lm.cubic &lt;-<span class="st"> </span><span class="kw">lm</span>(abund <span class="op">~</span><span class="st"> </span>clDD <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(clDD<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(clDD<span class="op">^</span><span class="dv">3</span>), <span class="dt">data =</span> Dickcissel)</span></code></pre></div>
<hr />
<p><strong>DÉFI 7</strong></p>
<p>Comparez les différents modèles polynomiaux de l’exemple précédent et
déterminez quel modèle est le plus approprié. Extrayez le R carré
ajusté, les coefficients de régression et les valeurs de p de ce modèle.</p>
<p>++++ Défi 7: Solution|</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="régression-multiple.html#cb64-1"></a><span class="kw">anova</span>(lm.linear, lm.quad, lm.cubic)  <span class="co"># fait la liste des modèles par ordre croissant de complexité.</span></span>
<span id="cb64-2"><a href="régression-multiple.html#cb64-2"></a><span class="co"># On accepte le modèle se trouvant sur la ligne la plus</span></span>
<span id="cb64-3"><a href="régression-multiple.html#cb64-3"></a><span class="co"># basse avec une valeur de p significative.  i.e. le modèle</span></span>
<span id="cb64-4"><a href="régression-multiple.html#cb64-4"></a><span class="co"># lm.quad</span></span>
<span id="cb64-5"><a href="régression-multiple.html#cb64-5"></a></span>
<span id="cb64-6"><a href="régression-multiple.html#cb64-6"></a><span class="co"># Examinons le résumé du modèle</span></span>
<span id="cb64-7"><a href="régression-multiple.html#cb64-7"></a><span class="kw">summary</span>(lm.quad)</span>
<span id="cb64-8"><a href="régression-multiple.html#cb64-8"></a><span class="co"># Les coefficients de régression</span></span>
<span id="cb64-9"><a href="régression-multiple.html#cb64-9"></a><span class="kw">summary</span>(lm.quad)<span class="op">$</span>coefficients[, <span class="dv">1</span>]</span>
<span id="cb64-10"><a href="régression-multiple.html#cb64-10"></a><span class="co"># Estimation des valeurs de p</span></span>
<span id="cb64-11"><a href="régression-multiple.html#cb64-11"></a><span class="kw">summary</span>(lm.quad)<span class="op">$</span>coefficients[, <span class="dv">4</span>]</span>
<span id="cb64-12"><a href="régression-multiple.html#cb64-12"></a><span class="co"># Le R carré ajusté</span></span>
<span id="cb64-13"><a href="régression-multiple.html#cb64-13"></a><span class="kw">summary</span>(lm.quad)<span class="op">$</span>adj.r.squared</span></code></pre></div>
<p>++++</p>
<hr />
<p>La comparaison de modèles du défi 7 a montré que la régression
quadratique (i.e. polynomiale de degré 2) était le meilleur modèle. Le
polynôme de degré trois peut être retiré du modèle final :</p>
<pre><code>Analysis of Variance Table
Model 1: abund ~ clDD
Model 2: abund ~ clDD + I(clDD^2)
Model 3: abund ~ clDD + I(clDD^2) + I(clDD^3)
Model     Res.Df      RSS             Df  Sum of Sq        F          Pr(&gt;F)
1         644     365039
2         643     355871      1       9168.3      16.5457         5.34e-05 ***
3         642     355743      1       127.7       0.2304      0.6314</code></pre>
<p>La sortie de R pour le modèle final est :</p>
<pre><code>Call: lm(formula = abund ~ clDD + I(clDD^2), data = Dickcissel)
Residuals:
    Min           1Q          Median          3Q          Max
   -14.057        -12.253     -8.674      1.495       190.129
Coefficients:
              Estimate    Std. Error  t value     Pr(&gt;|t|)
(Intercept)   -1.968e+01      5.954e+00   -3.306      0.001 **
clDD          1.297e-02   2.788e-03       4.651       4.00e-06 ***
I(clDD^2)     -1.246e-06      3.061e-07   -4.070      5.28e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
Residual standard error: 23.53 on 643 degrees of freedom
Multiple R-squared:  0.04018,   Adjusted R-squared:  0.0372
F-statistic: 13.46 on 2 and 643 DF,  p-value: 1.876e-06</code></pre>
<p>Dans cet exemple, le terme linéaire influence plus la variable réponse
que le terme quadratique, car leurs valeurs de p sont 4.00e-06 et
5.28e-05 respectivement. Ces deux termes expliquent 3.72% de la
variabilité de l’abondance (R carré ajusté), ce qui est très peu.</p>
</div>
<div id="régression-pas-à-pas" class="section level3">
<h3><span class="header-section-number">4.0.4</span> 7.4 Régression pas à pas</h3>
<p>Afin d’obtenir un modèle de régression multiple "optimal",
on peut commencer avec un modèle qui inclut toutes les variables
explicatives et retirer les variables non significatives, procédant donc
à une <strong>sélection pas à pas</strong>. Les variables non significatives sont
retirées une à la fois et l’ajustement de chaque modèle successif est
évalué à l’aide de l’AIC <a href="http://fr.wikipedia.org/wiki/Crit%C3%A8re_d%27information_d%27Akaike">(Critère d’information
d’Akaike)</a>,
jusqu’à ce que toutes les variables explicatives soient significatives.
Prenez note qu’une valeur plus basse d’AIC indique un meilleur
ajustement (i.e. le meilleur modèle est celui avec la valeur d’AIC la
plus basse). Dans R, la sélection pas à pas est effectuée à l’aide de
la fonction <code>step()</code> :</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="régression-multiple.html#cb67-1"></a>lm.full &lt;-<span class="st"> </span><span class="kw">lm</span>(abund <span class="op">~</span><span class="st"> </span>. <span class="op">-</span><span class="st"> </span>Present, <span class="dt">data =</span> Dickcissel)</span>
<span id="cb67-2"><a href="régression-multiple.html#cb67-2"></a>lm.step &lt;-<span class="st"> </span><span class="kw">step</span>(lm.full)</span>
<span id="cb67-3"><a href="régression-multiple.html#cb67-3"></a><span class="kw">summary</span>(lm.step)</span></code></pre></div>
<p>Les résultats indiquent que seulement 6 variables sont significatives
parmi les 13 variables de départ :</p>
<pre><code> Call:    lm(formula = abund ~ clDD + clFD + clTmi + clTma + clP + grass,  data = Dickcissel)
 Residuals:
  Min         1Q          Median          3Q          Max
  -30.913     -9.640      -3.070      4.217       172.133
Coefficients:
              Estimate    Std. Error  t value     Pr(&gt;|t|)
(Intercept)   -4.457e+02      3.464e+01   -12.868     &lt; 2e-16 ***
clDD          5.534e-02   8.795e-03       6.292       5.83e-10 ***
clFD          1.090e+00   1.690e-01       6.452       2.19e-10 ***
clTmi         -6.717e+00      7.192e-01   -9.339      &lt; 2e-16 ***
clTma         3.172e+00   1.288e+00       2.463       0.014030 *
clP           1.562e-01   4.707e-02       3.318       0.000959 ***
grass         1.066e+01   4.280e+00       2.490       0.013027 *
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1
Residual standard error: 19.85 on 639 degrees of freedom
Multiple R-squared:  0.3207,    Adjusted R-squared:  0.3144
F-statistic: 50.29 on 6 and 639 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Le modèle explique maintenant 31.44% de la variabilité de l’abondance.
La variable explicative la plus significative est clTmi.<br />
Cependant, certaines des variables explicatives sont corrélées entre
elles et devraient être retirées du modèle final afin de ne pas inclure
de variables qui n’apportent pas d’information nouvelle.</p>
</div>
<div id="allons-plus-loin-partition-de-la-variation" class="section level2">
<h2><span class="header-section-number">4.1</span> Allons plus loin: Partition de la variation</h2>
<p>Afin d’évaluer la contribution relative de deux ou plusieurs
variables explicatives à la variabilité d’une variable réponse, on peut
utiliser la fonction <code>varpart()</code> de la librairie "vegan". Cette
fonction permet de subdiviser la variation expliquée de la réponse
variable entre différents groupes de variables explicatives. Par
exemple, dans le jeu de données Dickcissel, on peut évaluer les
contributions relatives des données climatiques et du paysage de la
manière suivante :</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="régression-multiple.html#cb69-1"></a>part.lm =<span class="st"> </span><span class="kw">varpart</span>(Dickcissel<span class="op">$</span>abund, Dickcissel[, <span class="kw">c</span>(<span class="st">&quot;clDD&quot;</span>, <span class="st">&quot;clFD&quot;</span>,</span>
<span id="cb69-2"><a href="régression-multiple.html#cb69-2"></a>    <span class="st">&quot;clTmi&quot;</span>, <span class="st">&quot;clTma&quot;</span>, <span class="st">&quot;clP&quot;</span>)], Dickcissel[, <span class="kw">c</span>(<span class="st">&quot;broadleaf&quot;</span>, <span class="st">&quot;conif&quot;</span>,</span>
<span id="cb69-3"><a href="régression-multiple.html#cb69-3"></a>    <span class="st">&quot;grass&quot;</span>, <span class="st">&quot;crop&quot;</span>, <span class="st">&quot;urban&quot;</span>, <span class="st">&quot;wetland&quot;</span>)])</span>
<span id="cb69-4"><a href="régression-multiple.html#cb69-4"></a>part.lm</span></code></pre></div>
<p>La sortie de R permet de visualiser la partition de la variation :</p>
<pre><code>Partition of variation in RDA
Call: varpart(Y = Dickcissel$abund, X = Dickcissel[, c(&quot;clDD&quot;, &quot;clFD&quot;, &quot;clTmi&quot;, &quot;clTma&quot;, &quot;clP&quot;)],
Dickcissel[, c(&quot;broadleaf&quot;, &quot;conif&quot;, &quot;grass&quot;, &quot;crop&quot;, &quot;urban&quot;, &quot;wetland&quot;)])
Explanatory tables:
X1:  Dickcissel[, c(&quot;clDD&quot;, &quot;clFD&quot;, &quot;clTmi&quot;, &quot;clTma&quot;, &quot;clP&quot;)]
X2:  Dickcissel[, c(&quot;broadleaf&quot;, &quot;conif&quot;, &quot;grass&quot;, &quot;crop&quot;, &quot;urban&quot;, &quot;wetland&quot;)]
No. of explanatory tables: 2
Total variation (SS): 370770
Variance: 574.84
No. of observations: 646
Partition table:
                     Df       R.squared       Adj.R.squared        Testable
[a+b] = X1           5        0.31414         0.30878              TRUE
[b+c] = X2           6        0.03654         0.02749              TRUE
[a+b+c] = X1+X2      11       0.32378         0.31205              TRUE
Individual fractions
[a] = X1|X2          5                        0.28456              TRUE
[b]                  0                        0.02423              FALSE
[c] = X2|X1          6                        0.00327              TRUE
[d] = Residuals                               0.68795              FALSE
---</code></pre>
<p>Utilisez la fonction <code>rda</code> pour tester si les différentes fractions sont
significatives.</p>
<p>Cette sortie R montre que les deux groupes de variables explicatives
expliquent 31.205% (<span class="math display">\[a+b+c\]</span> = X1+X2) de la variation de l’abondance
de Dickcissel alors que les variables du climat expliquent à elles
seules 28.46% de la variation (<span class="math display">\[a\]</span> = X1|X2) et les variables du
paysage ne contribuent qu’à expliquer 0.33% de la variation de
l’abondance de Dickcissel (<span class="math display">\[c\]</span> = X2|X1). L’interaction entre les
deux groupes de variables expliquent 2.42% (<span class="math display">\[b\]</span>) de la variation.</p>
<p>Pour tester si chaque fraction est significative, il est possible
d’utiliser la RDA partielle et un test par permutation avec les
fonctions <code>rda()</code> et <code>anova()</code> :</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="régression-multiple.html#cb71-1"></a><span class="co"># Variables climatiques</span></span>
<span id="cb71-2"><a href="régression-multiple.html#cb71-2"></a>out<span class="fl">.1</span> =<span class="st"> </span><span class="kw">rda</span>(Dickcissel<span class="op">$</span>abund, Dickcissel[, <span class="kw">c</span>(<span class="st">&quot;clDD&quot;</span>, <span class="st">&quot;clFD&quot;</span>,</span>
<span id="cb71-3"><a href="régression-multiple.html#cb71-3"></a>    <span class="st">&quot;clTmi&quot;</span>, <span class="st">&quot;clTma&quot;</span>, <span class="st">&quot;clP&quot;</span>)], Dickcissel[, <span class="kw">c</span>(<span class="st">&quot;broadleaf&quot;</span>, <span class="st">&quot;conif&quot;</span>,</span>
<span id="cb71-4"><a href="régression-multiple.html#cb71-4"></a>    <span class="st">&quot;grass&quot;</span>, <span class="st">&quot;crop&quot;</span>, <span class="st">&quot;urban&quot;</span>, <span class="st">&quot;wetland&quot;</span>)])</span>
<span id="cb71-5"><a href="régression-multiple.html#cb71-5"></a><span class="kw">anova</span>(out<span class="fl">.1</span>, <span class="dt">step =</span> <span class="dv">1000</span>, <span class="dt">perm.max =</span> <span class="dv">1000</span>)</span>
<span id="cb71-6"><a href="régression-multiple.html#cb71-6"></a></span>
<span id="cb71-7"><a href="régression-multiple.html#cb71-7"></a><span class="co"># Variables du paysage</span></span>
<span id="cb71-8"><a href="régression-multiple.html#cb71-8"></a>out<span class="fl">.2</span> =<span class="st"> </span><span class="kw">rda</span>(Dickcissel<span class="op">$</span>abund, Dickcissel[, <span class="kw">c</span>(<span class="st">&quot;broadleaf&quot;</span>, <span class="st">&quot;conif&quot;</span>,</span>
<span id="cb71-9"><a href="régression-multiple.html#cb71-9"></a>    <span class="st">&quot;grass&quot;</span>, <span class="st">&quot;crop&quot;</span>, <span class="st">&quot;urban&quot;</span>, <span class="st">&quot;wetland&quot;</span>)], Dickcissel[, <span class="kw">c</span>(<span class="st">&quot;clDD&quot;</span>,</span>
<span id="cb71-10"><a href="régression-multiple.html#cb71-10"></a>    <span class="st">&quot;clFD&quot;</span>, <span class="st">&quot;clTmi&quot;</span>, <span class="st">&quot;clTma&quot;</span>, <span class="st">&quot;clP&quot;</span>)])</span>
<span id="cb71-11"><a href="régression-multiple.html#cb71-11"></a><span class="kw">anova</span>(out<span class="fl">.2</span>, <span class="dt">step =</span> <span class="dv">1000</span>, <span class="dt">perm.max =</span> <span class="dv">1000</span>)</span></code></pre></div>
<p>la sortie R :</p>
<pre><code>Variables climatiques
Permutation test for rda under reduced model
Model: rda(X = Dickcissel$abund, Y = Dickcissel[, c(&quot;clDD&quot;, &quot;clFD&quot;, &quot;clTmi&quot;, &quot;clTma&quot;, &quot;clP&quot;)],
       Z = Dickcissel[, c(&quot;broadleaf&quot;, &quot;conif&quot;, &quot;grass&quot;, &quot;crop&quot;, &quot;urban&quot;, &quot;wetland&quot;)])
          Df      Var      F     N.Perm   Pr(&gt;F)
Model         5   165.12   53.862    999      0.001 ***
Residual  634     388.72

Variables du paysage
Permutation test for rda under reduced model
Model: rda(X = Dickcissel$abund, Y=Dickcissel[, c(&quot;broadleaf&quot;, &quot;conif&quot;, &quot;grass&quot;, &quot;crop&quot;, &quot;urban&quot;, &quot;wetland&quot;)],
        Z = Dickcissel[, c(&quot;clDD&quot;, &quot;clFD&quot;, &quot;clTmi&quot;, &quot;clTma&quot;, &quot;clP&quot;)])
          Df      Var      F     N.Perm   Pr(&gt;F)
Model         6       5.54     1.5063    999      0.152
Residual  634     388.72</code></pre>
<p>Dans ce cas, la fraction de la variation expliquée par les variables du
climat est significative (p-value=0.001) alors que la fraction expliquée
par les variables du paysage ne l’est pas (p-value=0.152).</p>
<p>Les résultats du partitionnement de la variation sont généralement
représentés graphiquement par un diagramme de Venn dans lequel chaque
groupe de variables explicatives est représenté par un cercle. La
fraction de la variation expliquée est indiquée à l’intérieur des
cercles.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="régression-multiple.html#cb73-1"></a><span class="kw">showvarparts</span>(<span class="dv">2</span>)</span>
<span id="cb73-2"><a href="régression-multiple.html#cb73-2"></a><span class="kw">plot</span>(part.lm, <span class="dt">digits =</span> <span class="dv">2</span>, <span class="dt">bg =</span> <span class="kw">rgb</span>(<span class="dv">48</span>, <span class="dv">225</span>, <span class="dv">210</span>, <span class="dv">80</span>, <span class="dt">maxColorValue =</span> <span class="dv">225</span>),</span>
<span id="cb73-3"><a href="régression-multiple.html#cb73-3"></a>    <span class="dt">col =</span> <span class="st">&quot;turquoise4&quot;</span>)</span></code></pre></div>
<p><img src="images//varpart.png" width="300" /></p>

</div>
</div>



ANOVA et des ANCOVA sur vos propres données. Cependant, rappelez-vous de
toujours spécifier vos modèles correctement et de vérifier leurs
conditions de base avant d’interpréter les résultats en fonction des
caractéristiques écologiques de vos données.</p>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="test-de-t-et-anova.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="résumé.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
