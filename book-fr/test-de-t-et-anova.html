<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 5 Test de t et ANOVA | Atelier 4: Modèles linéaires</title>
  <meta name="description" content="Modèles linéaires" />
  <meta name="generator" content="bookdown 0.33 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 5 Test de t et ANOVA | Atelier 4: Modèles linéaires" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="https://github.com/qcbsRworkshops//assets/images/logo/csbq_logo_accueil.png" />
  <meta property="og:description" content="Modèles linéaires" />
  <meta name="github-repo" content="qcbsRworkshops/workshop04" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 5 Test de t et ANOVA | Atelier 4: Modèles linéaires" />
  
  <meta name="twitter:description" content="Modèles linéaires" />
  <meta name="twitter:image" content="https://github.com/qcbsRworkshops//assets/images/logo/csbq_logo_accueil.png" />

<meta name="author" content="Développé et entretenu par les contributeurs et les contributrices de la Série d’ateliers R du CSBQ." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="assets/images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="régression-linéaire-avec-r.html"/>
<link rel="next" href="régression-multiple.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="assets/qcbs-style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="assets/images/csbq_logo_gray_accueil.png"></a></li>
<link rel="icon" type="image/png" href="assets/images/favicon.ico"/>

<li class="divider"></li>
<li class="part"><span><b>Série d’ateliers R du CSBQ</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Préface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#code-de-conduite"><i class="fa fa-check"></i><b>0.1</b> Code de conduite</a>
<ul>
<li class="chapter" data-level="0.1.1" data-path="index.html"><a href="index.html#comportement-attendu"><i class="fa fa-check"></i><b>0.1.1</b> Comportement attendu</a></li>
<li class="chapter" data-level="0.1.2" data-path="index.html"><a href="index.html#comportements-inacceptables"><i class="fa fa-check"></i><b>0.1.2</b> Comportements inacceptables</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#contributeurs-et-contributrices"><i class="fa fa-check"></i><b>0.2</b> Contributeurs et contributrices</a></li>
<li class="chapter" data-level="0.3" data-path="index.html"><a href="index.html#contribuez-à-la-série"><i class="fa fa-check"></i><b>0.3</b> Contribuez à la série!</a></li>
</ul></li>
<li class="part"><span><b>Modèles linéaires en <code>R</code></b></span></li>
<li class="chapter" data-level="1" data-path="objectifs-dapprentissage.html"><a href="objectifs-dapprentissage.html"><i class="fa fa-check"></i><b>1</b> Objectifs d’apprentissage</a></li>
<li class="chapter" data-level="2" data-path="préparez-vous-pour-cet-atelier.html"><a href="préparez-vous-pour-cet-atelier.html"><i class="fa fa-check"></i><b>2</b> Préparez-vous pour cet atelier</a></li>
<li class="chapter" data-level="3" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html"><i class="fa fa-check"></i><b>3</b> Le modèle linéaire</a>
<ul>
<li class="chapter" data-level="3.1" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#quest-ce-quun-modèle-linéaire"><i class="fa fa-check"></i><b>3.1</b> Qu’est-ce qu’un modèle linéaire ?</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#exemple-abondance-et-masse-des-espèces-doiseaux"><i class="fa fa-check"></i><b>3.1.1</b> Exemple : Abondance et masse des espèces d’oiseaux</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#formulation-dun-modèle-linéaire"><i class="fa fa-check"></i><b>3.2</b> Formulation d’un modèle linéaire</a></li>
<li class="chapter" data-level="3.3" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#évaluation-du-modèle-linéaire"><i class="fa fa-check"></i><b>3.3</b> Évaluation du modèle linéaire</a></li>
<li class="chapter" data-level="3.4" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#conditions-dapplication-du-modèle-linéaire"><i class="fa fa-check"></i><b>3.4</b> Conditions d’application du modèle linéaire</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#normalité-des-résidus"><i class="fa fa-check"></i><b>3.4.1</b> Normalité des résidus</a></li>
<li class="chapter" data-level="3.4.2" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#homoscédasticité"><i class="fa fa-check"></i><b>3.4.2</b> Homoscédasticité</a></li>
<li class="chapter" data-level="3.4.3" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#indépendance-des-résidus"><i class="fa fa-check"></i><b>3.4.3</b> Indépendance des résidus</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#notation-des-modèles-linéaires"><i class="fa fa-check"></i><b>3.5</b> Notation des modèles linéaires</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#notation-mathématique"><i class="fa fa-check"></i><b>3.5.1</b> Notation mathématique</a></li>
<li class="chapter" data-level="3.5.2" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#notation-en-r"><i class="fa fa-check"></i><b>3.5.2</b> Notation en R</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#effectuer-un-modèle-linéaire"><i class="fa fa-check"></i><b>3.6</b> Effectuer un modèle linéaire</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#estimation-du-modèle"><i class="fa fa-check"></i><b>3.6.1</b> Estimation du modèle</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="le-modèle-linéaire.html"><a href="le-modèle-linéaire.html#modèles-linéaires"><i class="fa fa-check"></i><b>3.7</b> Modèles linéaires</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html"><i class="fa fa-check"></i><b>4</b> Régression linéaire avec R</a>
<ul>
<li class="chapter" data-level="4.1" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#formulation-du-modèle"><i class="fa fa-check"></i><b>4.1</b> Formulation du modèle</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#équation-du-modèle"><i class="fa fa-check"></i><b>4.1.1</b> Équation du modèle</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#régression-linéaire-avec-r-1"><i class="fa fa-check"></i><b>4.2</b> Régression linéaire avec R</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#étape-1.-formuler-et-exécuter-un-modèle-linéaire"><i class="fa fa-check"></i><b>4.2.1</b> <strong>Étape 1.</strong> Formuler et exécuter un modèle linéaire</a></li>
<li class="chapter" data-level="4.2.2" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#étape-2.-vérifier-les-conditions-dapplication-avec-les-graphiques-diagnostics"><i class="fa fa-check"></i><b>4.2.2</b> <strong>Étape 2.</strong> Vérifier les conditions d’application avec les graphiques diagnostics</a></li>
<li class="chapter" data-level="4.2.3" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#étape-2.-vérifier-les-conditions-dapplication-pour-lm1"><i class="fa fa-check"></i><b>4.2.3</b> <strong>Étape 2</strong>. Vérifier les conditions d’application pour <code>lm1</code></a></li>
<li class="chapter" data-level="4.2.4" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#conditions-non-respectées---quelle-est-la-cause"><i class="fa fa-check"></i><b>4.2.4</b> Conditions non respectées - Quelle est la cause ?</a></li>
<li class="chapter" data-level="4.2.5" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#conditions-non-respectées---comment-procéder"><i class="fa fa-check"></i><b>4.2.5</b> Conditions non respectées - Comment procéder ?</a></li>
<li class="chapter" data-level="4.2.6" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#étape-3.-analyser-les-paramètres"><i class="fa fa-check"></i><b>4.2.6</b> <strong>Étape 3.</strong> Analyser les paramètres</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#interprétation-du-modèle"><i class="fa fa-check"></i><b>4.3</b> Interprétation du modèle</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#trouver-un-meilleur-modèle-oiseaux-terrestres"><i class="fa fa-check"></i><b>4.3.1</b> Trouver un meilleur modèle: oiseaux terrestres</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#défi-2"><i class="fa fa-check"></i><b>4.4</b> Défi 2</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#solutions"><i class="fa fa-check"></i><b>4.4.1</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#régression-linéaire-avec-r-2"><i class="fa fa-check"></i><b>4.5</b> Régression linéaire avec R</a></li>
<li class="chapter" data-level="4.6" data-path="régression-linéaire-avec-r.html"><a href="régression-linéaire-avec-r.html#noms-de-variables"><i class="fa fa-check"></i><b>4.6</b> Noms de variables</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html"><i class="fa fa-check"></i><b>5</b> Test de t et ANOVA</a>
<ul>
<li class="chapter" data-level="5.1" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#anova"><i class="fa fa-check"></i><b>5.1</b> ANOVA</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#types-danova"><i class="fa fa-check"></i><b>5.1.1</b> Types d’ANOVA</a></li>
<li class="chapter" data-level="5.1.2" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#test-de-t"><i class="fa fa-check"></i><b>5.1.2</b> Test de t</a></li>
<li class="chapter" data-level="5.1.3" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#effectuer-une-anova"><i class="fa fa-check"></i><b>5.1.3</b> Effectuer une ANOVA</a></li>
<li class="chapter" data-level="5.1.4" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#vérification-des-conditions-dapplication"><i class="fa fa-check"></i><b>5.1.4</b> Vérification des conditions d’application</a></li>
<li class="chapter" data-level="5.1.5" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#exemple-avec-le-jeu-de-données-bird"><i class="fa fa-check"></i><b>5.1.5</b> Exemple avec le jeu de données <code>bird</code></a></li>
<li class="chapter" data-level="5.1.6" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#sortie-du-modèle"><i class="fa fa-check"></i><b>5.1.6</b> Sortie du modèle</a></li>
<li class="chapter" data-level="5.1.7" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#tests-complémentaires"><i class="fa fa-check"></i><b>5.1.7</b> Tests complémentaires</a></li>
<li class="chapter" data-level="5.1.8" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#visualisation-des-résultats"><i class="fa fa-check"></i><b>5.1.8</b> Visualisation des résultats</a></li>
<li class="chapter" data-level="5.1.9" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#allons-plus-loin-contrastes"><i class="fa fa-check"></i><b>5.1.9</b> Allons plus loin: Contrastes</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#anova-à-deux-critères-de-classification"><i class="fa fa-check"></i><b>5.2</b> ANOVA à deux critères de classification</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#effectuer-une-anova-à-deux-critères-de-classification"><i class="fa fa-check"></i><b>5.2.1</b> Effectuer une ANOVA à deux critères de classification</a></li>
<li class="chapter" data-level="5.2.2" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#diagramme-dinteraction"><i class="fa fa-check"></i><b>5.2.2</b> Diagramme d’interaction</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#anova-non-équilibrée-section-avancéefacultative"><i class="fa fa-check"></i><b>5.3</b> ANOVA non-équilibrée (section avancée/facultative)</a></li>
<li class="chapter" data-level="5.4" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#ancova"><i class="fa fa-check"></i><b>5.4</b> 6. ANCOVA</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#conditions-de-base-1"><i class="fa fa-check"></i><b>5.4.1</b> 6.1 Conditions de base</a></li>
<li class="chapter" data-level="5.4.2" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#types-dancova"><i class="fa fa-check"></i><b>5.4.2</b> 6.2 Types d’ANCOVA</a></li>
<li class="chapter" data-level="5.4.3" data-path="test-de-t-et-anova.html"><a href="test-de-t-et-anova.html#effectuer-une-ancova"><i class="fa fa-check"></i><b>5.4.3</b> 6.3 Effectuer une ANCOVA</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="régression-multiple.html"><a href="régression-multiple.html"><i class="fa fa-check"></i><b>6</b> Régression multiple</a>
<ul>
<li class="chapter" data-level="6.0.1" data-path="régression-multiple.html"><a href="régression-multiple.html#formulation-du-modèle-1"><i class="fa fa-check"></i><b>6.0.1</b> Formulation du modèle</a></li>
<li class="chapter" data-level="6.1" data-path="régression-multiple.html"><a href="régression-multiple.html#conditions-dapplication"><i class="fa fa-check"></i><b>6.1</b> Conditions d’application</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="régression-multiple.html"><a href="régression-multiple.html#en-cas-de-colinéarité"><i class="fa fa-check"></i><b>6.1.1</b> En cas de colinéarité</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="régression-multiple.html"><a href="régression-multiple.html#régression-linéaire-multiple-dans-r"><i class="fa fa-check"></i><b>6.2</b> Régression linéaire multiple dans R</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="régression-multiple.html"><a href="régression-multiple.html#les-données"><i class="fa fa-check"></i><b>6.2.1</b> Les données</a></li>
<li class="chapter" data-level="6.2.2" data-path="régression-multiple.html"><a href="régression-multiple.html#vérification-des-conditions-dapplication-1"><i class="fa fa-check"></i><b>6.2.2</b> Vérification des conditions d’application</a></li>
<li class="chapter" data-level="6.2.3" data-path="régression-multiple.html"><a href="régression-multiple.html#régression-linéaire"><i class="fa fa-check"></i><b>6.2.3</b> Régression linéaire</a></li>
<li class="chapter" data-level="6.2.4" data-path="régression-multiple.html"><a href="régression-multiple.html#définir-le-meilleur-modèle"><i class="fa fa-check"></i><b>6.2.4</b> Définir le meilleur modèle</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="régression-multiple.html"><a href="régression-multiple.html#régression-polynomiale-matériel-facultatif"><i class="fa fa-check"></i><b>6.3</b> Régression polynomiale (matériel facultatif)</a></li>
<li class="chapter" data-level="6.4" data-path="régression-multiple.html"><a href="régression-multiple.html#partitionnement-de-la-variation-matériel-facultatif"><i class="fa fa-check"></i><b>6.4</b> Partitionnement de la variation (matériel facultatif)</a></li>
</ul></li>
<li class="part"><span><b>Considérations finales</b></span></li>
<li class="chapter" data-level="7" data-path="résumé.html"><a href="résumé.html"><i class="fa fa-check"></i><b>7</b> Résumé</a></li>
<li class="chapter" data-level="8" data-path="ressources-additionnelles.html"><a href="ressources-additionnelles.html"><i class="fa fa-check"></i><b>8</b> Ressources additionnelles</a></li>
<li class="chapter" data-level="9" data-path="réferences.html"><a href="réferences.html"><i class="fa fa-check"></i><b>9</b> Réferences</a></li>
<li class="divider"></li>
<li><a href="https://github.com/qcbsRworkshops" target="blank">QCBS R Workshop Series</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Atelier 4: Modèles linéaires</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!------------------------ Hero Image Container --------------------------> 

<head>
  <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=10.0,initial-scale=1.0">
  <script src="https://kit.fontawesome.com/6a26f47516.js"></script>
  <script src="assets/qcbs-hideOutput.js"></script>
  <link href="assets/qcbs-style.css" rel="stylesheet">
</head>


<!-- 
<div class="hero-image-container"> 
  <img class= "hero-image" src="assets/images/jean-philippe-delberghe-75xPHEQBmvA-unsplash_hero_image.jpg">
</div>
--!>
<div id="test-de-t-et-anova" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapitre 5</span> Test de t et ANOVA<a href="test-de-t-et-anova.html#test-de-t-et-anova" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><img src="images/schema_ttest.png" /></p>
<div id="anova" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> ANOVA<a href="test-de-t-et-anova.html#anova" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>L’analyse de la variance (ANOVA) est un type de modèle linéaire pour
<strong>une variable réponse continue</strong>, et <strong>une ou plusieurs variables
explicatives catégoriques</strong>. Les variables explicatives catégoriques
peuvent comprendre plusieurs niveaux (ou groupes). Par exemple, une
variable "couleur" peut avoir 3 niveaux: vert, bleu, et jaune.
L’ANOVA teste si la moyenne de la variable réponse diffère entre ces
niveaux ou groupes en comparant la variation intra-groupe et inter-groupe.
Par exemple, si la masse des bleuets diffère selon leur couleur.</p>
<p>Le calcul de l’ANOVA se base sur la partition de la somme des carrés,
et compare la <strong>variance entre les groupes</strong> à celle à l’intérieur
des groupes (i.e. la <strong>variance intra-groupe</strong>). Si la variance
entre les groupes est supérieure à la variance intra-groupe, la
variable explicative a un effet plus important que l’erreur aléatoire
(due à la variance intra-groupe). La variable explicative est donc
susceptible d’influencer significativement la variable réponse.</p>
<p><img src="book-fr_files/figure-html/unnamed-chunk-46-1.png" width="624" /></p>
<p>Dans un ANOVA, la comparaison de la variance entre les groupes à
celle intra-groupe se fait en calculant la <strong>statistique F</strong>. Cette
statistique correspond au ratio entre la moyenne des carrés des
groups (MS<sub>Trt</sub>) et la moyenne des carrés des erreurs (MS<sub><span class="math inline">\(\epsilon\)</span></sub>). Ces
deux termes sont obtenus en divisant leurs sommes des carrés respectives
par leurs degrés de liberté, comme on le voit présenté typiquement dans
un tableau d’ANOVA. Une valeur de <strong>p</strong> peut ensuite être calculée à
partir de la statistique de F, qui suit une distribution de khi carré (χ<sup>2</sup>)</p>
<table style="width:99%;">
<colgroup>
<col width="5%" />
<col width="8%" />
<col width="27%" />
<col width="24%" />
<col width="17%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Source de<br />
variation</th>
<th align="left">Degrés de<br />
liberté (df)</th>
<th align="left">Somme des carrés<br />
des écarts à la moyenne</th>
<th align="left">Moyenne des carrés</th>
<th align="left">Statistique de F</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Total</td>
<td align="left"><span class="math inline">\(ra-1\)</span></td>
<td align="left"><span class="math inline">\(SS_{t}=\sum(y_{i}-\overline{y})^{2}\)</span></td>
<td align="left"></td>
<td align="left"></td>
<td></td>
</tr>
<tr class="even">
<td align="left">Facteur A</td>
<td align="left"><span class="math inline">\(a-1\)</span></td>
<td align="left"><span class="math inline">\(SS_{f}=\sum(\hat{y_{i}}-\overline{y})^{2}\)</span></td>
<td align="left"><span class="math inline">\(MS_{f}=\frac{SS_{f}}{(a-1)}\)</span></td>
<td align="left"><span class="math inline">\(F=\frac{MS_{f}} {MS_{E}}\)</span></td>
<td></td>
</tr>
<tr class="odd">
<td align="left">Résidus</td>
<td align="left"><span class="math inline">\(a(r-1)\)</span></td>
<td align="left"><span class="math inline">\(SS_{\epsilon}=\sum(y_{i}-\hat{y_{i}})^{2}\)</span></td>
<td align="left"><span class="math inline">\(MS_{\epsilon}=\frac{SS_{\epsilon}}{a(r-1)}\)</span></td>
<td align="left"></td>
<td></td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(a\)</span>: nombre de niveaux de la variable explicative A</p>
<p><span class="math inline">\(r\)</span>: nombre de répétitions par groupe</p>
<p><span class="math inline">\(\overline{y}\)</span>: moyenne globale de la variable réponse</p>
<p><span class="math inline">\(\hat{y_{i}}\)</span> : moyenne de la variable réponse du groupe i.</p>
<div id="types-danova" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Types d’ANOVA<a href="test-de-t-et-anova.html#types-danova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><strong>ANOVA à un critère de classification</strong><br />
Une variable explicative catégorique avec au moins 2 niveaux. S’il
n’y a que 2 niveaux, un <a href="test-de-t-et-anova.html#test-de-t">test de t</a> peut être utilisé.</li>
<li><strong>ANOVA à deux critères de classification</strong> <a href="test-de-t-et-anova.html#effectuer-une-anova">section 4.1.3</a><br />

<ul>
<li>Deux variables explicatives catégoriques ou plus,<br />
</li>
<li>Chaque facteur peut avoir plusieurs niveaux,<br />
</li>
<li>Les interactions entre chaque variable explicative catégorique
doivent être testées.</li>
</ul></li>
<li><strong>Mesures répétées</strong><br />
L’ANOVA peut être utilisée pour des mesures répétées, mais ce sujet
n’est pas abordé dans cet atelier. Un <strong>modèle linéaire mixte</strong>
peut également être utilisé pour ce type de données <a href="https://r.qcbs.ca/fr/workshops/r-workshop-06/">(voir
l’atelier 6)</a>.</li>
</ol>
</div>
<div id="test-de-t" class="section level3 hasAnchor" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Test de t<a href="test-de-t-et-anova.html#test-de-t" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Si on a une variable explicative est qualitative et n’a que <strong>2 niveaux</strong>, on peut
utiliser un test de <em>t de Student</em> pour déterminer s’il y a une
différence entre la moyenne des 2 niveaux. Selon les données, on peut
choisir de tester une <strong>hypothèse unilatérale</strong>: c’est-à-dire qu’on
peut déterminer si la moyenne d’un groupe est plus grande que celle de
l’autre groupe, plutôt que de seulement détecter une différence entre
les moyennes du groupe.Noter que le test est plus robuste lorsque la taille de l’échantillon est plus élevée et lorsque les groupes ont des tailles égales.</p>
<p>Pour le test de t, la statistique t qui est utilisée pour déterminer la
valeur de p est calculée de la manière suivante :<br />
<span class="math inline">\(t = (\overline{y_{1}}-\overline{y_{1}})/\sqrt{\frac{s_{1}^2} n_{1} + \frac{s_{2}^2} n_{2}}\)</span></p>
<p>où</p>
<p><span class="math inline">\(\overline{y_{1}}\)</span> and <span class="math inline">\(\overline{y_{2}}\)</span> sont les moyennes
de la variable réponse y pour les groupes 1 et 2 respectivement,<br />
<span class="math inline">\(s_{1}^2\)</span> et <span class="math inline">\(s_{2}^2\)</span> sont les variances de la variable réponse y pour les
groupes 1 et 2 respectivement,<br />
<span class="math inline">\(n_{1}\)</span> et <span class="math inline">\(n_{2}\)</span> sont les tailles d’échantillons des groupes 1 et 2
respectivement.</p>
<p>Notez que le test de t est mathématiquement équivalent à une ANOVA à un
critère de classification ayant deux niveaux.<br />
</p>
<div id="conditions-de-base" class="section level4 hasAnchor" number="5.1.2.1">
<h4><span class="header-section-number">5.1.2.1</span> Conditions de base<a href="test-de-t-et-anova.html#conditions-de-base" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Si les conditions de base du test de t ne sont pas respectées, les
résultats du test peuvent être erronés. Voici quelques notes à propos de
la validation de ces conditions de base:</p>
<ol style="list-style-type: decimal">
<li><strong>Normalité des données</strong><br />
Comme pour la régression linéaire simple, la variable réponse doit
être distribuée normalement. Si cette condition n’est pas
respectée, mais que la distribution est relativement symétrique, que
la moyenne est près du centre de la distribution, et que la
distribution est unimodale, le test de t donnera un résultat valable
en autant que la taille de l’échantillon soit suffisante (règle
empirique : ~30 observations). Si les données sont fortement
asymétriques, il est nécessaire d’avoir un très large échantillon
pour que le test fonctionne. Dans ce cas-là, il est préférable
d’utiliser un test non-paramétrique.</li>
<li><strong>Homoscédasticité</strong><br />
Une autre supposition importante du test de t est que les variances
des deux groupes sont égales. Ceci permet de calculer une variance
combinée qui est utilisée pour calculer l’erreur type de la
différence des moyennes. Si les variances des deux groupes sont
inégales, la probabilité de commettre une erreur de type I (i.e.
rejeter l’hypothèse nulle alors qu’elle est vraie) est supérieure
au seuil α.<br />
La robustesse du test de t augmente avec la taille de l’échantillon
et est supérieure lorsque les groupes sont de même taille.<br />
Il est possible d’évaluer la différence de variance entre deux
échantillons en se demandant quelle est la probabilité de tirer deux
échantillons d’une population avec des variances identiques alors
que les échantillons ont des variances de <span class="math inline">\(s_{1}^2\)</span> et <span class="math inline">\(s_{2}^2\)</span>.<br />
Pour ce faire, il faut effectuer un test de ratio des variances
(i.e. un test de F).</li>
</ol>
</div>
<div id="non-respect-des-conditions-dapplication" class="section level4 hasAnchor" number="5.1.2.2">
<h4><span class="header-section-number">5.1.2.2</span> Non-respect des conditions d’application<a href="test-de-t-et-anova.html#non-respect-des-conditions-dapplication" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Si les variances entre les groupes ne sont pas égales, il est possible
de corriger la situation avec la <a href="http://fr.wikipedia.org/wiki/Test_t_de_Welch">correction de
Welch</a>. Si les conditions
de base ne sont toujours pas respectées, il est possible de transformer les données (avec un log ou une racine carré par exemple) ou utiliser l’équivalent non-paramétrique du test de t : <a href="http://en.wikipedia.org/wiki/Mann–Whitney_U_test">le test de
Mann-Whitney</a>.
Finalement, si les deux groupes ne sont pas indépendants (e.g. mesures
prises sur un même individu à deux périodes différentes), il faut
utiliser un <a href="http://en.wikipedia.org/wiki/Student&#39;s_t-test#Paired_samples">test de t
apparié</a>.</p>
</div>
<div id="effectuer-un-test-de-t" class="section level4 hasAnchor" number="5.1.2.3">
<h4><span class="header-section-number">5.1.2.3</span> Effectuer un test de t<a href="test-de-t-et-anova.html#effectuer-un-test-de-t" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Dans R, le test de t est exécutés avec la fonction <code>t.test</code>.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="test-de-t-et-anova.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(Y <span class="sc">~</span> X2, <span class="at">data =</span> data, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span></code></pre></div>
<p>où:<br />
-<code>Y</code> est la variable réponse<br />
-<code>X2</code> est la variable quantitative à deux niveaux<br />
-<code>data</code> est le nom du jeux de données<br />
-<code>alternative</code> réfère à l’hypothèse alternative. <code>'two.sided'</code> est le paramètre par défault. Vous pouvez aussi choisir <code>'less'</code> ou <code>'greater'</code>. Pour plus de détails, voir la <a href="test-de-t-et-anova.html#test-de-t-unilatéral">section</a> suivante.<br />
-<code>var.eqal</code>, if true, this increases the robustness of the test. But we need to test for it prior to testing.<br />
</p>
<p>Regardons un exemple avec des données de régime alimentaire sur des oiseaux
Par exemple, nous pouvons tester la différence de masse entre les oiseaux aquatiques et les oiseaux terrestres avec la variable <code>Aquatic</code>.
Commençons par visualizer les données:<br />
<img src="book-fr_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<p>Il semble avoir une différence simplement en regardant le graphique.<br />
Il faut maintenant tester les conditions d’application pour s’assurer que le test sera valide.
<strong>Note</strong>: Nous n’avons pas besoin de tester la normalité puisque nous avons transfomé en log plus tôt.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="test-de-t-et-anova.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Homogénéité de la variance</span></span>
<span id="cb56-2"><a href="test-de-t-et-anova.html#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var.test</span>(logMass <span class="sc">~</span> Aquatic, <span class="at">data =</span> bird)</span></code></pre></div>
<pre><code>## 
##  F test to compare two variances
## 
## data:  logMass by Aquatic
## F = 1.0725, num df = 38, denom df = 14, p-value = 0.9305
## alternative hypothesis: true ratio of variances is not equal to 1
## 95 percent confidence interval:
##  0.3996428 2.3941032
## sample estimates:
## ratio of variances 
##           1.072452</code></pre>
<p>Ici, on voit que le test de ratio des variances n’est pas statistiquement différent de 1, ce qui signifie que les variances entre les groupes sont égales.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="test-de-t-et-anova.html#cb58-1" aria-hidden="true" tabindex="-1"></a>ttest1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(<span class="at">x =</span> bird<span class="sc">$</span>logMass[bird<span class="sc">$</span>Aquatic <span class="sc">==</span> <span class="dv">0</span>], <span class="at">y =</span> bird<span class="sc">$</span>logMass[bird<span class="sc">$</span>Aquatic <span class="sc">==</span></span>
<span id="cb58-2"><a href="test-de-t-et-anova.html#cb58-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>], <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb58-3"><a href="test-de-t-et-anova.html#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="test-de-t-et-anova.html#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ou l&#39;équivalent</span></span>
<span id="cb58-5"><a href="test-de-t-et-anova.html#cb58-5" aria-hidden="true" tabindex="-1"></a>ttest1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(logMass <span class="sc">~</span> Aquatic, <span class="at">var.equal =</span> <span class="cn">TRUE</span>, <span class="at">data =</span> bird)</span>
<span id="cb58-6"><a href="test-de-t-et-anova.html#cb58-6" aria-hidden="true" tabindex="-1"></a>ttest1</span></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  logMass by Aquatic
## t = -7.7707, df = 52, p-value = 2.936e-10
## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
## 95 percent confidence interval:
##  -3.838340 -2.262829
## sample estimates:
## mean in group 0 mean in group 1 
##        3.645998        6.696582</code></pre>
<p>Étant donné que notre valeur de <em>p</em> est inférieure à 0.05, l’hypothèse nulle (i.e. l’absence de différence de masse entre les deux groupes) est rejetée.</p>
</div>
<div id="effectuer-un-test-de-t-avec-lm" class="section level4 hasAnchor" number="5.1.2.4">
<h4><span class="header-section-number">5.1.2.4</span> Effectuer un test de t avec lm()<a href="test-de-t-et-anova.html#effectuer-un-test-de-t-avec-lm" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Le test de t est un modèle linéaire et un cas spécifique de l’ANOVA avec un facteur à 2 niveaux.
Vous pouvez donc arriver aux mêmes résultats avec:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="test-de-t-et-anova.html#cb60-1" aria-hidden="true" tabindex="-1"></a>lm.t <span class="ot">&lt;-</span> <span class="fu">lm</span>(logMass <span class="sc">~</span> Aquatic, <span class="at">data =</span> bird)</span>
<span id="cb60-2"><a href="test-de-t-et-anova.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm.t)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: logMass
##           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## Aquatic    1 100.816  100.82  60.385 2.936e-10 ***
## Residuals 52  86.817    1.67                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Quand les variances sont équivalents, on peut montrer que t<sup>2</sup> = F:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="test-de-t-et-anova.html#cb62-1" aria-hidden="true" tabindex="-1"></a>ttest1<span class="sc">$</span>statistic<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<pre><code>##       t 
## 60.3845</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="test-de-t-et-anova.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm.t)<span class="sc">$</span>F</span></code></pre></div>
<pre><code>## [1] 60.3845      NA</code></pre>
</div>
<div id="test-de-t-unilatéral" class="section level4 hasAnchor" number="5.1.2.5">
<h4><span class="header-section-number">5.1.2.5</span> Test de t unilatéral<a href="test-de-t-et-anova.html#test-de-t-unilatéral" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>L’argument <em>"alternative"</em> de la fonction <code>t.test()</code> permet
d’effectuer un test de t unilatéral, c’est-à-dire dans une seule direction. Par défault, la fonction <code>t.test()</code> utilise <code>'two-sided'</code>, qui permet seulement de tester si les moyennes diffère l’une de l’autre. Si l’on cherche à déterminer si une moyenne est plus élevée que l’autre, nous pouvons utiliser <code>'less'</code> (<span class="math inline">\(\overline{y_{1}}\)</span> &lt; <span class="math inline">\(\overline{y_{2}}\)</span>) ou <code>'greater'</code> (<span class="math inline">\(\overline{y_{1}}\)</span> &gt; <span class="math inline">\(\overline{y_{2}}\)</span>). Par exemple, si on veut tester l’hypothèse que les oiseaux terrestres sont plus légers que les oiseaux aquatiques, on peut écrire la commande de la façon suivante :</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="test-de-t-et-anova.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de t en spécifiant l&#39;argument &#39;alternative&#39;</span></span>
<span id="cb66-2"><a href="test-de-t-et-anova.html#cb66-2" aria-hidden="true" tabindex="-1"></a>uni.ttest1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(logMass <span class="sc">~</span> Aquatic, <span class="at">var.equal =</span> <span class="cn">TRUE</span>, <span class="at">data =</span> bird,</span>
<span id="cb66-3"><a href="test-de-t-et-anova.html#cb66-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>)</span>
<span id="cb66-4"><a href="test-de-t-et-anova.html#cb66-4" aria-hidden="true" tabindex="-1"></a>uni.ttest1</span></code></pre></div>
<p>Dans la sortie R obtenue par <code>uni.ttest1</code>, les résultats du test sont
indiqués à la troisième ligne :</p>
<pre><code>## 
##  Two Sample t-test
## 
## data:  logMass by Aquatic
## t = -7.7707, df = 52, p-value = 1.468e-10
## alternative hypothesis: true difference in means between group 0 and group 1 is less than 0
## 95 percent confidence interval:
##       -Inf -2.393147
## sample estimates:
## mean in group 0 mean in group 1 
##        3.645998        6.696582</code></pre>
<p>Dans ce cas-ci, la statistique du test de t est t = -7.7707 avec df = 52
degrés de liberté, ce qui donne une valeur de p = 1.468e-10. On rejette
donc l’hypothèse nulle. On peut conclure que les oiseaux aquatiques
sont significativement plus lourds que les oiseaux terrestres.</p>
<p>Nous aurions pu tester l’invers: si les oiseaux terrestres sont plus lourds que les oiseaux aquatique. Dece test, nous obtenons une même valeur de t (mais négative) et une valeur de <em>p</em> qui reflète ces résultats. Nous pouvons en conclure que les oiseaux terrestres ne sont pas significativement plus lourds que les oiseaux aquatiques.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="test-de-t-et-anova.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de t en spécifiant l&#39;argument &#39;alternative&#39;</span></span>
<span id="cb68-2"><a href="test-de-t-et-anova.html#cb68-2" aria-hidden="true" tabindex="-1"></a>uni.ttest1 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(logMass <span class="sc">~</span> Aquatic, <span class="at">var.equal =</span> <span class="cn">TRUE</span>, <span class="at">data =</span> bird,</span>
<span id="cb68-3"><a href="test-de-t-et-anova.html#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>)</span>
<span id="cb68-4"><a href="test-de-t-et-anova.html#cb68-4" aria-hidden="true" tabindex="-1"></a>uni.ttest1</span></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  logMass by Aquatic
## t = -7.7707, df = 52, p-value = 1
## alternative hypothesis: true difference in means between group 0 and group 1 is greater than 0
## 95 percent confidence interval:
##  -3.708022       Inf
## sample estimates:
## mean in group 0 mean in group 1 
##        3.645998        6.696582</code></pre>
</div>
</div>
<div id="effectuer-une-anova" class="section level3 hasAnchor" number="5.1.3">
<h3><span class="header-section-number">5.1.3</span> Effectuer une ANOVA<a href="test-de-t-et-anova.html#effectuer-une-anova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Le test de t s’applique seulement quand on a une seule variable
explicative catégorique, qui comprend 2 niveaux. Pour tous les autres
modèles linéaires avec des variables explicatives catégoriques avec &gt; 2 niveaux, on
utilise une ANOVA.</p>
<p>Lorsque l’ANOVA détecte une différence significative entre les groupes, l’analyse n’indique pas quel(s) groupe(s) diffère(nt) de(s) l’autre(s). Un test couramment utilisé <em>a posteriori</em> pour répondre à cette question est le <a href="test-de-t-et-anova.html#tests-complémentaires">test de Tukey</a>. Vous voudrez peut-être comparer vos groupes avec des comparaison planifiées ou <a href="test-de-t-et-anova.html#allons-plus-loin-contrastes">contrastes</a>. Ceci est souvent plus robust et élégant puisque les différences attendues sont établies <em>a priori</em>.</p>
</div>
<div id="vérification-des-conditions-dapplication" class="section level3 hasAnchor" number="5.1.4">
<h3><span class="header-section-number">5.1.4</span> Vérification des conditions d’application<a href="test-de-t-et-anova.html#vérification-des-conditions-dapplication" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Comme la régression linéaire simple et le test de t, l’ANOVA doit
respecter 4 conditions statistiques pour que les résultats soient
valides. Voici quelques conseils pour tester ces conditions pour une
ANOVA:</p>
<ol style="list-style-type: decimal">
<li><strong>Distribution normale</strong><br />
Les résidus d’un modèle d’ANOVA peuvent être visualisés à l’aide
d’un diagramme quantile-quantile (Q-Q). Les résidus sont considérés
comme normalement distribués s’ils se répartissent le long de la
droite 1:1. Si ce n’est pas le cas, les résultats de l’ANOVA ne
peuvent pas être interprétés.</li>
<li><strong>Homoscédasticité</strong><br />
L’ANOVA est valide seulement lorsque la variance des résidus est
homogène entre les groupes. Cette homoscédasticité peut être
vérifiée par un graphique des résidus en fonction des valeurs
prédites ou par un diagramme diagnostic "scale-location". Si ces
graphiques montrent une dispersion équivalente des résidus pour
chaque valeur prédite, la variance des résidus peut être considérée
homogène.<br />
Il est également possible d’effectuer un test de Bartlett à l’aide
de la fonction <code>bartlett.test()</code>. Si la valeur de <em>p</em> de ce test est
supérieure à 0.05, l’hypothèse nulle H<sub>0</sub>: s<sub>1</sub><sup>2</sup> = s<sub>2</sub><sup>2</sup> =...
= s<sub>j</sub><sup>2</sup> =... = s<sub>n</sub><sup>2</sup> est acceptée (i.e. l’homoscédasticité est
respectée).<br />
Une transformation de la variable réponse peut être utilisée si
cette supposition n’est pas respectée.</li>
<li><strong>Additivité</strong><br />
Les effets de deux facteurs sont additifs si l’effet d’un facteur
demeure constant pour tous les niveaux d’un autre facteur. Chaque
facteur doit influencer la variable réponse de manière indépendante
des autres facteurs.</li>
</ol>
<p>Si les conditions ne sont pas respectées, vous pouvez essayer de
transformer la variable réponse. Ceci peut aider à normaliser les
résidus, à égaliser les variances, et à transformer un effet
multiplicatif en effet additif. Si vous ne voulez pas (ou ne pouvez pas)
transformer vos données, vous pouvez utiliser l’équivalent
non-paramétrique de l’ANOVA : le <a href="http://en.wikipedia.org/wiki/Kruskal–Wallis_one-way_analysis_of_variance">test de
Kruskal-Wallis</a>.</p>
</div>
<div id="exemple-avec-le-jeu-de-données-bird" class="section level3 hasAnchor" number="5.1.5">
<h3><span class="header-section-number">5.1.5</span> Exemple avec le jeu de données <code>bird</code><a href="test-de-t-et-anova.html#exemple-avec-le-jeu-de-données-bird" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Commençons tout d’abord par visualiser les données avec la fonction
<code>boxplot()</code>. Rappelez-vous que, dans R, les groupes sont ordonnés par
ordre alphabétique par défaut. Il est possible de réorganiser les
groupes autrement. Par exemple, on peut les ordonner par ordre croissant
de la médiane de chaque diète.<br />
</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="test-de-t-et-anova.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ordre alphabétique par défaut</span></span>
<span id="cb70-2"><a href="test-de-t-et-anova.html#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(logMaxAbund <span class="sc">~</span> Diet, <span class="at">data =</span> bird)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="test-de-t-et-anova.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Réorganiser l&#39;ordre des facteurs</span></span>
<span id="cb71-2"><a href="test-de-t-et-anova.html#cb71-2" aria-hidden="true" tabindex="-1"></a>med <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">tapply</span>(bird<span class="sc">$</span>logMaxAbund, bird<span class="sc">$</span>Diet, median))</span>
<span id="cb71-3"><a href="test-de-t-et-anova.html#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(logMaxAbund <span class="sc">~</span> <span class="fu">factor</span>(Diet, <span class="at">levels =</span> <span class="fu">names</span>(med)), <span class="at">data =</span> bird,</span>
<span id="cb71-4"><a href="test-de-t-et-anova.html#cb71-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;lightblue1&quot;</span>, <span class="st">&quot;skyblue1&quot;</span>, <span class="st">&quot;skyblue3&quot;</span>, <span class="st">&quot;skyblue4&quot;</span>))</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-56-2.png" width="672" /></p>
<p>Une autre façon de visualiser les effets des facteurs est d’utiliser la fonction <code>plot.design()</code>. Cette fonction permet de représenter les valeurs moyennes des niveaux d’un facteur (par une ligne verticale) et
la moyenne globale de la variable réponse (par une ligne horizontale).</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="test-de-t-et-anova.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.design</span>(logMaxAbund <span class="sc">~</span> Diet, <span class="at">data =</span> bird, <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="sc">*</span></span>
<span id="cb72-2"><a href="test-de-t-et-anova.html#cb72-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;(Maximum Abundance)&quot;</span>))</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-57-1.png" width="672" /></p>
<p>Par la suite, nous devons vérifier les conditions d’applications.
<strong>Note</strong>: nous devons performer l’ANOVA poour pouvoir utiliser les résidus, cependant, tant que nous ne vérifions pas les conditions d’application, les résultats ne peuvent être interprétés.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="test-de-t-et-anova.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Graphiques pour conditions d&#39;application</span></span>
<span id="cb73-2"><a href="test-de-t-et-anova.html#cb73-2" aria-hidden="true" tabindex="-1"></a>aov1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(logMaxAbund <span class="sc">~</span> Diet, <span class="at">data =</span> bird)</span>
<span id="cb73-3"><a href="test-de-t-et-anova.html#cb73-3" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb73-4"><a href="test-de-t-et-anova.html#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(aov1)</span>
<span id="cb73-5"><a href="test-de-t-et-anova.html#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-59-1.png" width="672" />
Idéalement, le premier graphique devrait montrer une dispersion similaire pour chaque niveau de diète. Nous pouvons utiliser tous ces graphiques pour évaluer les conditions d’application, mais nous pouvons aussi utiliser les test de Shapiro, de Bartlett ou de Levene en supplément. <strong>Note</strong>:Le test de Levene performe mieux, mais a une erreur de Type II un peu plus élevée.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="test-de-t-et-anova.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de la supposition de la normalité des résidus</span></span>
<span id="cb74-2"><a href="test-de-t-et-anova.html#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">resid</span>(aov1))</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  resid(aov1)
## W = 0.97995, p-value = 0.4982</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="test-de-t-et-anova.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test de la supposition de l&#39;homogénéité de la variance</span></span>
<span id="cb76-2"><a href="test-de-t-et-anova.html#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Bartlett</span></span>
<span id="cb76-3"><a href="test-de-t-et-anova.html#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(logMaxAbund <span class="sc">~</span> Diet, <span class="at">data =</span> bird)</span></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  logMaxAbund by Diet
## Bartlett&#39;s K-squared = 7.4728, df = 4, p-value = 0.1129</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="test-de-t-et-anova.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Levene</span></span>
<span id="cb78-2"><a href="test-de-t-et-anova.html#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb78-3"><a href="test-de-t-et-anova.html#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="fu">leveneTest</span>(logMaxAbund <span class="sc">~</span> Diet, <span class="at">data =</span> bird)</span></code></pre></div>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##       Df F value  Pr(&gt;F)  
## group  4  2.3493 0.06717 .
##       49                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Toutefois, les tests ne sont pas significatifs. On peut supposer que les
résidus sont distribués normalement et que les variances sont égales.</p>
<p>Nous sommes maintenant prêts à effectuer une ANOVA. Dans R, la fonction
<code>aov()</code> permet d’effectuer une ANOVA directement. Il est également
possible d’effectuer une ANOVA avec la fonction <code>anova()</code> qui exécute
l’ANOVA comme un modèle linéaire :</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="test-de-t-et-anova.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># En utilisant aov()</span></span>
<span id="cb80-2"><a href="test-de-t-et-anova.html#cb80-2" aria-hidden="true" tabindex="-1"></a>aov1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(logMaxAbund <span class="sc">~</span> Diet, <span class="at">data =</span> bird)</span>
<span id="cb80-3"><a href="test-de-t-et-anova.html#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov1)</span>
<span id="cb80-4"><a href="test-de-t-et-anova.html#cb80-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-5"><a href="test-de-t-et-anova.html#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="co"># En utilisant lm()</span></span>
<span id="cb80-6"><a href="test-de-t-et-anova.html#cb80-6" aria-hidden="true" tabindex="-1"></a>anov1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(logMaxAbund <span class="sc">~</span> Diet, <span class="at">data =</span> bird)</span>
<span id="cb80-7"><a href="test-de-t-et-anova.html#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(anov1)</span></code></pre></div>
</div>
<div id="sortie-du-modèle" class="section level3 hasAnchor" number="5.1.6">
<h3><span class="header-section-number">5.1.6</span> Sortie du modèle<a href="test-de-t-et-anova.html#sortie-du-modèle" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Lorsque le modèle d’ANOVA a été validé et les conditions d’applications rencontrées, on peut interpréter les résultats correctement. La sortie du modèle fournie par R dépend de la
fonction qui a été utilisée pour effectuer l’ANOVA. Si la fonction
<code>aov()</code> a été utilisée :</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="test-de-t-et-anova.html#cb81-1" aria-hidden="true" tabindex="-1"></a>aov1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(logMaxAbund <span class="sc">~</span> Diet, <span class="at">data =</span> bird)</span></code></pre></div>
<p>Les résultats de l’ANOVA peuvent être visualisés avec la fonction
<code>summary()</code> :</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="test-de-t-et-anova.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov1)</span></code></pre></div>
<p>Si la fonction <code>lm()</code> a été utilisée :</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="test-de-t-et-anova.html#cb83-1" aria-hidden="true" tabindex="-1"></a>anov1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(logMaxAbund <span class="sc">~</span> Diet, <span class="at">data =</span> bird)</span></code></pre></div>
<p>les résultats de l’ANOVA peuvent être visualisés avec la fonction
<code>anova()</code> :</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="test-de-t-et-anova.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(anov1)</span></code></pre></div>
<p>Dans les deux cas, la sortie dans R sera la même :</p>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## Diet         4  27.07   6.768   2.836 0.0341 *
## Residuals   49 116.92   2.386                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Cette sortie de R représente le tableau de l’ANOVA. On y retrouve les
degrés de liberté, la somme des carrés, la moyenne de la somme des
carrés, la statistique de F ainsi qu’une valeur de p. Dans l’exemple
de la diète des oiseaux, la diète influence significativement
l’abondance des oiseaux car la valeur de p est inférieure à 0.05.
L’hypothèse nulle est rejetée, ce qui signifie qu’au moins une des
diètes influence l’abondance différemment des autres diètes.</p>
</div>
<div id="tests-complémentaires" class="section level3 hasAnchor" number="5.1.7">
<h3><span class="header-section-number">5.1.7</span> Tests complémentaires<a href="test-de-t-et-anova.html#tests-complémentaires" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Il est impossible d’identifier quel groupe diffère des autres avec
une ANOVA. Elle ne permet que de déterminer s’il existe une différence
entre niveaux. Pour identifier les niveaux qui diffèrent des autres, les
tests post-hoc comparent les combinaisons de variables explicatives
(i.e. les groupes) deux par deux. Il existe plusieurs tests post hoc
(e.g. Fischer’s least significant difference, Duncan’s new multiple
range test, Newman-Keuls method, Dunnett’s test, etc.), mais le test de
Tukey est le plus couramment utilisé. Dans R, on utilise la fonction
<code>TukeyHSD()</code> pour effectuer ce test :</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="test-de-t-et-anova.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># À quel niveau se situe la différence de diète ?</span></span>
<span id="cb86-2"><a href="test-de-t-et-anova.html#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(<span class="fu">aov</span>(anov1), <span class="at">ordered =</span> T)</span>
<span id="cb86-3"><a href="test-de-t-et-anova.html#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="test-de-t-et-anova.html#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Cette commande est équivalente à la précédente :</span></span>
<span id="cb86-5"><a href="test-de-t-et-anova.html#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(aov1, <span class="at">ordered =</span> T)</span></code></pre></div>
<p>La sortie de R inclut un tableau qui liste toutes les combinaisons des
niveaux de la variable explicative et qui identifie quel(s)
groupe(s) diffère(ent) des autres :<br />
</p>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
##     factor levels have been ordered
## 
## Fit: aov(formula = logMaxAbund ~ Diet, data = bird)
## 
## $Diet
##                             diff         lwr      upr     p adj
## Vertebrate-InsectVert  0.7746576 -2.56640638 4.115722 0.9645742
## Insect-InsectVert      1.4815601 -1.76264078 4.725761 0.6965047
## Plant-InsectVert       2.0364840 -2.33799553 6.410964 0.6812494
## PlantInsect-InsectVert 2.4539424 -0.80660217 5.714487 0.2235587
## Insect-Vertebrate      0.7069025 -0.89043156 2.304237 0.7204249
## Plant-Vertebrate       1.2618265 -2.07923748 4.602890 0.8211024
## PlantInsect-Vertebrate 1.6792848  0.04901254 3.309557 0.0405485
## Plant-Insect           0.5549239 -2.68927692 3.799125 0.9884504
## PlantInsect-Insect     0.9723823 -0.44885612 2.393621 0.3117612
## PlantInsect-Plant      0.4174584 -2.84308619 3.678003 0.9961844</code></pre>
<p>Dans ce cas-ci, la seule différence significative d’abondance se
retrouve entre les diètes "PlantInsect" et "Vertebrate".</p>
</div>
<div id="visualisation-des-résultats" class="section level3 hasAnchor" number="5.1.8">
<h3><span class="header-section-number">5.1.8</span> Visualisation des résultats<a href="test-de-t-et-anova.html#visualisation-des-résultats" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Après avoir vérifié les conditions de base, interprété les résultats, et
identifié les niveaux significatifs à l’aide de tests post-hoc ou de
contrastes, les résultats d’une ANOVA peuvent être représentés
graphiquement à l’aide de la fonction <code>barplot()</code>. R produit donc un
graphique de la variable réponse en fonction des niveaux de groupe,
ou les erreurs types et le nom des niveaux du groupe (représentant
le résultat d’un test post hoc) peuvent y être apposées.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="test-de-t-et-anova.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualisation d&#39;un modèle d&#39;ANOVA à l&#39;aide de la fonction</span></span>
<span id="cb88-2"><a href="test-de-t-et-anova.html#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="co"># barplot()</span></span>
<span id="cb88-3"><a href="test-de-t-et-anova.html#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="test-de-t-et-anova.html#cb88-4" aria-hidden="true" tabindex="-1"></a>sd <span class="ot">&lt;-</span> <span class="fu">tapply</span>(bird<span class="sc">$</span>logMaxAbund, <span class="fu">list</span>(bird<span class="sc">$</span>Diet), sd)</span>
<span id="cb88-5"><a href="test-de-t-et-anova.html#cb88-5" aria-hidden="true" tabindex="-1"></a>means <span class="ot">&lt;-</span> <span class="fu">tapply</span>(bird<span class="sc">$</span>logMaxAbund, <span class="fu">list</span>(bird<span class="sc">$</span>Diet), mean)</span>
<span id="cb88-6"><a href="test-de-t-et-anova.html#cb88-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(bird<span class="sc">$</span>logMaxAbund)</span>
<span id="cb88-7"><a href="test-de-t-et-anova.html#cb88-7" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fl">1.96</span> <span class="sc">*</span> sd<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb88-8"><a href="test-de-t-et-anova.html#cb88-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-9"><a href="test-de-t-et-anova.html#cb88-9" aria-hidden="true" tabindex="-1"></a>bp <span class="ot">&lt;-</span> <span class="fu">barplot</span>(means, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;lightblue1&quot;</span>, <span class="st">&quot;skyblue1&quot;</span>,</span>
<span id="cb88-10"><a href="test-de-t-et-anova.html#cb88-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;skyblue3&quot;</span>, <span class="st">&quot;skyblue4&quot;</span>), <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="sc">*</span> <span class="st">&quot;(Maximum Abundance)&quot;</span>),</span>
<span id="cb88-11"><a href="test-de-t-et-anova.html#cb88-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Diet&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>))</span>
<span id="cb88-12"><a href="test-de-t-et-anova.html#cb88-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-13"><a href="test-de-t-et-anova.html#cb88-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-14"><a href="test-de-t-et-anova.html#cb88-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajout des lignes verticales représentant les erreurs</span></span>
<span id="cb88-15"><a href="test-de-t-et-anova.html#cb88-15" aria-hidden="true" tabindex="-1"></a><span class="co"># types</span></span>
<span id="cb88-16"><a href="test-de-t-et-anova.html#cb88-16" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(bp, means <span class="sc">-</span> se, bp, means <span class="sc">+</span> se, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb88-17"><a href="test-de-t-et-anova.html#cb88-17" aria-hidden="true" tabindex="-1"></a><span class="co"># et des lignes horizontales</span></span>
<span id="cb88-18"><a href="test-de-t-et-anova.html#cb88-18" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(bp <span class="sc">-</span> <span class="fl">0.1</span>, means <span class="sc">-</span> se, bp <span class="sc">+</span> <span class="fl">0.1</span>, means <span class="sc">-</span> se, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb88-19"><a href="test-de-t-et-anova.html#cb88-19" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(bp <span class="sc">-</span> <span class="fl">0.1</span>, means <span class="sc">+</span> se, bp <span class="sc">+</span> <span class="fl">0.1</span>, means <span class="sc">+</span> se, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb88-20"><a href="test-de-t-et-anova.html#cb88-20" aria-hidden="true" tabindex="-1"></a><span class="co"># ajout d&#39;une ligne à 0</span></span>
<span id="cb88-21"><a href="test-de-t-et-anova.html#cb88-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
</div>
<div id="allons-plus-loin-contrastes" class="section level3 hasAnchor" number="5.1.9">
<h3><span class="header-section-number">5.1.9</span> Allons plus loin: Contrastes<a href="test-de-t-et-anova.html#allons-plus-loin-contrastes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Les constrastes servent à comparer chaque niveau du facteur à un niveau de référence, et de détecter des différences significatives entre chaque niveau.</p>
<p>Les contrastes sont dbasées sur des hypothèses <em>a priori</em>, ce qui les rend beaucoup plus robustes que les test <em>a posteriori</em> comme le test de Tukey. Avec les contrastes, les groupes peuvent être composés d’un ou plusieurs niveaux d’un facteur et on peut tester une hypothèse simple (e.g. μ<sub>1</sub> = μ<sub>2</sub>) ou des hypothèses plus complexes (e.g. (μ<sub>1</sub> + μ<sub>2</sub>)/3 == μ<sub>3</sub>).</p>
<p><em>Important</em>
Le nombre de comparaisons doit être plus petit ou égal au nombre de
degrés de liberté de l’ANOVA. Ces comparaisons doivent être indépendantes l’une de l’autre.</p>
<p>Pour une ANOVA où la variable prédictrice est catégorique, l’estimation de l’ordonnée à l’origine est le niveau de référence et correspond à la moyenne du premier niveau (en ordre alphabétique) du facteur.En calculant l’ordonnée à l’origine de référence et l’ordonnée à l’origine de chaque niveau de <code>Diet</code>, <em>que remarquez-vous</em>?</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="test-de-t-et-anova.html#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tapply</span>(bird<span class="sc">$</span>logMaxAbund, bird<span class="sc">$</span>Diet, mean)</span></code></pre></div>
<pre><code>##      Insect  InsectVert       Plant PlantInsect  Vertebrate 
##    2.656938    1.175378    3.211862    3.629321    1.950036</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="test-de-t-et-anova.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(anov1)</span></code></pre></div>
<pre><code>##     (Intercept)  DietInsectVert       DietPlant DietPlantInsect  DietVertebrate 
##       2.6569384      -1.4815601       0.5549239       0.9723823      -0.7069025</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="test-de-t-et-anova.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(anov1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(anov1)[<span class="dv">2</span>]  <span class="co"># InsectVert</span></span></code></pre></div>
<pre><code>## (Intercept) 
##    1.175378</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="test-de-t-et-anova.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(anov1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(anov1)[<span class="dv">3</span>]  <span class="co"># Plant</span></span></code></pre></div>
<pre><code>## (Intercept) 
##    3.211862</code></pre>
<p>La moyenne de la variable <code>Insect</code> correspond à l’ordonnée à l’origine de notre de notre ANOVA <code>anov1</code>.</p>
<p>Il est aussi possible d’afficher ces résultats supplémentaires de l’ANOVA
dans R avec la fonction <code>summmary.lm()</code>. Cette sortie
montre les résultats de la régression linéaire pour chaque niveau de la
variable catégorique.</p>
<p><strong>Note</strong>: On peut afficher ces résultats avec la fonction <code>summmary.lm()</code> lorsque l’ANOVA a été effectuée avec la fonction <code>aov()</code> et avec la fonction <code>summary()</code>
lorsque l’ANOVA a été effectuée avec la fonction <code>lm()</code>.</p>
<pre><code>## 
## Call:
## lm(formula = logMaxAbund ~ Diet, data = bird)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.2664 -0.7592 -0.2028  1.0908  3.5938 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       2.6569     0.3454   7.692 5.66e-10 ***
## DietInsectVert   -1.4816     1.1456  -1.293   0.2020    
## DietPlant         0.5549     1.1456   0.484   0.6303    
## DietPlantInsect   0.9724     0.5019   1.938   0.0585 .  
## DietVertebrate   -0.7069     0.5640  -1.253   0.2161    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.545 on 49 degrees of freedom
## Multiple R-squared:  0.188,  Adjusted R-squared:  0.1217 
## F-statistic: 2.836 on 4 and 49 DF,  p-value: 0.0341</code></pre>
<p>La dernière ligne de cette sortie est identique à la sortie précédente
de l’ANOVA. La statistique de F de l’ANOVA et sa valeur de p associée
(2.836 et 0.0341 respectivement) sont les mêmes que celles présentées
dans la table d’ANOVA, ce qui indique que la variabilité de
l’abondance est mieux expliquée par la diète que par un modèle nul; la
diète a donc un effet significatif sur l’abondance. L’ajustement du
modèle (i.e. le R<sup>2</sup> ajusté) apparaît sur l’avant-dernière ligne de la
sortie. Dans ce cas-ci, la diète explique 12.17% de la variabilité de
l’abondance.<br />
Les contrastes sont utilisés pour ajuster une variable réponse en
fonction des différents niveaux d’une variable catégorique. Dans le cas
de l’abondance en fonction de la diète, cinq régressions linéaires
(correspondant aux cinq coefficients dans la sortie de R) sont calculées
par la fonction <code>lm()</code>, car la variable <code>Diet</code> contient cinq niveaux.
Par défaut, le niveau de référence correspond au premier niveau (en
ordre alphabétique) de la variable catégorique. Ce niveau est indiqué
par la ligne <code>intercept</code> dans la sortie de R, soit <code>Insect</code> dans ce
cas-ci.</p>
<p>Ici, le coefficient estimé du niveau de référence est comparé à 0 par un
test de t, alors que les autres coefficients sont comparés à celui du
niveau de référence. Dans ce cas-ci, seule la diète <code>PlantInsect</code> est
différente de la diète <code>Insect</code> (valeur de p = 0.0585).<br />
En d’autres mots, cette sortie de R permet de calculer la moyenne de la
variable réponse pour chaque niveau de diète. Par exemple :</p>
<p>LogMaxAbund = 1.1539 pour la diète <code>Insect</code>,<br />
LogMaxAbund = 1.1539 – 0.6434 pour la diète <code>InsectVert</code>,<br />
LogMaxAbund = 1.1539 + 0.2410 pour la diète <code>Plant</code>,<br />
etc.</p>
<p>Ce type de contrastes compare chaque niveau de la variable explicative à
un niveau de référence. Dans R, ceci correspond à la fonction
<code>contr.treatment()</code> et représentent la méthode par défaut de la fonction
<code>lm()</code>.</p>
<p>Le niveau de référence peut être changé en utilisant la fonction
<code>relevel()</code>. Par exemple,les lignes suivantes comparent chaque diète à la diète <code>Plant</code> maintenant définie comme le niveau de référence.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="test-de-t-et-anova.html#cb98-1" aria-hidden="true" tabindex="-1"></a>bird<span class="sc">$</span>Diet2 <span class="ot">&lt;-</span> <span class="fu">relevel</span>(bird<span class="sc">$</span>Diet, <span class="at">ref =</span> <span class="st">&quot;Plant&quot;</span>)</span>
<span id="cb98-2"><a href="test-de-t-et-anova.html#cb98-2" aria-hidden="true" tabindex="-1"></a>anov2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(logMaxAbund <span class="sc">~</span> Diet2, <span class="at">data =</span> bird)</span>
<span id="cb98-3"><a href="test-de-t-et-anova.html#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anov2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = logMaxAbund ~ Diet2, data = bird)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.2664 -0.7592 -0.2028  1.0908  3.5938 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)        3.2119     1.0923   2.941  0.00499 **
## Diet2Insect       -0.5549     1.1456  -0.484  0.63026   
## Diet2InsectVert   -2.0365     1.5447  -1.318  0.19351   
## Diet2PlantInsect   0.4175     1.1513   0.363  0.71848   
## Diet2Vertebrate   -1.2618     1.1798  -1.070  0.29006   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.545 on 49 degrees of freedom
## Multiple R-squared:  0.188,  Adjusted R-squared:  0.1217 
## F-statistic: 2.836 on 4 and 49 DF,  p-value: 0.0341</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="test-de-t-et-anova.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(anov2)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: logMaxAbund
##           Df  Sum Sq Mean Sq F value Pr(&gt;F)  
## Diet2      4  27.071  6.7677  2.8363 0.0341 *
## Residuals 49 116.918  2.3861                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Il est aussi possible de réordonné les niveaux selon leur médiane, plutôt que par ordre alphabétique:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="test-de-t-et-anova.html#cb102-1" aria-hidden="true" tabindex="-1"></a>med <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">tapply</span>(bird<span class="sc">$</span>logMaxAbund, bird<span class="sc">$</span>Diet, median))</span>
<span id="cb102-2"><a href="test-de-t-et-anova.html#cb102-2" aria-hidden="true" tabindex="-1"></a>bird<span class="sc">$</span>Diet2 <span class="ot">&lt;-</span> <span class="fu">factor</span>(bird<span class="sc">$</span>Diet, <span class="at">levels =</span> <span class="fu">names</span>(med))</span>
<span id="cb102-3"><a href="test-de-t-et-anova.html#cb102-3" aria-hidden="true" tabindex="-1"></a>anov2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(logMaxAbund <span class="sc">~</span> Diet2, <span class="at">data =</span> bird)</span>
<span id="cb102-4"><a href="test-de-t-et-anova.html#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anov2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = logMaxAbund ~ Diet2, data = bird)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.2664 -0.7592 -0.2028  1.0908  3.5938 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)        1.1754     1.0923   1.076   0.2872  
## Diet2Vertebrate    0.7747     1.1798   0.657   0.5145  
## Diet2Insect        1.4816     1.1456   1.293   0.2020  
## Diet2Plant         2.0365     1.5447   1.318   0.1935  
## Diet2PlantInsect   2.4539     1.1513   2.131   0.0381 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.545 on 49 degrees of freedom
## Multiple R-squared:  0.188,  Adjusted R-squared:  0.1217 
## F-statistic: 2.836 on 4 and 49 DF,  p-value: 0.0341</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="test-de-t-et-anova.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(anov2)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: logMaxAbund
##           Df  Sum Sq Mean Sq F value Pr(&gt;F)  
## Diet2      4  27.071  6.7677  2.8363 0.0341 *
## Residuals 49 116.918  2.3861                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>La matrice de coefficients de contrastes peut être affichée par la
commande suivante :</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="test-de-t-et-anova.html#cb106-1" aria-hidden="true" tabindex="-1"></a>bird<span class="sc">$</span>Diet2 <span class="ot">&lt;-</span> <span class="fu">relevel</span>(bird<span class="sc">$</span>Diet, <span class="at">ref =</span> <span class="st">&quot;Plant&quot;</span>)</span>
<span id="cb106-2"><a href="test-de-t-et-anova.html#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(bird<span class="sc">$</span>Diet2)</span></code></pre></div>
<pre><code>##             Insect InsectVert PlantInsect Vertebrate
## Plant            0          0           0          0
## Insect           1          0           0          0
## InsectVert       0          1           0          0
## PlantInsect      0          0           1          0
## Vertebrate       0          0           0          1</code></pre>
<p>où chaque colonne représente une comparaison avec le niveau de référence
<code>Plant</code> et chaque ligne représente un type de diète. Par exemple, la
première comparaison est effectuée entre les diètes <code>Plant</code> et <code>Insect</code>.
La seconde comparaison est effectuée entre <code>Plant</code> et <code>InsectVert</code> etc.</p>
<p>Un point important à remarquer à propos du contraste par défaut dans R <code>contr.treatment</code> est qu’il n’est <strong>PAS</strong> orthogonal, c’est-à-dire que la somme des produits de leurs coefficients n’est <strong>PAS</strong> nulle. Nou pouvons vérifier que les contrastes sont orthogonaux en s’assurant que:
- La somme des coefficients doit être égale à 0
- La somme du produit de deux colonnes égale 0</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="test-de-t-et-anova.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">contrasts</span>(bird<span class="sc">$</span>Diet2)[, <span class="dv">1</span>])  <span class="co"># condition 1 pour colonne 1</span></span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="test-de-t-et-anova.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">contrasts</span>(bird<span class="sc">$</span>Diet2)[, <span class="dv">1</span>] <span class="sc">*</span> <span class="fu">contrasts</span>(bird<span class="sc">$</span>Diet2)[, <span class="dv">2</span>])  <span class="co"># condition 2 pour colonne 1 et 2</span></span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>La première colonne éagle à 1, signifiant que les contrastes ne sont pas orthogonaux.<br />
</p>
<p>L’orthogonalité est importante pour s’assurer que nos contrastes sont <strong>indépendants</strong>. Nous pouvons utiliser des contrastes de Helmert ou des contrastes polynomiaux pour remédier à ce problème. Les contrastes Helmert vont contraster le deuxième niveau avec le premier, le troisième avec la moyenne des deux premiers niveaux, etc.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="test-de-t-et-anova.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">contrasts =</span> <span class="fu">c</span>(<span class="st">&quot;contr.helmert&quot;</span>, <span class="st">&quot;contr.poly&quot;</span>))</span>
<span id="cb112-2"><a href="test-de-t-et-anova.html#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">contrasts</span>(bird<span class="sc">$</span>Diet2)[, <span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="test-de-t-et-anova.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">contrasts</span>(bird<span class="sc">$</span>Diet2)[, <span class="dv">1</span>] <span class="sc">*</span> <span class="fu">contrasts</span>(bird<span class="sc">$</span>Diet2)[, <span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>Nos conditions sont mainteant nulles et nos contrastes orthogonaux.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="test-de-t-et-anova.html#cb116-1" aria-hidden="true" tabindex="-1"></a>anov3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(logMaxAbund <span class="sc">~</span> Diet, <span class="at">data =</span> bird)</span>
<span id="cb116-2"><a href="test-de-t-et-anova.html#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anov3)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = logMaxAbund ~ Diet, data = bird)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.2664 -0.7592 -0.2028  1.0908  3.5938 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   2.5247     0.3369   7.495 1.14e-09 ***
## Diet1        -0.7408     0.5728  -1.293   0.2020    
## Diet2         0.4319     0.4111   1.051   0.2986    
## Diet3         0.3203     0.1603   1.999   0.0512 .  
## Diet4        -0.1437     0.1206  -1.191   0.2393    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.545 on 49 degrees of freedom
## Multiple R-squared:  0.188,  Adjusted R-squared:  0.1217 
## F-statistic: 2.836 on 4 and 49 DF,  p-value: 0.0341</code></pre>
<p>Il est aussi possible de créer sa propre matrice de coefficients de contrastes afin
d’effectuer certaines comparaisons bien précises à l’aide de la
fonction <code>contrasts()</code>. Par exemple, les lignes suivantes créent la matrice de coefficients de contrastes suivante :</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="test-de-t-et-anova.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(bird<span class="sc">$</span>Diet2) <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">c</span>(<span class="dv">4</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb118-2"><a href="test-de-t-et-anova.html#cb118-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb118-3"><a href="test-de-t-et-anova.html#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(bird<span class="sc">$</span>Diet2)</span></code></pre></div>
<pre><code>##             [,1] [,2] [,3] [,4]
## Plant          4    0    0    0
## Insect        -1    1    0    1
## InsectVert    -1    1    0   -1
## PlantInsect   -1   -1    1    0
## Vertebrate    -1   -1   -1    0</code></pre>
<p>qui compare :<br />
</p>
<ul>
<li>la diète <code>Plant</code> à toutes les autres diètes dans la première
comparaison (colonne),<br />
</li>
<li>les diètes <code>InsectVert</code> et <code>Insect</code> aux diètes <code>PlantInsect</code> et
<code>Vertebrate</code> dans la deuxième comparaison,<br />
</li>
<li>la diète <code>PlantInsect</code> à la diète <code>Vertebrate</code> dans la troisième
comparaison,<br />
</li>
<li>et la diète <code>Insect</code> à la diète <code>InsectVert</code> dans la quatrième
comparaison.</li>
</ul>
<p>Pour chaque colonne, les diètes avec le même coefficient appartiennent
au même groupe (e.g. pour la colonne 1, les quatre diètes avec un
coefficient de -1 appartiennent au même groupe et sont comparés à la
diète avec un coefficient différent; ici la diète <code>Plant</code> avec un
coefficient de 4). Il est donc possible d’effectuer n’importe quelle
comparaison possible à l’aide d’une matrice de coefficients de
contrastes.<br />
</p>
<p>Vérifions l’orhtogonalité :</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="test-de-t-et-anova.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">contrasts</span>(bird<span class="sc">$</span>Diet2)[, <span class="dv">1</span>])  <span class="co"># première condition pour la colonne 1</span></span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="test-de-t-et-anova.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">contrasts</span>(bird<span class="sc">$</span>Diet2)[, <span class="dv">1</span>] <span class="sc">*</span> <span class="fu">contrasts</span>(bird<span class="sc">$</span>Diet2)[, <span class="dv">2</span>])  <span class="co"># deuxième condition pour les colonnes 1 et 2</span></span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>Ces contrastes suivent l’orthogonalité et pourrait donc être utilisés.</p>
<p>D’autres types de contrastes utilisés fréquemment sont déjà programmés dans R
<code>help(contrasts)</code>.</p>
<hr />
</div>
</div>
<div id="anova-à-deux-critères-de-classification" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> ANOVA à deux critères de classification<a href="test-de-t-et-anova.html#anova-à-deux-critères-de-classification" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Jusqu’ici, les modèles ANOVA que nous avons explorés n’ont eu qu’une
seule variable catégorique, mais on peut aussi créer des modèles ANOVA
avec plusieurs variables explicatives catégoriques. Quand il y a 2
variables explicatives catégoriques, le modèle est un <strong>ANOVA à deux
critères de classification</strong>. Un ANOVA à deux critères de classification
teste plusieurs <strong>hypothèses</strong>: que la moyenne diffère entre les niveaux
de la variable A, que la moyenne ne diffère pas entre les niveaux de la
variable B; et qu’il n’y a pas d’interaction entre les variables A et
B. Une <strong>interaction significative</strong> implique que la valeur moyenne de
la variable réponse pour chaque niveau de la variable A change selon le
niveau de la variable B. Par exemple, la relation entre la couleur d’un
fruit et sa masse dépend de l’espèce de la plante: si oui, on peut dire
qu’il y a une interaction entre la couleur et l’espèce.</p>
<p>Le tableau de calcul de l’ANOVA vu à la section précédente doit être
modifié afin d’inclure le deuxième facteur et l’interaction entre ces
deux facteurs :</p>
<table style="width:99%;">
<colgroup>
<col width="3%" />
<col width="6%" />
<col width="38%" />
<col width="34%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Source de<br />
variation</th>
<th align="center">Degrés de<br />
liberté (df)</th>
<th align="center">Sommes des carrés<br />
des écarts à la moyenne</th>
<th align="center">Moyenne des carrés</th>
<th align="center">Statistique de F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Total</td>
<td align="center"><span class="math inline">\(abr-1\)</span></td>
<td align="center"><span class="math inline">\(SS_{t}=\sum_{i,j,k}{}(y_{ijk}-\overline{y})^2\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">Cases</td>
<td align="center"><span class="math inline">\(ab-1\)</span></td>
<td align="center"><span class="math inline">\(SS_{Cases}=\sum_{i,j}(\overline{y}_{ij}-\overline{y})^2\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">Intra-<br />
case</td>
<td align="center"><span class="math inline">\(ab(r-1)\)</span></td>
<td align="center"><span class="math inline">\(SS_{\epsilon}=\sum_{i,j,k}(y_{ijk}-\overline{y}_{ij})^2\)</span></td>
<td align="center"><span class="math inline">\(MS_{\epsilon}=\frac{SS_{\epsilon}}{ab(r-1)}\)</span></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">Facteur A</td>
<td align="center"><span class="math inline">\(a-1\)</span></td>
<td align="center"><span class="math inline">\(SS_{A}= rb\sum_{i}(\overline{y}_{i.}-\overline{y})^2\)</span></td>
<td align="center"><span class="math inline">\(MS_{A}=\frac{SS_{A}}{a-1}\)</span></td>
<td align="center"><span class="math inline">\(F_{A}=\frac{MS_{A}}{MS_{\epsilon}}\)</span></td>
</tr>
<tr class="odd">
<td align="left">Facteur B</td>
<td align="center"><span class="math inline">\(b-1\)</span></td>
<td align="center"><span class="math inline">\(SS_{B}= ra\sum_{j}(\overline{y}_{.j}-\overline{y})^2\)</span></td>
<td align="center"><span class="math inline">\(MS_{B}=\frac{SS_{B}}{b-1}\)</span></td>
<td align="center"><span class="math inline">\({F_B}=\frac{MS_{B}}{MS_\epsilon}\)</span></td>
</tr>
<tr class="even">
<td align="left">Intéraction
AB</td>
<td align="center">  <span class="math inline">\((a-1)(b-1)\)</span></td>
<td align="center"><span class="math inline">\(SS_{AB}= r\sum_{i,j,k}(\overline{y}_{..k}-\overline{y}_{.jk}-\overline{y}_{i.k})^2\)</span></td>
<td align="center"><span class="math inline">\(MS_{AB}=\frac{SS_{AB}}{(a-1)(b-1)}\)</span></td>
<td align="center"><span class="math inline">\(F_{AB}=\frac{MS_{AB}}{MS_\epsilon}\)</span></td>
</tr>
</tbody>
</table>
<p><code>a:</code> nombre de niveaux de la variable explicative A<br />
<code>b</code>: nombre de niveaux de la variable explicative B<br />
<code>r</code>: nombre de répétitions par groupe<br />
<span class="math inline">\(\epsilon\)</span> : erreur<br />
</p>
<div id="effectuer-une-anova-à-deux-critères-de-classification" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Effectuer une ANOVA à deux critères de classification<a href="test-de-t-et-anova.html#effectuer-une-anova-à-deux-critères-de-classification" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dans R, une ANOVA à deux critères de classification est effectuée de la
même manière qu’une ANOVA à un critère de classification avec la
fonction <code>lm()</code>.</p>
<ul>
<li>ANOVA à un facteur</li>
</ul>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="test-de-t-et-anova.html#cb124-1" aria-hidden="true" tabindex="-1"></a>aov <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X, data)</span></code></pre></div>
<ul>
<li>ANOVA à deux facteurs ou plus</li>
</ul>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="test-de-t-et-anova.html#cb125-1" aria-hidden="true" tabindex="-1"></a>aov <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">*</span> X2 <span class="sc">*</span> ..., data)</span></code></pre></div>
<p>Lorsque vous utilisez le symbole * avec <code>lm()</code>, le modèle inclut les effets de chaque facteur séparément, ainsi que leur <strong>interaction</strong>.</p>
<p>Selon le principe de parcimonie, vous voulez que votre modèle explique le plus possible de la variance observée dans les données, avec le moins de termes possible</p>
<p>Enlever le terme d’interaction s’il n’est pas significatif, et ré-exécuter le modèle.</p>
<p>Lorsque vous utilisez le symbole + avec <code>lm()</code>, le modèle inclut les effets de chaque facteur séparément (<strong>pas</strong> d’interaction)</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="test-de-t-et-anova.html#cb126-1" aria-hidden="true" tabindex="-1"></a>aov <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y <span class="sc">~</span> X1 <span class="sc">+</span> X2 <span class="sc">+</span> ..., data)</span></code></pre></div>
<hr />
<p><strong>DÉFI 2</strong></p>
<p>Examinez les effets des facteurs "Diet", "Aquatic" et de leur
interaction sur l’abondance maximale d’oiseaux.</p>
<p>Rappelez-vous que vous devez vérifier les suppositions statistiques de
base avant d’interpréter les résultats d’une ANOVA, soit :<br />
- Distribution normale des rsidus du modèle</p>
<ol style="list-style-type: decimal">
<li>Homoscédasticité des résidus de la variance</li>
</ol>
<p>Cette vérification peut être faite en utilisant les quatre graphiques de
diagnostic expliqués dans la section précédente.<br />
</p>
<details>
<summary>
<strong>Cliquez pour voir la solution au Défi 2!</strong>
</summary>
<p>Conditions d’applications</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="test-de-t-et-anova.html#cb127-1" aria-hidden="true" tabindex="-1"></a>anov4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(logMaxAbund <span class="sc">~</span> Diet <span class="sc">*</span> Aquatic, <span class="at">data =</span> bird)</span>
<span id="cb127-2"><a href="test-de-t-et-anova.html#cb127-2" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb127-3"><a href="test-de-t-et-anova.html#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(anov4)</span></code></pre></div>
<pre><code>## Warning: not plotting observations with leverage one:
##   5, 6, 26</code></pre>
<p><img src="book-fr_files/figure-html/unnamed-chunk-83-1.png" width="672" /></p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="test-de-t-et-anova.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar)</span></code></pre></div>
<p>La fonction <code>anova()</code> permet de visualiser le tableau d’ANOVA du modèle
:<br />
</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="test-de-t-et-anova.html#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(anov4)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: logMaxAbund
##              Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
## Diet          4  27.071  6.7677  3.0378 0.02669 *
## Aquatic       1   1.688  1.6878  0.7576 0.38870  
## Diet:Aquatic  3  14.978  4.9926  2.2410 0.09644 .
## Residuals    45 100.252  2.2278                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Dans ce cas-ci, le seul facteur significatif est la diète. La valeur de
p de l’interaction n’est pas significative, ce qui signifie que
l’effet de la diète est le même peu importe si l’oiseau est aquatique
ou non. Le seuil de signification peut aussi être testé en comparant
deux modèles nichés, i.e. en incluant un premier modèle avec une
interaction et un deuxième modèle avec sans l’interaction. La fonction
<code>anova()</code> est utilisée :</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="test-de-t-et-anova.html#cb132-1" aria-hidden="true" tabindex="-1"></a>anov5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(logMaxAbund <span class="sc">~</span> Diet <span class="sc">+</span> Aquatic, <span class="at">data =</span> bird)</span>
<span id="cb132-2"><a href="test-de-t-et-anova.html#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(anov5, anov4)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: logMaxAbund ~ Diet + Aquatic
## Model 2: logMaxAbund ~ Diet * Aquatic
##   Res.Df    RSS Df Sum of Sq     F  Pr(&gt;F)  
## 1     48 115.23                             
## 2     45 100.25  3    14.978 2.241 0.09644 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Étant donné que la seule différence entre ces deux modèles est la
présence de l’interaction, cette sortie de R présente le seuil de
signification de cette interaction. Dans ce cas-ci, l’interaction
n’est pas significative et peut donc être retirée du modèle.<br />
Lorsque l’interaction est significative, rappelez-vous que chaque
facteur ne peut pas être interprété séparément. Seule l’interaction
peut l’être.</p>
<p><u><strong>Note :</strong></u> Le tableau d’ANOVA indique que le nombre de degrés de
liberté pour l’interaction entre la diète et le type d’oiseau
(aquatique ou non) est de 3. Selon la notation mathématique du tableau
de l’ANOVA à deux critères de classification (pour les plans
équilibrés), a = 5 et b = 2 et le nombre de degrés de liberté est de
(a-1)(b-1) = 4*1 = 4. La sortie de R indique cependant que le nombre de
degrés de liberté est de 3. Cette interaction est extrêmement non
équilibrée () : les oiseaux aquatiques ne se nourrissent pas de plante,
donc ce niveau n’est pas considéré (prenez note du NA dans la sortie de
summary(anov4)). Consultez la section sur les <a href="test-de-t-et-anova.html#anova-non-équilibrée-section-avancéefacultative">ANOVA non
équilibrées</a> plus bas pour plus de détails.</p>
</details>
<hr />
</div>
<div id="diagramme-dinteraction" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Diagramme d’interaction<a href="test-de-t-et-anova.html#diagramme-dinteraction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Les interactions peuvent être visualisées à l’aide de la fonction
<code>interaction.plot()</code> :</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="test-de-t-et-anova.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interaction.plot</span>(bird<span class="sc">$</span>Diet, bird<span class="sc">$</span>Aquatic, bird<span class="sc">$</span>logMaxAbund, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb134-2"><a href="test-de-t-et-anova.html#cb134-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="sc">*</span> <span class="st">&quot;(Maximum Abundance)&quot;</span>), <span class="at">xlab =</span> <span class="st">&quot;Diet&quot;</span>)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-86-1.png" width="672" /></p>
<p>Que signifie le trou sur la ligne des oiseaux aquatiques?</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="test-de-t-et-anova.html#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(bird<span class="sc">$</span>Diet, bird<span class="sc">$</span>Aquatic)</span></code></pre></div>
<pre><code>##              
##                0  1
##   Insect      14  6
##   InsectVert   1  1
##   Plant        2  0
##   PlantInsect 17  1
##   Vertebrate   5  7</code></pre>
<p>Le plan est <strong>non-équilibré</strong>: il y a un nombre inégal d’observations
entre les diètes pour les oiseaux aquatiques (représentés par le 1) et
les oiseaux terrestres (représentés par le 0). Consultez la section
avancée ci-dessous pour plus de détails sur les ANOVA à plan
non-équilibré.</p>
<hr />
<p><strong>DÉFI 3</strong></p>
<p>Tester le seuil de signification du facteur "Aquatic" en comparant
deux modèles nichés (i.e. avec et sans ce facteur).</p>
<details>
<summary>
<strong>Cliquez pour voir la solution au Défi 3!</strong>
</summary>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="test-de-t-et-anova.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(anov1, anov5)  <span class="co"># Rappel que anov3 est le modèle avec le facteur &#39;Diet&#39; seulement.</span></span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: logMaxAbund ~ Diet
## Model 2: logMaxAbund ~ Diet + Aquatic
##   Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
## 1     49 116.92                           
## 2     48 115.23  1    1.6878 0.7031 0.4059</code></pre>
</details>
<hr />
</div>
</div>
<div id="anova-non-équilibrée-section-avancéefacultative" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> ANOVA non-équilibrée (section avancée/facultative)<a href="test-de-t-et-anova.html#anova-non-équilibrée-section-avancéefacultative" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Les ANOVA à un et à deux critères de classification nous
permettent de déterminer les effets de variables catégoriques sur une
variable réponse continue lorsque nous avons un plan expérimental
<strong>équilibré</strong> (i.e. lorsque le nombre de répétitions est égal pour
chaque niveau de facteur). Cependant, le plan peut devenir
<strong>non-équilibré</strong> en raison d’une perte d’unités expérimentales au
cours d’une expérience ou de restrictions techniques dues au plan
expérimental. Dans de telles situations, les résultats d’ANOVA peuvent
être mal interprétés en raison de calculs erronés de la somme des
carrés. Pour des plans expérimentaux non-équilibrés, l’ANOVA doit être
modifiée pour prendre en compte les données manquantes de la variable
réponse.</p>
<p><strong>Un jeu de données est considéré non équilibré lorsque le nombre d’échantillons entre deux niveaux n’est pas égal.</strong></p>
<p>Le jeu de données <code>bird</code> est en réalité non équilibré (le nombre d’espèces aquatiques n’égale pas le nombre d’espèces non-aquatiques).</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="test-de-t-et-anova.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(bird<span class="sc">$</span>Aquatic)</span></code></pre></div>
<pre><code>## 
##  0  1 
## 39 15</code></pre>
<p>Le modèle mathématique, les hypothèses statistiques, et les conditions
de base d’une ANOVA à plan non-équilibré demeurent les mêmes que deux
de l’ANOVA à plan équilibré. Le calcul de la somme des carrés, par
contre, est différent.</p>
<p>Pour un plan expérimental non-équilibré, les hypothèses statistiques
sont les suivantes :</p>
<p>H<sub>0</sub>: µ<sub>1</sub> = µ<sub>2</sub> =... = µ<sub>i</sub> =... = µ<sub>n</sub><br />
H<sub>1</sub>: il y a au moins une moyenne µi qui diffère des autres.</p>
<p>On utilise ce modèle mathématique :</p>
<p><span class="math inline">\(y_{ijk} = µ + A_{i} + B_{j} + A_{i}B_{j} + ε_{ijk}\)</span></p>
<p>Rappelez-vous du calcul de la somme des carrés dans le cas d’une ANOVA
à plan équilibré :</p>
<p><span class="math display">\[ SS_{A} = rb\sum_{i}(\overline{y}_{i.}-\overline{y})^2 = SS(A)\]</span></p>
<p><span class="math display">\[ SS_{B} = ra \sum_{j}(\overline{y}_{.j}-\overline{y})^2 = SS(B\|A) = SS(A,B)-SS(B)\]</span></p>
<p><span class="math display">\[ SS_{AB} = r \sum{i,j,k}(\overline{y}_{..k}-\overline{y}_{.jk}-\overline{y}_{i.k})^2= SS(A,B,AB)-SS(A,B)\]</span></p>
<p>Ceci correspond à une somme des carrés <em>séquentielle</em> (aussi appelée de
<strong>Type I</strong>), car l’effet d’un facteur B est calculé après avoir retiré
l’effet d’un facteur A. L’interaction est calculée après avoir retiré
les effets principaux de ces deux facteurs. Le <strong>Type I</strong> est le paramètre par défaut dans R. Ces calculs dépendent de la
taille de l’échantillon, car l’effet de chaque facteur est calculé
après avoir retiré l’effet du facteur précédent.</p>
<p>Dans le cas d’un plan expérimental non-équilibré, les résultats
d’ANOVA dépendent de l’ordre dans lequel chaque variable apparaît dans
le modèle. Voyez comment les résultats diffèrent en comparant les deux
modèles suivants :</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="test-de-t-et-anova.html#cb141-1" aria-hidden="true" tabindex="-1"></a>unb_anov1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(logMaxAbund <span class="sc">~</span> Aquatic <span class="sc">+</span> Diet, <span class="at">data =</span> bird)</span>
<span id="cb141-2"><a href="test-de-t-et-anova.html#cb141-2" aria-hidden="true" tabindex="-1"></a>unb_anov2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(logMaxAbund <span class="sc">~</span> Diet <span class="sc">+</span> Aquatic, <span class="at">data =</span> bird)</span>
<span id="cb141-3"><a href="test-de-t-et-anova.html#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(unb_anov1)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: logMaxAbund
##           Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
## Aquatic    1   1.228  1.2278  0.5114 0.47798  
## Diet       4  27.531  6.8827  2.8671 0.03291 *
## Residuals 48 115.230  2.4006                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="test-de-t-et-anova.html#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(unb_anov2)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: logMaxAbund
##           Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
## Diet       4  27.071  6.7677  2.8191 0.03517 *
## Aquatic    1   1.688  1.6878  0.7031 0.40591  
## Residuals 48 115.230  2.4006                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Bien que les variables explicatives soient les mêmes pour chaque modèle,
les tableaux d’ANOVA montrent des résultats différents à cause d’un
plan non-équilibré (i.e. un nombre différent d’observations pour les
oiseaux aquatiques et terrestres).</p>
<p>La somme des carrés de <strong>Type II</strong> teste les effets de chaque facteur, mais après avoir tester l’autre facteur.</p>
<p>Pour les plans non-équilibrés, une somme des carrés <em>marginale</em> (aussi
appelée de <strong>Type III</strong>) est souvent utilisé. Cela permet de calculer un effet principal après avoir
retiré les effets des autres facteurs. Ceci rend le calcul indépendant
de la taille des échantillons.</p>
<p><strong>Si vous considérez utiliser le Type II ou III avec vos propres données, vous devriez en lire plus sur le sujet avant de choisir. Vous pouvez commencer avec ce <a href="https://mcfromnz.wordpress.com/2011/03/02/anova-type-iiiiii-ss-explained/">lien</a></strong></p>
<p>L’équation mathématique pour une somme des carrés de <strong>Type III</strong> correspond à:</p>
<p><span class="math display">\[SS_{A}=SS(A\|B,AB)=SS(A,B,AB)-SS(B,AB)\]</span>
<span class="math display">\[SS_{B}=SS(B\|A,AB)=SS(A,B,AB)-SS(A,AB)\]</span>
<span class="math display">\[SS_{AB}=SS(AB\|B,A)=SS(A,B,AB)-SS(B,AB)\]</span><br />
Dans R, une ANOVA avec somme des carrés de <strong>type III</strong> peut être effectuée
avec la fonction <code>Anova()</code> du paquet <a href="https://cran.r-project.org/web/packages/car/car.pdf">car</a> et en spécifiant
l’argument <code>type="III"</code> :</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="test-de-t-et-anova.html#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb145-2"><a href="test-de-t-et-anova.html#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(unb_anov1, <span class="at">type =</span> <span class="st">&quot;III&quot;</span>)</span></code></pre></div>
<pre><code>## Anova Table (Type III tests)
## 
## Response: logMaxAbund
##              Sum Sq Df F value    Pr(&gt;F)    
## (Intercept) 100.391  1 41.8186 4.837e-08 ***
## Aquatic       1.688  1  0.7031   0.40591    
## Diet         27.531  4  2.8671   0.03291 *  
## Residuals   115.230 48                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="test-de-t-et-anova.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(unb_anov2, <span class="at">type =</span> <span class="st">&quot;III&quot;</span>)</span></code></pre></div>
<pre><code>## Anova Table (Type III tests)
## 
## Response: logMaxAbund
##              Sum Sq Df F value    Pr(&gt;F)    
## (Intercept) 100.391  1 41.8186 4.837e-08 ***
## Diet         27.531  4  2.8671   0.03291 *  
## Aquatic       1.688  1  0.7031   0.40591    
## Residuals   115.230 48                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>En comparant les tableaux d’ANOVA de modèles avec un ordre différent
dans les variables explicatives, on peut voir que les résultats sont les
mêmes. L’utilisation de la somme des carrés de type III produit une
ANOVA qui est indépendante de la tailles des échantillons.</p>
<p>Après avoir vérifié les suppositions du modèle, les résultats peuvent
finalement être interprétés correctement.</p>

</div>
<div id="ancova" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> 6. ANCOVA<a href="test-de-t-et-anova.html#ancova" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><img src="images/schema_ancova.png" /></p>
<p>L’analyse de covariance (ANCOVA) est un modèle linéaire qui teste
l’influence d’une (ou plusieurs) variable explicative catégorique sur
une variable réponse continue. Chaque niveau de la variable catégorique
est décrit par une pente (ou coefficient de variation) et une ordonnée à
l’origine. En plus de tester si la variable réponse diffère pour au
moins un niveau de la variable catégorique, l’ANCOVA teste aussi si la
variable réponse est influencée par sa relation avec la variable
continue (nommée la <strong>covariable</strong> dans une ANCOVA), et par une
différence dans l’influence de la variable continue sur la réponse
(i.e. l’interaction) entre les niveaux de groupe. Les hypothèses d’un
ANCOVA sont alors: qu’il n’y a pas de différence de moyenne entre les
niveaux de la variable catégorique; qu’il n’y a pas de correlation
entre la variable réponse et la variable explicative catégorique; et
qu’il n’y a pas d’interaction entre les variables catégoriques et
continues.</p>
<p><span class="math inline">\(Y = X * Z\)</span></p>
<p>où:
<span class="math inline">\(Y\)</span>: Variable réponse est continue
<span class="math inline">\(X\)</span>: Varaible prédictrice est catégorique (facteur)
<span class="math inline">\(Z\)</span>: Varaible prédictrice est continue</p>
<p><span class="math display">\[Y = \mu + Effets Principaux Facteurs + Intéraction entre Facteurs + Effets Principaux Covariables + Intéractions entre Covariables Facteurs + \epsilon\]</span></p>
<div id="conditions-de-base-1" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> 6.1 Conditions de base<a href="test-de-t-et-anova.html#conditions-de-base-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En plus des conditions d’application des modèles linéaires, les modèles ANCOVA doivent respecter :</p>
<ol style="list-style-type: decimal">
<li>Les covariables ont toutes la <strong>même étendue de valeurs</strong></li>
<li>Les variables sont <strong><em>fixes</em></strong></li>
<li>Les variables catégoriques et continues sont <strong>indépendantes</strong></li>
</ol>
<p><strong><u>Note :</u></strong> Un variable <em>fixe</em> est une variable d’intérêt pour
une étude (e.g. la masse des oiseaux). En comparaison, une variable
aléatoire représente surtout une source de bruit qu’on veut contrôler
(i.e. le site où les oiseaux ont été échantillonnés). Si votre modèle
comporte des effets aléatoires, consultez l’atelier 7 sur les <a href="https://r.qcbs.ca/fr/workshops/r-workshop-07/">modèles linéaires et
généralisés linéaires mixtes</a>!</p>
</div>
<div id="types-dancova" class="section level3 hasAnchor" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> 6.2 Types d’ANCOVA<a href="test-de-t-et-anova.html#types-dancova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Il est possible d’avoir plusieurs facteurs (i.e. variables explicatives
catégoriques) et covariables (i.e. variables explicatives continues) au
sein d’une même ANCOVA. Par contre, l’interprétation des résultats
devient de plus en plus complexe à mesure que le nombre de covariables
et de facteurs augmente.</p>
<p>Les ANCOVA les plus courantes comportent :</p>
<ol style="list-style-type: decimal">
<li>une covariable et un facteur</li>
<li>une covariable et deux facteurs</li>
<li>deux covariables et un facteur</li>
</ol>
<p>Les buts possibles de l’ANCOVA sont de déterminer les effets :</p>
<ol style="list-style-type: decimal">
<li>des facteurs et des covariables sur la variable réponse</li>
<li>des facteurs sur la variable réponse après avoir retiré l’effet des
covariables</li>
<li>des facteurs sur la relation existant entre les covariables et la
variable réponse</li>
</ol>
<p>Ces buts ne sont atteints que s’il n’y a pas d’interaction
significative entre le(s) facteur(s) et la(les) covariable(s)! Des
exemples d’interaction significative entre un facteur et une covariable
(pour une ANCOVA avec un facteur et une covariable) sont illustrés
ci-dessous dans les deux derniers graphiques:</p>
<p><img src="book-fr_files/figure-html/unnamed-chunk-93-1.png" width="960" /></p>
<p>Si l’interaction est significative, vous aurez un scénario qui ressemble aux graphiques de gauche et central. Si votre covariable et votre facteur sont significatifs, vous avez un cas comme le graphique de droite. La même logique s’applique aux ANCOVAs à plusieurs facteurs et/ou
covariables.<br />
</p>
</div>
<div id="effectuer-une-ancova" class="section level3 hasAnchor" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> 6.3 Effectuer une ANCOVA<a href="test-de-t-et-anova.html#effectuer-une-ancova" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Effectuer une ANCOVA dans R ressemble à une ANOVA à deux critères de
classification : on utilise la fonction <code>lm()</code>. Toutefois, au lieu
d’avoir deux variables catégoriques (par exemple, "Diet" et "Aquatic"), on
utilise maintenant une variable catégorique et une variable continue.</p>
<p>Par exemple, en utilisant le jeu de données CO2 (déjà inclus dans R) où
la variable réponse est <em>uptake</em>, on peut effectuer une ANCOVA avec la
variable continue <em>conc</em> et le facteur <em>Treatment</em> :</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="test-de-t-et-anova.html#cb149-1" aria-hidden="true" tabindex="-1"></a>ancova.example <span class="ot">&lt;-</span> <span class="fu">lm</span>(uptake <span class="sc">~</span> conc <span class="sc">*</span> Treatment, <span class="at">data =</span> CO2)</span>
<span id="cb149-2"><a href="test-de-t-et-anova.html#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ancova.example)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: uptake
##                Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## conc            1 2285.0 2284.99 28.5535 8.377e-07 ***
## Treatment       1  988.1  988.11 12.3476 0.0007297 ***
## conc:Treatment  1   31.9   31.87  0.3983 0.5297890    
## Residuals      80 6402.0   80.02                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>-Si l’analyse indique que seule la covariable est significative, on
retire le facteur du modèle; on revient à une <strong>ANOVA</strong> à un critère de
classification.<br />
-Si l’analyse indique que seul le facteur est significatif, on retire la
covariable du modèle; on revient à une <strong>régression linéaire simple</strong>.<br />
-Si l’analyse indique que l’interaction est significative, il faut
trouver quels niveaux ont une pente différente.<br />
</p>
<p>Dans l’exemple du jeu de données CO2, la covariable et le facteur sont
significatifs, mais l’interaction n’est pas significative. Si on
remplace le facteur <em>Treatment</em> par le facteur <em>Type</em>, l’interaction
devient significative.</p>
<p>Si vous voulez comparer les moyennes de la variable réponse entre les
facteurs, vous pouvez utiliser les moyennes ajustées qui sont calculées
comme dans l’équation de l’ANCOVA et en tenant compte de l’effet de
la covariable :</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="test-de-t-et-anova.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;effects&quot;</span>)</span>
<span id="cb151-2"><a href="test-de-t-et-anova.html#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effects)</span></code></pre></div>
<p>Si vous voulez comparer les moyennes des différents facteurs, vous pouvez utiliser les moyennes ajustées. La fonction <code>effect()</code> utilise les équations données par l’ANCOVA pour estimer les moyennes de chaque niveau, corrigées pour l’effet de la covariable.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="test-de-t-et-anova.html#cb152-1" aria-hidden="true" tabindex="-1"></a>adj.means.ex <span class="ot">&lt;-</span> <span class="fu">effect</span>(<span class="st">&quot;Treatment&quot;</span>, ancova.example)</span></code></pre></div>
<pre><code>## NOTE: Treatment is not a high-order term in the model</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="test-de-t-et-anova.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(adj.means.ex)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-96-1.png" width="672" /></p>
<hr />
<p><strong>DÉFI 4</strong></p>
<p>Effectuez une ANCOVA qui teste l’effet du facteur <code>Diet</code>, de la
covariable <code>Mass</code>, et de leur interaction sur la variable réponse
<code>MaxAbund</code>.<br />
</p>
<p>Variable réponse: <code>MaxAbund</code>
Variables prédictrices:
-<code>Diet</code> (facteur avec 5 groupes)
-<code>Mass</code> (numérique, continuous)</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="test-de-t-et-anova.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(bird)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    54 obs. of  9 variables:
##  $ Family     : chr  &quot;Hawks&amp;Eagles&amp;Kites&quot; &quot;Long-tailed tits&quot; &quot;Larks&quot; &quot;Kingfishers&quot; ...
##  $ MaxAbund   : num  2.99 37.8 241.4 4.4 4.53 ...
##  $ AvgAbund   : num  0.674 4.04 23.105 0.595 2.963 ...
##  $ Mass       : num  716 5.3 35.8 119.4 315.5 ...
##  $ Diet       : Factor w/ 5 levels &quot;Insect&quot;,&quot;InsectVert&quot;,..: 5 1 4 5 2 4 5 1 1 5 ...
##  $ Passerine  : int  0 1 1 0 0 0 0 0 0 0 ...
##  $ Aquatic    : int  0 0 0 0 1 1 1 0 1 1 ...
##  $ logMass    : num  6.57 1.67 3.58 4.78 5.75 ...
##  $ logMaxAbund: num  1.09 3.63 5.49 1.48 1.51 ...</code></pre>
<details>
<summary>
<strong>Cliquez pour voir la solution au Défi 3!</strong>
</summary>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="test-de-t-et-anova.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Si vous avez complété la section avancée sur les</span></span>
<span id="cb157-2"><a href="test-de-t-et-anova.html#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="co"># contrastes, vous devrez réinitialiser les contrastes à</span></span>
<span id="cb157-3"><a href="test-de-t-et-anova.html#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="co"># l&#39;aide de la fonction &#39;&#39;options()&#39;&#39; Si vous n&#39;avez pas</span></span>
<span id="cb157-4"><a href="test-de-t-et-anova.html#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="co"># complété la section avancée sur les contrastes, ignorez</span></span>
<span id="cb157-5"><a href="test-de-t-et-anova.html#cb157-5" aria-hidden="true" tabindex="-1"></a><span class="co"># la première ligne du script.</span></span>
<span id="cb157-6"><a href="test-de-t-et-anova.html#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">contrasts =</span> <span class="fu">c</span>(<span class="st">&quot;contr.treatment&quot;</span>, <span class="st">&quot;contr.poly&quot;</span>))</span>
<span id="cb157-7"><a href="test-de-t-et-anova.html#cb157-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-8"><a href="test-de-t-et-anova.html#cb157-8" aria-hidden="true" tabindex="-1"></a><span class="co"># solution</span></span>
<span id="cb157-9"><a href="test-de-t-et-anova.html#cb157-9" aria-hidden="true" tabindex="-1"></a>ancov1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(logMaxAbund <span class="sc">~</span> logMass <span class="sc">*</span> Diet, <span class="at">data =</span> bird)</span>
<span id="cb157-10"><a href="test-de-t-et-anova.html#cb157-10" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ancov1)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: logMaxAbund
##              Df Sum Sq Mean Sq F value  Pr(&gt;F)  
## logMass       1 10.464 10.4637  4.6054 0.03743 *
## Diet          4 17.749  4.4372  1.9530 0.11850  
## logMass:Diet  4 15.805  3.9513  1.7391 0.15849  
## Residuals    44 99.971  2.2721                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="test-de-t-et-anova.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ancov1)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = logMaxAbund ~ logMass * Diet, data = bird)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.1308 -0.7081 -0.0855  0.9854  2.5694 
## 
## Coefficients:
##                         Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)               3.7384     0.8042   4.648 3.05e-05 ***
## logMass                  -0.2865     0.1934  -1.481   0.1457    
## DietInsectVert           -4.4599     6.1652  -0.723   0.4733    
## DietPlant                 1.6796     4.7819   0.351   0.7271    
## DietPlantInsect           0.5537     1.3860   0.400   0.6914    
## DietVertebrate           -7.7409     2.9359  -2.637   0.0115 *  
## logMass:DietInsectVert    0.6745     1.2463   0.541   0.5911    
## logMass:DietPlant        -0.2631     1.1602  -0.227   0.8216    
## logMass:DietPlantInsect   0.1115     0.3427   0.325   0.7465    
## logMass:DietVertebrate    1.1665     0.4556   2.561   0.0140 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.507 on 44 degrees of freedom
## Multiple R-squared:  0.3057, Adjusted R-squared:  0.1637 
## F-statistic: 2.153 on 9 and 44 DF,  p-value: 0.04469</code></pre>
<p>Dans ce cas-ci, l’interaction n’est pas significative, ce qui signifie
que l’effet de la masse sur l’abondance maximale est le même peu
importe la diète. L’interaction est retirée du modèle et l’ANCOVA
devient :</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="test-de-t-et-anova.html#cb161-1" aria-hidden="true" tabindex="-1"></a>ancov2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(logMaxAbund <span class="sc">~</span> logMass <span class="sc">+</span> Diet, <span class="at">data =</span> bird)</span>
<span id="cb161-2"><a href="test-de-t-et-anova.html#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(ancov2)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: logMaxAbund
##           Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
## logMass    1  10.464 10.4637  4.3382 0.04262 *
## Diet       4  17.749  4.4372  1.8396 0.13664  
## Residuals 48 115.776  2.4120                  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>R nous indique que la diète n’est pas significative non plus, donc ce
terme est retiré du modèle. Notre modèle final devient donc une
régression linéaire simple :</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="test-de-t-et-anova.html#cb163-1" aria-hidden="true" tabindex="-1"></a>lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(logMaxAbund <span class="sc">~</span> logMass, <span class="at">data =</span> bird)</span>
<span id="cb163-2"><a href="test-de-t-et-anova.html#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm2)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = logMaxAbund ~ logMass, data = bird)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.4569 -0.9206  0.1263  0.9354  3.7180 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   3.8508     0.5691   6.767 1.17e-08 ***
## logMass      -0.2361     0.1170  -2.019   0.0487 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.602 on 52 degrees of freedom
## Multiple R-squared:  0.07267,    Adjusted R-squared:  0.05484 
## F-statistic: 4.075 on 1 and 52 DF,  p-value: 0.04869</code></pre>
<p>Les résultats de l’analyse peuvent être représentés graphiquement. On
trace la variable réponse en fonction de la variable explicative
continue avec des points et des lignes de différentes couleurs pour les
différents niveaux de la variable catégorique.</p>
<p>Nous pouvons aussi tracez un diagramme représentant les pentes et
ordonnées à l’origine d’une ANCOVA (le modèle ancov1 plus haut) à
l’aide des fonctions <code>abline()</code> et <code>coef()</code>.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="test-de-t-et-anova.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(ancov1)</span></code></pre></div>
<pre><code>##             (Intercept)                 logMass          DietInsectVert 
##               3.7384247              -0.2864726              -4.4598537 
##               DietPlant         DietPlantInsect          DietVertebrate 
##               1.6795975               0.5537085              -7.7409274 
##  logMass:DietInsectVert       logMass:DietPlant logMass:DietPlantInsect 
##               0.6744893              -0.2631444               0.1114568 
##  logMass:DietVertebrate 
##               1.1665348</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="test-de-t-et-anova.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(logMaxAbund <span class="sc">~</span> logMass, <span class="at">data =</span> bird, <span class="at">col =</span> Diet, <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb167-2"><a href="test-de-t-et-anova.html#cb167-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="fu">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="sc">*</span> <span class="st">&quot;(Maximum Abundance)&quot;</span>), <span class="at">xlab =</span> <span class="fu">expression</span>(<span class="st">&quot;log&quot;</span>[<span class="dv">10</span>] <span class="sc">*</span></span>
<span id="cb167-3"><a href="test-de-t-et-anova.html#cb167-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;(Mass)&quot;</span>))</span>
<span id="cb167-4"><a href="test-de-t-et-anova.html#cb167-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="fu">coef</span>(ancov1)[<span class="dv">1</span>], <span class="at">b =</span> <span class="fu">coef</span>(ancov1)[<span class="dv">2</span>], <span class="at">col =</span> <span class="st">&quot;deepskyblue1&quot;</span>)</span>
<span id="cb167-5"><a href="test-de-t-et-anova.html#cb167-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="fu">sum</span>(<span class="fu">coef</span>(ancov1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(ancov1)[<span class="dv">3</span>]), <span class="at">b =</span> <span class="fu">sum</span>(<span class="fu">coef</span>(ancov1)[<span class="dv">2</span>] <span class="sc">+</span></span>
<span id="cb167-6"><a href="test-de-t-et-anova.html#cb167-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coef</span>(ancov1)[<span class="dv">7</span>]), <span class="at">col =</span> <span class="st">&quot;green2&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb167-7"><a href="test-de-t-et-anova.html#cb167-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="fu">sum</span>(<span class="fu">coef</span>(ancov1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(ancov1)[<span class="dv">4</span>]), <span class="at">b =</span> <span class="fu">sum</span>(<span class="fu">coef</span>(ancov1)[<span class="dv">2</span>] <span class="sc">+</span></span>
<span id="cb167-8"><a href="test-de-t-et-anova.html#cb167-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coef</span>(ancov1)[<span class="dv">8</span>]), <span class="at">col =</span> <span class="st">&quot;orange1&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb167-9"><a href="test-de-t-et-anova.html#cb167-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="fu">sum</span>(<span class="fu">coef</span>(ancov1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(ancov1)[<span class="dv">5</span>]), <span class="at">b =</span> <span class="fu">sum</span>(<span class="fu">coef</span>(ancov1)[<span class="dv">2</span>] <span class="sc">+</span></span>
<span id="cb167-10"><a href="test-de-t-et-anova.html#cb167-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coef</span>(ancov1)[<span class="dv">9</span>]), <span class="at">col =</span> <span class="st">&quot;lightsteelblue1&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb167-11"><a href="test-de-t-et-anova.html#cb167-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="fu">sum</span>(<span class="fu">coef</span>(ancov1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fu">coef</span>(ancov1)[<span class="dv">6</span>]), <span class="at">b =</span> <span class="fu">sum</span>(<span class="fu">coef</span>(ancov1)[<span class="dv">2</span>] <span class="sc">+</span></span>
<span id="cb167-12"><a href="test-de-t-et-anova.html#cb167-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coef</span>(ancov1)[<span class="dv">10</span>]), <span class="at">col =</span> <span class="st">&quot;darkcyan&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="book-fr_files/figure-html/unnamed-chunk-101-1.png" width="672" /></p>
</details>

</div>
</div>
</div>
<hr>
<center> 
  <div class="footer">
      All the content of the workshop series is under a <a href="https://creativecommons.org/licenses/by-nc/2.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</center>
            </section>

          </div>
        </div>
      </div>
<a href="régression-linéaire-avec-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="régression-multiple.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
